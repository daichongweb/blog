<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>è§£å†³å¾®ä¿¡å°ç¨‹åºæˆæƒç¬¬ä¸€æ¬¡æ€»æ˜¯ä¼šå¤±è´¥çš„é—®é¢˜</title>
      <link href="/%E8%A7%A3%E5%86%B3%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%88%E6%9D%83%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%80%BB%E6%98%AF%E4%BC%9A%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/%E8%A7%A3%E5%86%B3%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%88%E6%9D%83%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%80%BB%E6%98%AF%E4%BC%9A%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><p>&emsp;ç›¸ä¿¡æœ‰å¾ˆå¤šåŒå­¦éƒ½é‡åˆ°è¿‡å°ç¨‹åºéœ€è¦æˆæƒä¸¤æ¬¡çš„é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯é”™è¯¯çš„æˆæƒæµç¨‹å¯¼è‡´çš„ã€‚</p><p>&emsp;(1)é”™è¯¯çš„æµç¨‹ï¼š<code>å¼•å¯¼ç”¨æˆ·ç‚¹å‡»æˆæƒæŒ‰é’®(getUserProfile)</code>=&gt;<code>è°ƒèµ·æˆæƒ(wx.getUserProfile)</code>=&gt;<code>è·å–code(wx.login)</code>=&gt;<code>è¯·æ±‚åç«¯ã€ä¼ è¾“æ•°æ®ï¼ˆcodeã€ivç­‰ï¼‰</code>=&gt;<code>åç«¯è§£å¯†å¹¶ç™»é™†</code>ã€‚</p><p>&emsp;(2)æ­£ç¡®çš„æµç¨‹ï¼š<code>è·å–code(wx.show)</code>=&gt;<code>å¼•å¯¼ç”¨æˆ·ç‚¹å‡»æˆæƒæŒ‰é’®(getUserProfile)</code>=&gt;<code>è°ƒèµ·æˆæƒ(wx.getUserProfile)</code>=&gt;<code>è¯·æ±‚åç«¯ã€ä¼ è¾“æ•°æ®ï¼ˆcodeã€ivç­‰ï¼‰</code>=&gt;<code>åç«¯è§£å¯†å¹¶ç™»é™†</code>ã€‚</p><a id="more"></a><h4 id="ä»£ç æ¼”ç¤º"><a href="#ä»£ç æ¼”ç¤º" class="headerlink" title="ä»£ç æ¼”ç¤º"></a>ä»£ç æ¼”ç¤º</h4><h5 id="1-é”™è¯¯çš„æµç¨‹"><a href="#1-é”™è¯¯çš„æµç¨‹" class="headerlink" title="(1)é”™è¯¯çš„æµç¨‹"></a>(1)é”™è¯¯çš„æµç¨‹</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">getUserProfile: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">// å¾®ä¿¡å°ç¨‹åºæˆæƒæ¡†</span></span><br><span class="line">    wx.getUserProfile(&#123;</span><br><span class="line">        desc: <span class="string">'ç”¨äºå®Œå–„ä¼šå‘˜èµ„æ–™'</span>,</span><br><span class="line">        success: <span class="function">(<span class="params">userResult</span>) =&gt;</span> &#123;</span><br><span class="line">            wx.login(&#123;</span><br><span class="line">                success (loginResult) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (loginResult.code) &#123;</span><br><span class="line">                        <span class="comment">//å‘èµ·ç½‘ç»œè¯·æ±‚,æ•°æ®è§£å¯†</span></span><br><span class="line">                        wx.request(&#123;</span><br><span class="line">                            url: <span class="string">'https://test.com/onLogin'</span>,</span><br><span class="line">                            data: &#123;</span><br><span class="line">                                code: loginResult.code,</span><br><span class="line">                                iv: userResult.iv,</span><br><span class="line">                                encryptedData: userResult.encryptedData,</span><br><span class="line">                                rawData: userResult.rawData</span><br><span class="line">                            &#125;,</span><br><span class="line">                            success(res)&#123;</span><br><span class="line">                                <span class="comment">// è§£å¯†æˆåŠŸï¼Œå¹¶ç™»é™†</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="built_in">console</span>.log(<span class="string">'ç™»å½•å¤±è´¥ï¼'</span> + res.errMsg)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-æ­£ç¡®çš„æµç¨‹"><a href="#2-æ­£ç¡®çš„æµç¨‹" class="headerlink" title="(2)æ­£ç¡®çš„æµç¨‹"></a>(2)æ­£ç¡®çš„æµç¨‹</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–code</span></span><br><span class="line">onShow:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    wx.login(&#123;</span><br><span class="line">      success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        _this.setData(&#123;</span><br><span class="line">          code: res.code</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç”¨æˆ·ç‚¹å‡»äº†æˆæƒæŒ‰é’®</span></span><br><span class="line">getUserProfile: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">// æ£€æµ‹æˆæƒæ˜¯å¦è¿‡æœŸ</span></span><br><span class="line">    wx.checkSession(&#123;</span><br><span class="line">      success(checkRes) &#123;</span><br><span class="line">        <span class="comment">// è°ƒèµ·æˆæƒçª—å£</span></span><br><span class="line">        wx.getUserProfile(&#123;</span><br><span class="line">          lang: <span class="string">'zh_CN'</span>,</span><br><span class="line">          desc: <span class="string">'ç”¨äºå®Œå–„ä¼šå‘˜èµ„æ–™'</span>,</span><br><span class="line">          success: <span class="function">(<span class="params">userResult</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">//å‘èµ·ç½‘ç»œè¯·æ±‚,æ•°æ®è§£å¯†</span></span><br><span class="line">            wx.request(&#123;</span><br><span class="line">                url: <span class="string">'https://test.com/onLogin'</span>,</span><br><span class="line">                data: &#123;</span><br><span class="line">                    code: _this.data.code,</span><br><span class="line">                    iv: userResult.iv,</span><br><span class="line">                    encryptedData: userResult.encryptedData,</span><br><span class="line">                    rawData: userResult.rawData</span><br><span class="line">                &#125;,</span><br><span class="line">                success(res)&#123;</span><br><span class="line">                    <span class="comment">//è§£å¯†æˆåŠŸï¼Œå¹¶ç™»é™†</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail() &#123;</span><br><span class="line">          <span class="comment">//è¿‡æœŸé‡æ–°è·å–</span></span><br><span class="line">        _this.getCode();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h4><p>&emsp;æ­£ç¡®çš„å†™æ³•åœ¨<code>å¾®ä¿¡å¼€å‘è€…å·¥å…·</code>å’Œ<code>æ‰«ç é¢„è§ˆ</code>éƒ½æ— æ³•è°ƒèµ·å¾®ä¿¡æˆæƒæ¡†ï¼Œä¸€å®šè¦åœ¨<code>çœŸæœºè°ƒè¯•</code>å’Œå‘å¸ƒ<code>ä½“éªŒç‰ˆ</code>ä¸­æµ‹è¯•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¾®ä¿¡å°ç¨‹åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå¾®ä¿¡æ”¯ä»˜ApiV3ç‰ˆ-æ–°ç‰ˆå¾®ä¿¡æ”¯ä»˜å¼€å‘</title>
      <link href="/php%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98ApiV3%E7%89%88-%E6%96%B0%E7%89%88%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%BC%80%E5%8F%91/"/>
      <url>/php%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98ApiV3%E7%89%88-%E6%96%B0%E7%89%88%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<h4 id="å¾®ä¿¡æ”¯ä»˜æ–‡æ¡£"><a href="#å¾®ä¿¡æ”¯ä»˜æ–‡æ¡£" class="headerlink" title="å¾®ä¿¡æ”¯ä»˜æ–‡æ¡£"></a>å¾®ä¿¡æ”¯ä»˜æ–‡æ¡£</h4><p><a herf="https://pay.weixin.qq.com/wiki/doc/apiv3/apis/chapter3_1_1.shtml">ç»Ÿä¸€ä¸‹å•æ–‡æ¡£JsApi</a></p><h4 id="å‰æœŸå‡†å¤‡æµç¨‹"><a href="#å‰æœŸå‡†å¤‡æµç¨‹" class="headerlink" title="å‰æœŸå‡†å¤‡æµç¨‹"></a>å‰æœŸå‡†å¤‡æµç¨‹</h4><ol><li>å¾®ä¿¡å…¬ä¼—å·ç”³è¯·</li><li>æ”¯ä»˜å•†æˆ·å·ç”³è¯·</li><li>å¾®ä¿¡å…¬ä¼—å·ç»‘å®šæ”¯ä»˜å•†æˆ·å·<a id="more"></a> <img src="/phpå¾®ä¿¡æ”¯ä»˜ApiV3ç‰ˆ-æ–°ç‰ˆå¾®ä¿¡æ”¯ä»˜å¼€å‘/1.png">4.è®¾ç½®ç™½åå•ã€ç”ŸæˆAppSecretï¼ˆå¼€å‘-åŸºæœ¬é…ç½®ï¼‰ <img src="/phpå¾®ä¿¡æ”¯ä»˜ApiV3ç‰ˆ-æ–°ç‰ˆå¾®ä¿¡æ”¯ä»˜å¼€å‘/2.png">5.ç”³è¯·Apiè¯ä¹¦ã€è®¾ç½®APIv3å¯†é’¥ <img src="/phpå¾®ä¿¡æ”¯ä»˜ApiV3ç‰ˆ-æ–°ç‰ˆå¾®ä¿¡æ”¯ä»˜å¼€å‘/3.png">6.è®¾ç½®æ”¯ä»˜é…ç½®ã€jsapiæ”¯ä»˜æˆæƒç›®å½•ã€Nativeæ”¯ä»˜å›è°ƒé“¾æ¥ï¼ˆäº§å“ä¸­å¿ƒ-å¼€å‘é…ç½®ï¼‰ <img src="/phpå¾®ä¿¡æ”¯ä»˜ApiV3ç‰ˆ-æ–°ç‰ˆå¾®ä¿¡æ”¯ä»˜å¼€å‘/4.png"><h4 id="æ”¯ä»˜æµç¨‹"><a href="#æ”¯ä»˜æµç¨‹" class="headerlink" title="æ”¯ä»˜æµç¨‹"></a>æ”¯ä»˜æµç¨‹</h4> 1.å‰ç«¯è°ƒç”¨åç«¯ä¸‹å•æ¥å£ <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºè®¢å•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>active </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>mobile </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>token </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createOrder</span>(<span class="params">active, mobile, token</span>) </span>&#123;</span><br><span class="line">    $.showLoading();</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">'post'</span>,</span><br><span class="line">        url: url,</span><br><span class="line">        data: &#123; <span class="string">'active'</span>: active, <span class="string">'pay_type'</span>: <span class="string">'wechat'</span>, <span class="string">'mobile'</span>: mobile &#125;,</span><br><span class="line">        dataType: <span class="string">'json'</span>,</span><br><span class="line">        beforeSend: <span class="function"><span class="keyword">function</span> (<span class="params">XMLHttpRequest</span>) </span>&#123;</span><br><span class="line">            XMLHttpRequest.setRequestHeader(<span class="string">"token"</span>, token);</span><br><span class="line">        &#125;,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (res.status == <span class="string">'error'</span> || res.code != <span class="number">200</span>) &#123;</span><br><span class="line">                    $.toptip(res.message, <span class="string">'warning'</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                WeixinJSBridge.invoke(<span class="string">'getBrandWCPayRequest'</span>, &#123;</span><br><span class="line">                    <span class="string">"appId"</span>: res.data.appId,</span><br><span class="line">                    <span class="string">"timeStamp"</span>: res.data.timeStamp,</span><br><span class="line">                    <span class="string">"nonceStr"</span>: res.data.nonceStr,</span><br><span class="line">                    <span class="string">"package"</span>: res.data.package,</span><br><span class="line">                    <span class="string">"signType"</span>: res.data.signType,</span><br><span class="line">                    <span class="string">"paySign"</span>: res.data.paySign</span><br><span class="line">                &#125;,</span><br><span class="line">                    <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> (res.err_msg == <span class="string">"get_brand_wcpay_request:ok"</span>) &#123;</span><br><span class="line">                            $.toptip(<span class="string">'æ”¯ä»˜æˆåŠŸ'</span>, <span class="string">'success'</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                toLogin();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            $.toptip(<span class="string">'ç½‘ç»œé”™è¯¯'</span>, <span class="string">'warning'</span>)</span><br><span class="line">        &#125;, <span class="attr">complete</span>: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            $.hideLoading();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;a href=<span class="string">"javascript:;"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"weui-btn weui-btn_primary"</span> onclick=<span class="string">"createOrder(1,mobile,token)"</span>&gt;ç«‹å³æ”¯ä»˜&lt;<span class="regexp">/a&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>2.å¤„ç†ä¿¡æ¯ã€ç”Ÿæˆè®¢å•ã€è¿”å›æ”¯ä»˜ä¿¡æ¯<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆè®¢å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $mobile</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $active</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $payType</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array|mixed</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ApiException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> \Throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createOrder</span><span class="params">($userId, $mobile, $active = <span class="number">1</span>, $payType = <span class="string">'wechat'</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        DB::beginTransaction();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;countWaitOrderByUserId($userId)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ApiException(<span class="string">'æ‚¨æœ‰æœªæ”¯ä»˜çš„è®¢å•ï¼Œè¯·å…ˆå¤„ç†å®Œæ¯•'</span>, <span class="number">500</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $activity = <span class="keyword">$this</span>-&gt;findActive($active);</span><br><span class="line">            <span class="keyword">if</span> (!$activity) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ApiException(<span class="string">'å……å€¼é‡‘é¢æœ‰è¯¯'</span>, <span class="number">500</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $orderId = StringHelper::getOrderId(<span class="string">'R'</span>);</span><br><span class="line">            $orderData = [</span><br><span class="line">                <span class="string">'order_id'</span> =&gt; $orderId,</span><br><span class="line">                <span class="string">'user_id'</span> =&gt; $userId,</span><br><span class="line">                <span class="string">'original_price'</span> =&gt; $activity-&gt;original_price,</span><br><span class="line">                <span class="string">'price'</span> =&gt; $activity-&gt;price,</span><br><span class="line">                <span class="string">'pay_type'</span> =&gt; $payType,</span><br><span class="line">                <span class="string">'mobile'</span> =&gt; $mobile,</span><br><span class="line">                <span class="string">'active'</span> =&gt; $active</span><br><span class="line">            ];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;insertOrder($orderData)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ApiException(<span class="string">'è®¢å•åˆ›å»ºå¤±è´¥'</span>, <span class="number">500</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è¯·æ±‚å¾®ä¿¡ç»Ÿä¸€ä¸‹å•</span></span><br><span class="line">            <span class="keyword">if</span> ($result = <span class="keyword">$this</span>-&gt;payOrder($orderId, $userId)) &#123;</span><br><span class="line">                DB::commit();</span><br><span class="line">                <span class="keyword">return</span> $result;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApiException(<span class="string">'ç»Ÿä¸€ä¸‹å•å¤±è´¥'</span>, <span class="number">500</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (\<span class="keyword">Exception</span> $exception) &#123;</span><br><span class="line">            DB::rollBack();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApiException($exception-&gt;getMessage(), <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¾®ä¿¡ç»Ÿä¸€ä¸‹å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $orderId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ApiException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> GuzzleException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">payOrder</span><span class="params">($orderId, $userId)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $orderInfo = <span class="keyword">$this</span>-&gt;findOrderByOrderId($orderId);</span><br><span class="line">        <span class="keyword">if</span> (!$orderInfo || $orderInfo-&gt;user_id != $userId) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApiException(<span class="string">'è®¢å•ä¸å­˜åœ¨'</span>, <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $userInfo = (<span class="keyword">new</span> UserService())-&gt;findUserById($userId, [<span class="string">'openid'</span>]);</span><br><span class="line">        <span class="keyword">if</span> (!$userInfo) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApiException(<span class="string">'ç”¨æˆ·ä¸å­˜åœ¨'</span>, <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!$userInfo-&gt;openid) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApiException(<span class="string">'è¯·å…ˆç»‘å®šå¾®ä¿¡'</span>, <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $payParam = config(<span class="string">'wechat.config'</span>);</span><br><span class="line">        <span class="comment">//ç»Ÿä¸€ä¸‹å•å‚æ•°</span></span><br><span class="line">        $payConfig = [</span><br><span class="line">            <span class="string">'appid'</span> =&gt; $payParam[<span class="string">'appId'</span>],</span><br><span class="line">            <span class="string">'mchid'</span> =&gt; $payParam[<span class="string">'mchId'</span>],</span><br><span class="line">            <span class="string">'description'</span> =&gt; $orderInfo[<span class="string">'price'</span>] . <span class="string">'è¯è´¹å……å€¼-è¯è´¹æ…¢å……72å°æ—¶å†…åˆ°è´¦'</span>,</span><br><span class="line">            <span class="string">'out_trade_no'</span> =&gt; $orderId,</span><br><span class="line">            <span class="string">'notify_url'</span> =&gt; $payParam[<span class="string">'notifyUrl'</span>],</span><br><span class="line">            <span class="string">'amount'</span> =&gt; [</span><br><span class="line">                <span class="string">'total'</span> =&gt; $orderInfo[<span class="string">'price'</span>],</span><br><span class="line">                <span class="string">'currency'</span> =&gt; <span class="string">'CNY'</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">'payer'</span> =&gt; [</span><br><span class="line">                <span class="string">'openid'</span> =&gt; $userInfo[<span class="string">'openid'</span>]</span><br><span class="line">            ]</span><br><span class="line">        ];</span><br><span class="line">        <span class="comment">// é‡ç‚¹ï¼Œå¾®ä¿¡apiv3å¿…é¡»åœ¨headersé‡Œè®¾ç½®å››ä¸ªå‚æ•°</span></span><br><span class="line">        $client = <span class="keyword">new</span> Client();</span><br><span class="line">        $httpClient = $client-&gt;post($payParam[<span class="string">'payUrl'</span>], [</span><br><span class="line">            <span class="string">'headers'</span> =&gt; [</span><br><span class="line">                <span class="string">'Content-Type'</span> =&gt; <span class="string">'application/json'</span>,</span><br><span class="line">                <span class="string">'User-Agent'</span> =&gt; <span class="string">'Mozilla/4.0'</span>,</span><br><span class="line">                <span class="string">'Accept'</span> =&gt; <span class="string">'application/json'</span>,</span><br><span class="line">                <span class="string">'Authorization'</span> =&gt; StringHelper::getAuth($payParam[<span class="string">'payUrl'</span>], json_encode($payConfig), <span class="string">'POST'</span>)</span><br><span class="line">            ],</span><br><span class="line">            <span class="string">'json'</span> =&gt; $payConfig</span><br><span class="line">        ]);</span><br><span class="line">        $result = $httpClient-&gt;getBody()</span><br><span class="line">            -&gt;getContents();</span><br><span class="line">        $payResult = json_decode($result, <span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">if</span> ($httpClient-&gt;getStatusCode() != <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApiException(<span class="string">'æ”¯ä»˜é”™è¯¯'</span>, <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($payResult[<span class="string">'errcode'</span>])) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApiException($payResult[<span class="string">'errmsg'</span>], <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($payResult[<span class="string">'code'</span>])) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApiException($payResult[<span class="string">'code'</span>], <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è·å–æ”¯ä»˜å‚æ•°</span></span><br><span class="line">        $appId = $payParam[<span class="string">'appId'</span>];</span><br><span class="line">        $time = time();</span><br><span class="line">        $str = StringHelper::createNonce();</span><br><span class="line">        $prepayId = <span class="string">'prepay_id='</span> . $payResult[<span class="string">'prepay_id'</span>];</span><br><span class="line">        $message = $appId . <span class="string">"\n"</span> .</span><br><span class="line">            $time . <span class="string">"\n"</span> .</span><br><span class="line">            $str . <span class="string">"\n"</span> .</span><br><span class="line">            $prepayId . <span class="string">"\n"</span>;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">'appId'</span> =&gt; $payParam[<span class="string">'appId'</span>],</span><br><span class="line">            <span class="string">'timeStamp'</span> =&gt; $time,</span><br><span class="line">            <span class="string">'nonceStr'</span> =&gt; $str,</span><br><span class="line">            <span class="string">'package'</span> =&gt; <span class="string">'prepay_id='</span> . $payResult[<span class="string">'prepay_id'</span>],</span><br><span class="line">            <span class="string">'signType'</span> =&gt; <span class="string">'RSA'</span>,</span><br><span class="line">            <span class="string">'paySign'</span> =&gt; StringHelper::getSign($message)</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”Ÿæˆå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">createNonce</span><span class="params">($length = <span class="number">32</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $chars = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789"</span>;</span><br><span class="line">        $str = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $length; $i++) &#123;</span><br><span class="line">            $str .= substr($chars, mt_rand(<span class="number">0</span>, strlen($chars) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”Ÿæˆauth</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getAuth</span><span class="params">($url, $body, $type = <span class="string">'POST'</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $config = Config::get(<span class="string">'wechat.config'</span>);</span><br><span class="line">        $nonce = <span class="keyword">self</span>::createNonce();</span><br><span class="line">        $timestamp = time();</span><br><span class="line">        $url_parts = parse_url($url);</span><br><span class="line">        $canonical_url = ($url_parts[<span class="string">'path'</span>] . (!<span class="keyword">empty</span>($url_parts[<span class="string">'query'</span>]) ? <span class="string">"?$&#123;url_parts['query']&#125;"</span> : <span class="string">""</span>));</span><br><span class="line">        $message = $type . <span class="string">"\n"</span> .</span><br><span class="line">            $canonical_url . <span class="string">"\n"</span> .</span><br><span class="line">            $timestamp . <span class="string">"\n"</span> .</span><br><span class="line">            $nonce . <span class="string">"\n"</span> .</span><br><span class="line">            $body . <span class="string">"\n"</span>;</span><br><span class="line">        $sign = <span class="keyword">self</span>::getSign($message);</span><br><span class="line">        $schema = <span class="string">'WECHATPAY2-SHA256-RSA2048'</span>;</span><br><span class="line">        $token = sprintf(<span class="string">'mchid="%s",nonce_str="%s",timestamp="%d",serial_no="%s",signature="%s"'</span>,</span><br><span class="line">            $config[<span class="string">'mchId'</span>], $nonce, $timestamp, $config[<span class="string">'serialNo'</span>], $sign);</span><br><span class="line">        <span class="keyword">return</span> $schema . <span class="string">' '</span> . $token;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–è¯ä¹¦</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getSign</span><span class="params">($message)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $filePath = <span class="string">'../resources/cert/apiclient_key.pem'</span>;</span><br><span class="line">        openssl_sign($message, $raw_sign, openssl_get_privatekey(file_get_contents($filePath)), <span class="string">'sha256WithRSAEncryption'</span>);</span><br><span class="line">        <span class="keyword">return</span> base64_encode($raw_sign);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><h4 id="å®Œæˆæ”¯ä»˜"><a href="#å®Œæˆæ”¯ä»˜" class="headerlink" title="å®Œæˆæ”¯ä»˜"></a>å®Œæˆæ”¯ä»˜</h4><p>è¿™ç¯‡æ–‡ç« æ²¡æœ‰ä½¿ç”¨å¾®ä¿¡çš„sdkï¼Œæ‰€ä»¥ä»£ç é‡è¿˜æœ‰æœ‰ç‚¹å¤§çš„ï¼Œä¸è¿‡æ•´ä½“é€»è¾‘ç®€å•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¾®ä¿¡æ”¯ä»˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JetBrains2020å…¨å®¶æ¡¶æ¿€æ´»</title>
      <link href="/JetBrains2020%E5%85%A8%E5%AE%B6%E6%A1%B6%E6%BF%80%E6%B4%BB/"/>
      <url>/JetBrains2020%E5%85%A8%E5%AE%B6%E6%A1%B6%E6%BF%80%E6%B4%BB/</url>
      
        <content type="html"><![CDATA[<h4 id="å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ"><a href="#å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ" class="headerlink" title="å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ"></a>å®˜æ–¹ä¸‹è½½æœ€æ–°ç‰ˆ</h4><a href="https://www.jetbrains.com" target="_blank" rel="noopener">JetBrainså®˜ç½‘ä¸‹è½½</a><h5 id="äº²æµ‹å¯æ¿€æ´»"><a href="#äº²æµ‹å¯æ¿€æ´»" class="headerlink" title="äº²æµ‹å¯æ¿€æ´»"></a>äº²æµ‹å¯æ¿€æ´»</h5><blockquote><p>1.IntelliJ IDEA 2020.2åŠä»¥ä¸‹ç‰ˆæœ¬<br>2.PhpStorm 2020.2åŠä»¥ä¸‹ç‰ˆæœ¬<br>3.WebStorm 2020.2åŠä»¥ä¸‹ç‰ˆæœ¬<br><a id="more"></a></p></blockquote><h4 id="ä¸‹è½½è¡¥ä¸"><a href="#ä¸‹è½½è¡¥ä¸" class="headerlink" title="ä¸‹è½½è¡¥ä¸"></a>ä¸‹è½½è¡¥ä¸</h4><a href="https://www.daichongweb.cn/image/jetbrains-agent-2020.jar" target="_blank" rel="noopener">ä¸‹è½½è¡¥ä¸</a><h4 id="å¦‚ä½•æ¿€æ´»"><a href="#å¦‚ä½•æ¿€æ´»" class="headerlink" title="å¦‚ä½•æ¿€æ´»"></a>å¦‚ä½•æ¿€æ´»</h4><p>&emsp;(1).è¿è¡ŒIDEï¼ˆæ–°å®‰è£…çš„é€‰æ‹©<code>Evaluate</code>ï¼‰</p><p>&emsp;(2).éšä¾¿æ‰“å¼€æˆ–è€…åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼ŒæˆåŠŸåä¿æŒä¸åŠ¨</p><p>&emsp;(3).æŠŠè¡¥ä¸è§£å‹åçš„<code>jetbrains-agent.jar</code>æ‹–å…¥åˆ°IDEä¸­ï¼Œå¼¹æ¡†åç‚¹å‡»<code>Restart</code>ã€‚</p><p>&emsp;(4).é‡å¯åä¼šå¼¹å‡ºã€JetbrainsAgent é…ç½®åŠ©æ‰‹ã€‘ï¼Œé€‰æ‹©<code>Activation Code</code>ï¼Œå¤åˆ¶ä¸‹é¢çš„å®‰è£…å‚æ•°ï¼Œç„¶åç‚¹å‡»ä¸º<code>XXX</code>å®‰è£…å°±å¯ä»¥äº†ï¼ï¼ï¼</p><h4 id="å®‰è£…å‚æ•°"><a href="#å®‰è£…å‚æ•°" class="headerlink" title="å®‰è£…å‚æ•°"></a>å®‰è£…å‚æ•°</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LFq51qqupnaiTNn39w6zATiOTxZI2JYuRJEBlzmUDv4zeeNlXhMgJZVb0q5QkLr+CIUrSuNB7ucifrGXawLB4qswPOXYG7+ItDNUR/<span class="number">9</span>UkLTUWlnHLX07hnR1USOrWIjTmbytcIKEdaI6x0RskyotuItj84xxoSBP/iRBW2EHpOc</span><br></pre></td></tr></table></figure><h4 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h4><p>&emsp;(1).å®‰è£…æˆåŠŸåè¿˜æ˜¯è·³è½¬åˆ°æ¿€æ´»é¡µé¢ï¼Œè¯·å°è¯•æ–­ç½‘åå†æ“ä½œã€‚<br>&emsp;(2).æ–­ç½‘åè¿˜æ˜¯æ— æ³•ç ´è§£ï¼Œè¯·å°è¯•åˆ é™¤hostsè®¾ç½®çš„æ˜ å°„åå†æ“ä½œã€‚</p><h4 id="è‡´è°¢ğŸ™"><a href="#è‡´è°¢ğŸ™" class="headerlink" title="è‡´è°¢ğŸ™"></a>è‡´è°¢ğŸ™</h4><p>&emsp;å¥½ç”¨çš„è¯å°±è¯·è¯„è®ºä¸€ä¸‹å†èµ°å§ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fastjsonç±»å‹è½¬æ¢</title>
      <link href="/fastjson%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/"/>
      <url>/fastjson%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<h4 id="jsonStringè½¬map"><a href="#jsonStringè½¬map" class="headerlink" title="jsonStringè½¬map"></a>jsonStringè½¬map</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JSON.parseObject(string)</span><br></pre></td></tr></table></figure><h4 id="å®ä½“ç±»è½¬jsonstring"><a href="#å®ä½“ç±»è½¬jsonstring" class="headerlink" title="å®ä½“ç±»è½¬jsonstring"></a>å®ä½“ç±»è½¬jsonstring</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JSON.toJSONString(javaClass)</span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="å­˜å…¥redisé˜Ÿåˆ—ä¹‹å‰æ˜¯jsonStringï¼Œæ‹¿å‡ºæ¥å˜æˆobjectå¤„ç†åŠæ³•"><a href="#å­˜å…¥redisé˜Ÿåˆ—ä¹‹å‰æ˜¯jsonStringï¼Œæ‹¿å‡ºæ¥å˜æˆobjectå¤„ç†åŠæ³•" class="headerlink" title="å­˜å…¥redisé˜Ÿåˆ—ä¹‹å‰æ˜¯jsonStringï¼Œæ‹¿å‡ºæ¥å˜æˆobjectå¤„ç†åŠæ³•"></a>å­˜å…¥redisé˜Ÿåˆ—ä¹‹å‰æ˜¯jsonStringï¼Œæ‹¿å‡ºæ¥å˜æˆobjectå¤„ç†åŠæ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…ˆè½¬å­—ç¬¦</span></span><br><span class="line">String value = lotteryData.index(roomId, userId).toString();</span><br><span class="line"><span class="comment">// è½¬map</span></span><br><span class="line">JSON.parseObject(value);</span><br></pre></td></tr></table></figure><h4 id="å¦‚ä½•ç»„æˆä¸€ä¸ªå¤šç»´æ•°ç»„"><a href="#å¦‚ä½•ç»„æˆä¸€ä¸ªå¤šç»´æ•°ç»„" class="headerlink" title="å¦‚ä½•ç»„æˆä¸€ä¸ªå¤šç»´æ•°ç»„"></a>å¦‚ä½•ç»„æˆä¸€ä¸ªå¤šç»´æ•°ç»„</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¾‹å­</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"data"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"nickname"</span>: <span class="string">"æˆ´å´‡"</span>,</span><br><span class="line">            <span class="string">"userId"</span>: <span class="number">6144</span>,</span><br><span class="line">            <span class="string">"roomId"</span>: <span class="number">10086</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"nickname"</span>: <span class="string">"æˆ´å´‡"</span>,</span><br><span class="line">            <span class="string">"userId"</span>: <span class="number">2174</span>,</span><br><span class="line">            <span class="string">"roomId"</span>: <span class="number">10086</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"nickname"</span>: <span class="string">"æˆ´å´‡"</span>,</span><br><span class="line">            <span class="string">"userId"</span>: <span class="number">9997</span>,</span><br><span class="line">            <span class="string">"roomId"</span>: <span class="number">10086</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"code"</span>: <span class="string">"0"</span>,</span><br><span class="line">    <span class="string">"msg"</span>: <span class="string">"æ“ä½œæˆåŠŸï¼"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åšæ³•</span></span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">long</span> userId : rands) &#123;</span><br><span class="line">    <span class="keyword">if</span> (userId == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    String value = lotteryData.index(roomId, userId).toString();</span><br><span class="line">    list.add(JSON.parseObject(value));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macä¸‹ä½¿ç”¨homebrewå®‰è£…æŒ‡å®šç‰ˆæœ¬node</title>
      <link href="/mac%E4%B8%8B%E4%BD%BF%E7%94%A8homebrew%E5%AE%89%E8%A3%85%E6%8C%87%E5%AE%9A%E7%89%88%E6%9C%ACnode/"/>
      <url>/mac%E4%B8%8B%E4%BD%BF%E7%94%A8homebrew%E5%AE%89%E8%A3%85%E6%8C%87%E5%AE%9A%E7%89%88%E6%9C%ACnode/</url>
      
        <content type="html"><![CDATA[<h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><p>&emsp;macä¸‹çš„homebrewç›´æ¥ä½¿ç”¨<code>brew install node</code>å®‰è£…çš„nodeç‰ˆæœ¬æ˜¯<code>14.+</code>ï¼Œè¿™ç»™å¾ˆå¤šç¨‹åºå¸¦æ¥äº†é—®é¢˜ï¼Œå¦‚æœç›´æ¥å®‰è£…ä½ç‰ˆæœ¬çš„nodeä¼šé€ æˆâ€˜npmâ€™ç­‰æ— æ³•ä½¿ç”¨ã€‚</p><h4 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew remove node</span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="è§£ç»‘"><a href="#è§£ç»‘" class="headerlink" title="è§£ç»‘"></a>è§£ç»‘</h4><p>&emsp;å¸è½½ä¹‹åè¦å…ˆæŠŠä¹‹å‰nodeè§£é™¤è¿æ¥ã€‚<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew unlink node</span><br></pre></td></tr></table></figure></p><h4 id="æŸ¥æ‰¾å¯ç”¨çš„nodeç‰ˆæœ¬"><a href="#æŸ¥æ‰¾å¯ç”¨çš„nodeç‰ˆæœ¬" class="headerlink" title="æŸ¥æ‰¾å¯ç”¨çš„nodeç‰ˆæœ¬"></a>æŸ¥æ‰¾å¯ç”¨çš„nodeç‰ˆæœ¬</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew search node</span><br></pre></td></tr></table></figure><img src="/macä¸‹ä½¿ç”¨homebrewå®‰è£…æŒ‡å®šç‰ˆæœ¬node/img/2.png" width="500"><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node@10</span><br></pre></td></tr></table></figure><img src="/macä¸‹ä½¿ç”¨homebrewå®‰è£…æŒ‡å®šç‰ˆæœ¬node/img/3.png" width="500"><h4 id="æ·»åŠ ç¯å¢ƒå˜é‡"><a href="#æ·»åŠ ç¯å¢ƒå˜é‡" class="headerlink" title="æ·»åŠ ç¯å¢ƒå˜é‡"></a>æ·»åŠ ç¯å¢ƒå˜é‡</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.bash_profile</span><br><span class="line">export PATH="/usr/local/opt/node@10/bin:$PATH"</span><br></pre></td></tr></table></figure><img src="/macä¸‹ä½¿ç”¨homebrewå®‰è£…æŒ‡å®šç‰ˆæœ¬node/img/4.png" width="500"><p>&emsp;ç»è¿‡æ­¤æ­¥éª¤è¿˜æ˜¯æ— æ³•åœ¨ç»ˆç«¯ä½¿ç”¨â€˜node -vâ€™å°±å¢åŠ <br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.bash_profile</span><br><span class="line">alias node='/usr/local/opt/node@10/bin/node'</span><br></pre></td></tr></table></figure></p><p>&emsp;æ— æ³•ä½¿ç”¨<code>npm</code>ç­‰æƒ…å†µæ‰§è¡Œ<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew link --overwrite --force node@10</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpç”Ÿæˆæµ·æŠ¥å›¾å‡ºç°å›¾ç‰‡æŸåçš„é—®é¢˜</title>
      <link href="/php%E7%94%9F%E6%88%90%E6%B5%B7%E6%8A%A5%E5%9B%BE%E5%87%BA%E7%8E%B0%E5%9B%BE%E7%89%87%E6%8D%9F%E5%9D%8F%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/php%E7%94%9F%E6%88%90%E6%B5%B7%E6%8A%A5%E5%9B%BE%E5%87%BA%E7%8E%B0%E5%9B%BE%E7%89%87%E6%8D%9F%E5%9D%8F%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>&emsp;è¿‘å¹´å°ç¨‹åºã€å¾®ä¿¡å‘å±•è¿…é€Ÿã€‚å¾®ä¿¡ã€å¾®åšç—…æ¯’å¼ä¼ æ’­ä½¿ç”¨æˆ·ä»ä¼ ç»Ÿçš„APPä¸Šå‘<code>å³æ‰«å³ç”¨ã€æ— éœ€å®‰è£…</code>çš„å°ç¨‹åºä¸Šè½¬åŒ–ã€‚è€Œå¾®ä¿¡å…¬ä¼—å·ã€å°ç¨‹åºçš„è¿…é€Ÿå‘å±•ç¦»ä¸å¼€è½¬å‘ã€äºŒç»´ç åˆ†äº«ã€‚</p><p>&emsp;ä½†æ˜¯äºŒç»´ç å½¢å¼å•ä¸€ï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ¯«æ— å¸å¼•åŠ›ã€‚çº¯ç²¹ä¾é â€˜å†å–ã€é‡‘é’±ã€ç¤¼ç‰©å¸å¼•â€™æ–¹å¼å·²ç»å˜å¾—æ„ˆæ¥æ„ˆæ— ä»·å€¼ã€‚</p><p>&emsp;å¯¹äºâ€™è§†è§‰åŠ¨ç‰©â€™å’Œå¤§éƒ¨åˆ†ç”¨æˆ·æ¥è¯´ï¼Œç²¾ç¾çš„å›¾ç‰‡åŠ ä¸ŠäºŒç»´ç çš„ç»„åˆæ›´å…·æœ‰å¸å¼•åŠ›ã€‚<br><a id="more"></a><br><img src="/phpç”Ÿæˆæµ·æŠ¥å›¾å‡ºç°å›¾ç‰‡æŸåçš„é—®é¢˜/img/3.jpg"></p><h4 id="phpç”Ÿæˆæµ·æŠ¥å›¾å‰ææ¡ä»¶"><a href="#phpç”Ÿæˆæµ·æŠ¥å›¾å‰ææ¡ä»¶" class="headerlink" title="phpç”Ÿæˆæµ·æŠ¥å›¾å‰ææ¡ä»¶"></a>phpç”Ÿæˆæµ·æŠ¥å›¾å‰ææ¡ä»¶</h4><ul><li>gdåº“æ‰©å±•</li></ul><h4 id="ä¸Šä»£ç "><a href="#ä¸Šä»£ç " class="headerlink" title="ä¸Šä»£ç "></a>ä¸Šä»£ç </h4><h5 id="ç”Ÿæˆæ–¹æ³•"><a href="#ç”Ÿæˆæ–¹æ³•" class="headerlink" title="ç”Ÿæˆæ–¹æ³•"></a>ç”Ÿæˆæ–¹æ³•</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿæˆæ–¹æ³•</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">createPoster</span><span class="params">($data)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $poster = <span class="keyword">new</span> Poster();</span><br><span class="line">        <span class="comment">//åˆ›å»ºç”»å¸ƒ</span></span><br><span class="line">        $im = $poster-&gt;createTrueColor(<span class="number">672</span>, <span class="number">1060</span>);</span><br><span class="line">        <span class="comment">//å­—ä½“æ–‡ä»¶</span></span><br><span class="line">        $font_file = <span class="keyword">$this</span>-&gt;typeface;</span><br><span class="line">        <span class="comment">// å•†å“å›¾ç‰‡</span></span><br><span class="line">        $goodsImg = $poster-&gt;createImgBoard($im, $data[<span class="string">'goodsPath'</span>], <span class="number">0</span>, <span class="number">0</span>, <span class="number">672</span>, <span class="number">668</span>);</span><br><span class="line">        <span class="comment">//äºŒç»´ç </span></span><br><span class="line">        $codeImg = $poster-&gt;createImgBoard($im, $data[<span class="string">'qrcode'</span>], <span class="number">410</span>, <span class="number">710</span>, <span class="number">225</span>, <span class="number">225</span>);</span><br><span class="line">        <span class="comment">//headimg</span></span><br><span class="line">        $headImg = $poster-&gt;createImgBoard($im, $data[<span class="string">'headimg'</span>], <span class="number">46</span>, <span class="number">942</span>, <span class="number">65</span>, <span class="number">65</span>);</span><br><span class="line">        <span class="comment">//btnimg</span></span><br><span class="line">        $btnimg = $poster-&gt;createImgBoard($im, $data[<span class="string">'btn'</span>], <span class="number">420</span>, <span class="number">960</span>, <span class="number">220</span>, <span class="number">48</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»·æ ¼</span></span><br><span class="line">        $price_font = ImageColorAllocate($im, <span class="number">248</span>, <span class="number">6</span>, <span class="number">74</span>);</span><br><span class="line">        imagettftext($im, <span class="number">25</span>, <span class="number">0</span>, <span class="number">41</span>, <span class="number">759</span>, $price_font, $font_file, <span class="string">'Â¥'</span>);</span><br><span class="line">        imagettftext($im, <span class="number">38</span>, <span class="number">0</span>, <span class="number">60</span>, <span class="number">760</span>, $price_font, $font_file, $data[<span class="string">"price"</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å•†å“åç§°</span></span><br><span class="line">        $goodsName = trim(mb_substr($data[<span class="string">'title'</span>], <span class="number">0</span>, <span class="number">20</span>));</span><br><span class="line">        $good_font = ImageColorAllocate($im, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        imagettftext($im, <span class="number">24</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">820</span>, $good_font, $font_file, $poster-&gt;AutoWrap(<span class="number">12</span>, <span class="number">0</span>, $font_file, $goodsName, <span class="number">160</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ˜µç§°</span></span><br><span class="line">        $nickname = trim(mb_substr($data[<span class="string">'nickname'</span>], <span class="number">0</span>, <span class="number">8</span>));</span><br><span class="line">        $nick_font = ImageColorAllocate($im, <span class="number">109</span>, <span class="number">114</span>, <span class="number">120</span>);</span><br><span class="line">        imagettftext($im, <span class="number">16</span>, <span class="number">0</span>, <span class="number">130</span>, <span class="number">965</span>, $nick_font, $font_file, $poster-&gt;AutoWrap(<span class="number">12</span>, <span class="number">0</span>, $font_file, $nickname, <span class="number">80</span>));</span><br><span class="line">        imagettftext($im, <span class="number">16</span>, <span class="number">0</span>, <span class="number">130</span>, <span class="number">1000</span>, $nick_font, $font_file, $data[<span class="string">'time'</span>]);</span><br><span class="line">        ob_clean();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        <span class="comment">// è¾“å‡ºå›¾ç‰‡</span></span><br><span class="line">        $poster-&gt;lookImg($im);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é‡Šæ”¾ç©ºé—´</span></span><br><span class="line">        imagedestroy($im);</span><br><span class="line">        imagedestroy($btnimg);</span><br><span class="line">        imagedestroy($goodsImg);</span><br><span class="line">        imagedestroy($codeImg);</span><br><span class="line">        imagedestroy($headImg);</span><br><span class="line">        <span class="comment">// åˆ é™¤æœ¬åœ°äºŒç»´ç </span></span><br><span class="line">        Qrcode::deleteCode($data[<span class="string">'qrcode'</span>]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h5 id="å®ç°ç±»"><a href="#å®ç°ç±»" class="headerlink" title="å®ç°ç±»"></a>å®ç°ç±»</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…·ä½“ç±»</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">library</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  ç”Ÿæˆæµ·æŠ¥å›¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> daichongweb</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@url</span> daichongweb.cn,daichongweb.com</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Poster</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»å›¾ç‰‡æ–‡ä»¶åˆ›å»ºImageèµ„æº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $file å›¾ç‰‡æ–‡ä»¶ï¼Œæ”¯æŒurl</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool|resource    æˆåŠŸè¿”å›å›¾ç‰‡imageèµ„æºï¼Œå¤±è´¥è¿”å›false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createImageFromFile</span><span class="params">($file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">'/http(s)?:\/\//'</span>, $file)) &#123;</span><br><span class="line">            $fileSuffix = <span class="keyword">self</span>::getNetworkImgType($file);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $file_info = getimagesize($file);</span><br><span class="line">            $fileSuffix = $file_info[<span class="number">2</span>];</span><br><span class="line">            <span class="comment">// $fileSuffix = pathinfo($file, PATHINFO_EXTENSION);</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!$fileSuffix) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> ($fileSuffix) &#123;</span><br><span class="line">            <span class="comment">/*case 'jpeg':</span></span><br><span class="line"><span class="comment">                $theImage = <span class="doctag">@imagecreatefromjpeg</span>($file);</span></span><br><span class="line"><span class="comment">                break;*/</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">'2'</span>:</span><br><span class="line">                $theImage = imagecreatefromjpeg($file);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'3'</span>:</span><br><span class="line">                $theImage = @imagecreatefrompng($file);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'1'</span>:</span><br><span class="line">                $theImage = @imagecreatefromgif($file);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                $theImage = @imagecreatefromstring(file_get_contents($file));</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $theImage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–‡å­—æ¢è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">AutoWrap</span><span class="params">($fontsize, $angle, $fontface, $string, $width)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; mb_strlen($string); $i++) &#123;</span><br><span class="line">            $letter[] = mb_substr($string, $i, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($letter <span class="keyword">as</span> $l) &#123;</span><br><span class="line">            $teststr = $content . <span class="string">""</span> . $l;</span><br><span class="line">            $testbox = imagettfbbox($fontsize, $angle, $fontface, $teststr);</span><br><span class="line">            <span class="keyword">if</span> (($testbox[<span class="number">2</span>] &gt; $width) &amp;&amp; ($content !== <span class="string">""</span>)) &#123;</span><br><span class="line">                $content .= <span class="string">"\n"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            $content .= $l;</span><br><span class="line">        &#125;</span><br><span class="line">        $content = mb_convert_encoding($content, <span class="string">"html-entities"</span>, <span class="string">"utf-8"</span>);</span><br><span class="line">        <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNetworkImgType</span><span class="params">($url)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_NOBODY, <span class="number">1</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, <span class="number">3</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="number">3</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</span><br><span class="line">        curl_exec($ch);</span><br><span class="line">        $http_code = curl_getinfo($ch);</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($http_code[<span class="string">'http_code'</span>] == <span class="number">200</span>) &#123;</span><br><span class="line">            $theImgType = explode(<span class="string">'/'</span>, $http_code[<span class="string">'content_type'</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ($theImgType[<span class="number">0</span>] == <span class="string">'image'</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> $theImgType[<span class="number">1</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºçœŸå½©ç”»å¸ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $width</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $height</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $r</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $g</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $b</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> false|resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createTrueColor</span><span class="params">(int $width, int $height, $r = <span class="number">255</span>, $g = <span class="number">255</span>, $b = <span class="number">255</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $im = imagecreatetruecolor($width, $height);</span><br><span class="line">        $color = imagecolorallocate($im, $r, $g, $b);</span><br><span class="line">        imagefill($im, <span class="number">0</span>, <span class="number">0</span>, $color);</span><br><span class="line">        <span class="keyword">return</span> $im;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºå›¾åƒç”»å¸ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $im</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $imgUrl</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $dst_w</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $dst_h</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool|resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createImgBoard</span><span class="params">($im, $imgUrl, $dst_x, $dst_y, $dst_w, $dst_h)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">list</span>($width, $height) = getimagesize($imgUrl);</span><br><span class="line">        $imgBoard = Poster::createImageFromFile($imgUrl);</span><br><span class="line">        imagecopyresized($im, $imgBoard, $dst_x, $dst_y, <span class="number">0</span>, <span class="number">0</span>, $dst_w, $dst_h, $width, $height);</span><br><span class="line">        <span class="keyword">return</span> $imgBoard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $im</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">lookImg</span><span class="params">($im)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        header(<span class="string">"Content-type:text/html;charset=utf-8"</span>);</span><br><span class="line">        Header(<span class="string">"Content-Type: image/jpeg"</span>); <span class="comment">// jpeg ç”Ÿæˆä¼šæ›´å¿«ï¼Œpngç”Ÿæˆé€Ÿåº¦æ…¢ä½†æ˜¯é«˜æ¸…</span></span><br><span class="line">        imagejpeg($im);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å¾®ä¿¡äºŒç»´ç </span></span><br><span class="line">$codePath = Qrcode::createQrcode([</span><br><span class="line">    <span class="string">'scene'</span> =&gt; $scene,</span><br><span class="line">    <span class="string">'page'</span> =&gt; $path,</span><br><span class="line">    <span class="string">'width'</span> =&gt; <span class="string">'112'</span>,</span><br><span class="line">    <span class="string">'auto_color'</span> =&gt; <span class="keyword">false</span>,</span><br><span class="line">    <span class="string">'line_color'</span> =&gt; [</span><br><span class="line">        <span class="string">'r'</span> =&gt; <span class="number">0</span>,</span><br><span class="line">        <span class="string">'g'</span> =&gt; <span class="number">0</span>,</span><br><span class="line">        <span class="string">'b'</span> =&gt; <span class="number">0</span></span><br><span class="line">    ]</span><br><span class="line">]);</span><br><span class="line">$data = [</span><br><span class="line">    <span class="string">'bg'</span> =&gt; <span class="keyword">$this</span>-&gt;bg,</span><br><span class="line">    <span class="string">'goodsPath'</span> =&gt; $goodsPath,</span><br><span class="line">    <span class="string">'title'</span> =&gt; $goodsName,</span><br><span class="line">    <span class="string">'price'</span> =&gt; $goodsPrice,</span><br><span class="line">    <span class="string">'btn'</span> =&gt; <span class="keyword">$this</span>-&gt;btn,</span><br><span class="line">    <span class="string">'time'</span> =&gt; date(<span class="string">'Y-m-d H:i'</span>),</span><br><span class="line">    <span class="string">'qrcode'</span> =&gt; $codePath,</span><br><span class="line">    <span class="string">'headimg'</span> =&gt; $userInfo-&gt;headimgurl ? $userInfo-&gt;headimgurl : <span class="keyword">$this</span>-&gt;defaultHeadImg,</span><br><span class="line">    <span class="string">'nickname'</span> =&gt; $userInfo-&gt;nickname ? $userInfo-&gt;nickname : <span class="string">'ç‰¹æŠ±æŠ±'</span></span><br><span class="line">];</span><br><span class="line"><span class="keyword">$this</span>-&gt;createPoster($data);</span><br></pre></td></tr></table></figure><h4 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h4><div style="display: flex;justify-content: space-around;"><br>    <div style="display: inline-block;"><img src="/phpç”Ÿæˆæµ·æŠ¥å›¾å‡ºç°å›¾ç‰‡æŸåçš„é—®é¢˜/img/1.jpg" width="300"></div><div style="display: inline-block;"><img src="/phpç”Ÿæˆæµ·æŠ¥å›¾å‡ºç°å›¾ç‰‡æŸåçš„é—®é¢˜/img/2.jpg" width="300"></div><br></div><p>&emsp;ä»ä¸Šé¢ä¸¤ä¸ªå›¾å¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºï¼Œç¬¬äºŒå¼ å›¾ä¸‹é¢è¢«åˆ‡æ‰äº†ï¼Œè€Œä¸”ç”µè„‘æ˜¯æ‰“ä¸å¼€çš„ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„å…³é”®åœ¨äº<code>ob_clean();ob_end_clean();</code>ä¸¤ä¸ªå‡½æ•°ã€‚</p><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¸…ç©ºç¼“å†²åŒº</span></span><br><span class="line">ob_clean();</span><br><span class="line">ob_end_clean();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡å°ç¨‹åºæ”¯ä»˜</title>
      <link href="/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%94%AF%E4%BB%98/"/>
      <url>/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%94%AF%E4%BB%98/</url>
      
        <content type="html"><![CDATA[<h4 id="å°ç¨‹åºæ”¯ä»˜"><a href="#å°ç¨‹åºæ”¯ä»˜" class="headerlink" title="å°ç¨‹åºæ”¯ä»˜"></a>å°ç¨‹åºæ”¯ä»˜</h4><p>&emsp;ç°å¦‚ä»Šçš„å°ç¨‹åºæ„ˆå‘é‡è¦ï¼Œå¾®ä¿¡å°ç¨‹åºå¼€å‘ä¹Ÿæˆä¸ºå¼€å‘è€…å¿…é¡»æŒæ¡çš„é‡è¦çš„æŠ€èƒ½ä¹‹ä¸€ã€‚<br>&emsp;ç»è¿‡å¤šå¹´çš„å‘å±•ï¼Œå°ç¨‹åºå¼€å‘æ›´æ–°æ¢ä»£éå¸¸å¿«ï¼Œåœ¨æœ€è¿‘çš„å¼€å‘ä¸­å‘ç°ä¹‹å‰å°ç¨‹åºæ”¯ä»˜çš„å†™æ³•å·²ç»å®Œå…¨ä¸é€‚ç”¨äº†ï¼Œå®³å¾—æˆ‘ç ”ç©¶äº†å¾ˆä¹…ï¼Œç‰¹å†™ä¸€ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ã€‚</p><h4 id="å¼€å‘å‰æ"><a href="#å¼€å‘å‰æ" class="headerlink" title="å¼€å‘å‰æ"></a>å¼€å‘å‰æ</h4><p>&emsp;ï¼ˆ1ï¼‰å¼€é€šå¾®ä¿¡æ”¯ä»˜å•†æˆ·å·ã€‚<br>&emsp;ï¼ˆ2ï¼‰å¼€é€šå°ç¨‹åºã€‚<br>&emsp;ï¼ˆ3ï¼‰å¾®ä¿¡æ”¯ä»˜å¹³å°è®¾ç½®ç‰¹çº¦å•†æˆ·APPID,ç»‘å®šå°ç¨‹åºAppidã€‚ï¼ˆè¿™é‡Œè¦æ³¨æ„ï¼Œå°ç¨‹åºå’Œæ”¯ä»˜å•†æˆ·å¿…é¡»æ˜¯åŒä¸€ä¸ªä¸»ä½“ï¼‰ã€‚<br>&emsp;ï¼ˆ4ï¼‰å°ç¨‹åºç»‘å®šå¾®ä¿¡æ”¯ä»˜å•†æˆ·å·ã€‚</p><a id="more"></a><h4 id="å…·ä½“å·®åˆ«"><a href="#å…·ä½“å·®åˆ«" class="headerlink" title="å…·ä½“å·®åˆ«"></a>å…·ä½“å·®åˆ«</h4><p>&emsp;å¯ä»¥ä»å¾ˆä¹…ä¹‹å‰çš„æ–‡ç« çœ‹å‡ºï¼Œç°åœ¨çš„å°ç¨‹åºæ”¯ä»˜å¤šäº†ä¸€ä¸ªäºŒæ¬¡ç­¾åçš„æ­¥éª¤ï¼Œè¿™ç‚¹éœ€è¦å¤§å®¶æ³¨æ„ã€‚<br>&emsp;å…¶ä»–çš„æ­¥éª¤å€’æ˜¯æ²¡ä»€ä¹ˆå·®åˆ«ï¼Œå…·ä½“å¯ <a href="https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=9_1" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h4 id="ä¸Šä»£ç ï¼ˆåºŸè¯ä¸å¤šè¯´ï¼Œyii2å†™æ³•ï¼‰"><a href="#ä¸Šä»£ç ï¼ˆåºŸè¯ä¸å¤šè¯´ï¼Œyii2å†™æ³•ï¼‰" class="headerlink" title="ä¸Šä»£ç ï¼ˆåºŸè¯ä¸å¤šè¯´ï¼Œyii2å†™æ³•ï¼‰"></a>ä¸Šä»£ç ï¼ˆåºŸè¯ä¸å¤šè¯´ï¼Œyii2å†™æ³•ï¼‰</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        $user_id = FsRequest::userId(<span class="string">'true'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!$user_id) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">'è¯·å…ˆç™»å½•'</span>, [], <span class="number">201</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $data = \Yii::$app-&gt;request-&gt;post();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($data)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">'å‚æ•°ä¸å…¨'</span>, [], <span class="number">201</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $openId = WeixinUser::find()-&gt;where([<span class="string">'ecuid'</span> =&gt; $user_id])-&gt;select([<span class="string">'dingdang_mini'</span>])-&gt;one();</span><br><span class="line">        <span class="keyword">if</span> (!$openId) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">'æœªç»‘å®šå°ç¨‹åº'</span>, [], <span class="number">201</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $payParams = [</span><br><span class="line">            <span class="string">'appid'</span> =&gt; $appid,</span><br><span class="line">            <span class="string">'mch_id'</span> =&gt; $mch_id,</span><br><span class="line">            <span class="string">'nonce_str'</span> =&gt; WxHelper::createNoncestr(<span class="number">32</span>),</span><br><span class="line">            <span class="string">'sign'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">            <span class="string">'body'</span> =&gt; $data[<span class="string">'body'</span>],</span><br><span class="line">            <span class="string">'out_trade_no'</span> =&gt; $data[<span class="string">'orderId'</span>],</span><br><span class="line">            <span class="string">'total_fee'</span> =&gt; (int)($data[<span class="string">'price'</span>] * <span class="number">100</span>),</span><br><span class="line">            <span class="string">'openid'</span> =&gt; $openId-&gt;dingdang_mini,</span><br><span class="line">            <span class="string">'spbill_create_ip'</span> =&gt; $_SERVER[<span class="string">'REMOTE_ADDR'</span>],</span><br><span class="line">            <span class="string">'notify_url'</span> =&gt; <span class="string">'æ”¯ä»˜å›è°ƒ'</span>,</span><br><span class="line">            <span class="string">'trade_type'</span> =&gt; <span class="string">'JSAPI'</span>,</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        $payParams[<span class="string">'sign'</span>] = WxHelper::paySign($payParams, $key);</span><br><span class="line">        $xml = WxHelper::arrayToXml($payParams);</span><br><span class="line">        <span class="comment">// die($xml);</span></span><br><span class="line">        $payUrl = <span class="string">'https://api.mch.weixin.qq.com/pay/unifiedorder'</span>;</span><br><span class="line"></span><br><span class="line">        $curl = <span class="keyword">new</span> Curl();</span><br><span class="line">        $curl-&gt;setHeader(<span class="string">'Content-Type'</span>, <span class="string">'text/xml; charset=utf-8'</span>); <span class="comment">// xml</span></span><br><span class="line">        $curl-&gt;post($payUrl, $xml);</span><br><span class="line">        <span class="comment">// è¯·æ±‚å¤±è´¥</span></span><br><span class="line">        <span class="keyword">if</span> ($curl-&gt;error) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>($curl-&gt;errorMessage, [], <span class="number">201</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¾®ä¿¡è¿”å›é”™è¯¯</span></span><br><span class="line">            $result = WxHelper::xmlToArray($curl-&gt;response);</span><br><span class="line">            <span class="keyword">if</span> ($result[<span class="string">'result_code'</span>] == <span class="string">'FAIL'</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>($result[<span class="string">'err_code_des'</span>], [], <span class="number">201</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// äºŒæ¬¡ç­¾å</span></span><br><span class="line">            $payParamsResult = [</span><br><span class="line">                <span class="string">'appId'</span> =&gt; <span class="keyword">$this</span>-&gt;appid,</span><br><span class="line">                <span class="string">'nonceStr'</span> =&gt; WxHelper::createNoncestr(<span class="number">32</span>),</span><br><span class="line">                <span class="string">'package'</span> =&gt; <span class="string">'prepay_id='</span> . $result[<span class="string">'prepay_id'</span>],</span><br><span class="line">                <span class="string">'paySign'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'signType'</span> =&gt; <span class="string">'MD5'</span>,</span><br><span class="line">                <span class="string">'timeStamp'</span> =&gt; (string)time()</span><br><span class="line">            ];</span><br><span class="line">            $payParamsResult[<span class="string">'paySign'</span>] = WxHelper::paySign($payParamsResult, <span class="keyword">$this</span>-&gt;key);</span><br><span class="line">            FsResponse::jsonSuccess($payParamsResult);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">        <span class="keyword">return</span> FsResponse::jsonFaild($e-&gt;getCode(), $e-&gt;getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// å…·ä½“æ–¹æ³•</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">library</span>\<span class="title">wechat</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> \<span class="title">Curl</span>\<span class="title">Curl</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">models</span>\<span class="title">redis</span>\<span class="title">WxAccessToken</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">Exception</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Class WxHelper</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@package</span> app\library</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WxHelper</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// è·å–å°ç¨‹åºAccessToken</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getToken</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $token = WxAccessToken::get();</span><br><span class="line">        <span class="keyword">if</span> (!$token) &#123;</span><br><span class="line">            $url = <span class="string">'https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid='</span> . $appId . <span class="string">'&amp;secret='</span> . $secret;</span><br><span class="line">            $curl = <span class="keyword">new</span> Curl();</span><br><span class="line">            $curl-&gt;get($url);</span><br><span class="line">            <span class="keyword">if</span> ($curl-&gt;error) &#123;</span><br><span class="line">                WxAccessToken::delete();</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>($curl-&gt;errorMessage, [],<span class="number">210</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($curl-&gt;response-&gt;errcode)) &#123;</span><br><span class="line">                WxAccessToken::delete();</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>($curl-&gt;response-&gt;errmsg,[],<span class="number">210</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $token = $curl-&gt;response-&gt;access_token;</span><br><span class="line">            $time = $curl-&gt;response-&gt;expires_in;</span><br><span class="line">            WxAccessToken::set($token, $time - <span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $token;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">xmlToArray</span><span class="params">($xml)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//ç¦æ­¢å¼•ç”¨å¤–éƒ¨xmlå®ä½“</span></span><br><span class="line">        libxml_disable_entity_loader(<span class="keyword">true</span>);</span><br><span class="line">        $values = json_decode(json_encode(simplexml_load_string($xml, <span class="string">'SimpleXMLElement'</span>, LIBXML_NOCDATA)), <span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> $values;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">paySign</span><span class="params">($payParams, $key)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ksort($payParams);</span><br><span class="line">        $signString = <span class="keyword">self</span>::toUrlParams($payParams);</span><br><span class="line">        $signString .= <span class="string">'&amp;key='</span> . $key;</span><br><span class="line">        $signString = strtoupper(md5($signString));</span><br><span class="line">        <span class="keyword">return</span> $signString;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#ç”Ÿæˆéšæœºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">createNoncestr</span><span class="params">($length = <span class="number">7</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $chars = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ0123456789"</span>;</span><br><span class="line">        $str = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $length; $i++) &#123;</span><br><span class="line">            $str .= substr($chars, mt_rand(<span class="number">0</span>, strlen($chars) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">toUrlParams</span><span class="params">($payParams)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $buff = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">foreach</span> ($payParams <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($k != <span class="string">"sign"</span> &amp;&amp; $v != <span class="string">""</span> &amp;&amp; !is_array($v)) &#123;</span><br><span class="line">                $buff .= $k . <span class="string">"="</span> . $v . <span class="string">"&amp;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $buff = trim($buff, <span class="string">"&amp;"</span>);</span><br><span class="line">        <span class="keyword">return</span> $buff;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">arrayToXml</span><span class="params">($array)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $xml = <span class="string">"&lt;xml&gt;"</span>;</span><br><span class="line">        <span class="keyword">foreach</span> ($array <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">            <span class="keyword">if</span> (is_numeric($val)) &#123;</span><br><span class="line">                $xml .= <span class="string">"&lt;"</span> . $key . <span class="string">"&gt;"</span> . $val . <span class="string">"&lt;/"</span> . $key . <span class="string">"&gt;"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $xml .= <span class="string">"&lt;"</span> . $key . <span class="string">"&gt;&lt;![CDATA["</span> . $val . <span class="string">"]]&gt;&lt;/"</span> . $key . <span class="string">"&gt;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        $xml .= <span class="string">"&lt;/xml&gt;"</span>;</span><br><span class="line">        <span class="keyword">return</span> $xml;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>&emsp;å¾®ä¿¡æ”¯ä»˜æ¯”è¾ƒç®€å•ï¼Œåªæ˜¯æ–‡æ¡£å†™çš„ä¸æ¸…æ™°å¯¼è‡´å¼€å‘éš¾åº¦å¢åŠ ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å°ç¨‹åºæ”¯ä»˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpOffice/phpSpreadsheetå¯¼å‡ºexcel</title>
      <link href="/phpOffice-phpSpreadsheet%E5%AF%BC%E5%87%BAexcel/"/>
      <url>/phpOffice-phpSpreadsheet%E5%AF%BC%E5%87%BAexcel/</url>
      
        <content type="html"><![CDATA[<h4 id="åˆè¯†phpSpreadsheet"><a href="#åˆè¯†phpSpreadsheet" class="headerlink" title="åˆè¯†phpSpreadsheet"></a>åˆè¯†phpSpreadsheet</h4><p>&emsp;PHPSpreadsheetæ˜¯ç”±è€å¤–ä½¿ç”¨çº¯PHPç¼–å†™çš„Excelæ–‡ä»¶å¤„ç†æ‰©å±•ï¼Œä»–ä½¿ç”¨çš„æ˜¯æœ€æ–°å†™æ³•ï¼Œç›¸æ¯”PHPExcel(å·²ä¸å†ç»´æŠ¤)æ€§èƒ½æå‡å·¨å¤§ï¼Œä½¿ç”¨æ–¹æ³•å’Œå‡½æ•°åŸºæœ¬ç›¸åŒï¼Œå¯ä»¥å®Œå…¨çš„æ›¿ä»£PHPExcelã€‚ä½¿ç”¨PhpSpreadsheetå¯ä»¥è½»æ¾è¯»å–å’Œå†™å…¥Excelæ–‡æ¡£ï¼Œæ”¯æŒExcelçš„æ‰€æœ‰æ“ä½œã€‚</p><h5 id="è½¯ä»¶ä¾èµ–"><a href="#è½¯ä»¶ä¾èµ–" class="headerlink" title="è½¯ä»¶ä¾èµ–"></a>è½¯ä»¶ä¾èµ–</h5><ul><li>PHP5.6æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæ¨èPHP7</li><li>php_zipæ‰©å±•</li><li>php_gd2æ‰©å±•<a id="more"></a></li></ul><h5 id="PHPSpreadsheet-ç‰¹æ€§"><a href="#PHPSpreadsheet-ç‰¹æ€§" class="headerlink" title="PHPSpreadsheet ç‰¹æ€§"></a>PHPSpreadsheet ç‰¹æ€§</h5><ul><li><p>æ”¯æŒå¯¼å…¥å’Œå¯¼å‡º.xlsï¼Œ.xlsxï¼Œ.htmlï¼Œ.csvï¼Œ.pdfç­‰æ ¼å¼æ–‡ä»¶ã€‚</p></li><li><p>æä¾›ä¸°å¯Œçš„APIï¼Œæä¾›å•å…ƒæ ¼æ ·å¼è®¾ç½®ã€Excelè¡¨æ ¼å±æ€§è®¾ç½®ã€å›¾è¡¨è®¾ç½®ç­‰ç­‰è¯¸å¤šåŠŸèƒ½ã€‚ä½¿ç”¨PhpSpreadsheetå®Œå…¨å¯ä»¥ç”Ÿæˆä¸€ä¸ªå¤–è§‚ç»“æ„éƒ½æ»¡è¶³ä½ çš„Excelè¡¨æ ¼æ–‡ä»¶ã€‚</p></li><li><p>å“è¶Šçš„æ€§èƒ½ï¼Œå°¤å…¶åœ¨PHP7ä¸Šè¡¨ç°ä¼˜å¼‚ï¼Œæ¯”PHPExcelå¼ºå¤§å¾ˆå¤šã€‚</p></li></ul><h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="keyword">require</span> phpoffice/phpspreadsheet</span><br></pre></td></tr></table></figure><h4 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h4><p>&emsp;ä¸‹é¢å’±ä»¬æ¥åšä¸€ä¸ªé€šç”¨çš„å¯¼å‡ºExcelè¡¨æ ¼ç±»ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">common</span>\<span class="title">library</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">common</span>\<span class="title">exception</span>\<span class="title">BusiException</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpOffice</span>\<span class="title">PhpSpreadsheet</span>\<span class="title">IOFactory</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpOffice</span>\<span class="title">PhpSpreadsheet</span>\<span class="title">Spreadsheet</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¼å‡ºexcel class</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> daichongweb</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Export</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// è¡¨æ ¼åæ ‡</span></span><br><span class="line">    <span class="keyword">private</span> $cellIndex = [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'J'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'O'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>, <span class="string">'AA'</span>, <span class="string">'AB'</span>, <span class="string">'AC'</span>, <span class="string">'AD'</span>, <span class="string">'AE'</span>, <span class="string">'AF'</span>, <span class="string">'AG'</span>, <span class="string">'AH'</span>, <span class="string">'AI'</span>, <span class="string">'AJ'</span>, <span class="string">'AK'</span>, <span class="string">'AL'</span>, <span class="string">'AM'</span>, <span class="string">'AN'</span>, <span class="string">'AO'</span>, <span class="string">'AP'</span>, <span class="string">'AQ'</span>, <span class="string">'AR'</span>, <span class="string">'AS'</span>, <span class="string">'AT'</span>, <span class="string">'AU'</span>, <span class="string">'AV'</span>, <span class="string">'AW'</span>, <span class="string">'AX'</span>, <span class="string">'AY'</span>, <span class="string">'AZ'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤é…ç½®</span></span><br><span class="line">    <span class="keyword">public</span> $config = [</span><br><span class="line">        <span class="string">'bold'</span> =&gt; <span class="keyword">true</span>, <span class="comment">// åŠ ç²—</span></span><br><span class="line">        <span class="string">'size'</span> =&gt; <span class="number">12</span>, <span class="comment">// æ–‡å­—å¤§å°</span></span><br><span class="line">        <span class="string">'column'</span> =&gt; <span class="number">4</span>, <span class="comment">// è®¾ç½®åˆ—æ•°</span></span><br><span class="line">        <span class="string">'title'</span> =&gt; <span class="string">'é»˜è®¤å¯¼å‡º'</span>, <span class="comment">// è¡¨æ ¼æ ‡é¢˜</span></span><br><span class="line">        <span class="string">'name'</span> =&gt; <span class="string">'ç‰¹æŠ±æŠ±'</span>, <span class="comment">// æ–‡ä»¶å</span></span><br><span class="line">        <span class="string">'type'</span> =&gt; <span class="string">'Xls'</span>, <span class="comment">// å¯¼å‡ºæ ¼å¼</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤è¡¨å¤´</span></span><br><span class="line">    <span class="keyword">public</span> $tableHeader = [</span><br><span class="line">        <span class="string">'php'</span>,</span><br><span class="line">        <span class="string">'vue'</span>,</span><br><span class="line">        <span class="string">'java'</span>,</span><br><span class="line">        <span class="string">'go'</span>,</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> $tableDefaultData = [</span><br><span class="line">        [</span><br><span class="line">            <span class="string">'å¤©ä¸‹ç¬¬ä¸€'</span>,</span><br><span class="line">            <span class="string">'Vueç‰›é€¼'</span>,</span><br><span class="line">            <span class="string">'javaç‰›é€¼'</span>,</span><br><span class="line">            <span class="string">'goç‰›é€¼'</span>,</span><br><span class="line">        ],</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $tableHeader è¡¨å¤´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $tableDefaultData éœ€è¦å¯¼å‡ºæ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($tableHeader, $tableDefaultData)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($tableHeader)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BusiException(<span class="string">'export error'</span>, <span class="string">'è¯·è®¾ç½®è¡¨å¤´'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($tableDefaultData)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BusiException(<span class="string">'export error'</span>, <span class="string">'è¯·è®¾ç½®å¯¼å‡ºæ•°æ®'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;tableHeader = $tableHeader;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;config[<span class="string">'column'</span>] = count($tableHeader);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;tableDefaultData = $tableDefaultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºè¡¨æ ¼ createTable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createTable</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $spreadsheet = <span class="keyword">new</span> Spreadsheet();</span><br><span class="line">        $worksheet = $spreadsheet-&gt;getActiveSheet();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å±…ä¸­</span></span><br><span class="line">        $styleArray = [</span><br><span class="line">            <span class="string">'alignment'</span> =&gt; [</span><br><span class="line">                <span class="string">'horizontal'</span> =&gt; \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER,</span><br><span class="line">            ],</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®åŸºæœ¬å±æ€§</span></span><br><span class="line">        $worksheet-&gt;setTitle(<span class="keyword">$this</span>-&gt;config[<span class="string">'title'</span>]);</span><br><span class="line">        $worksheet-&gt;getStyle(<span class="keyword">$this</span>-&gt;getColumn())-&gt;applyFromArray($styleArray)</span><br><span class="line">            -&gt;getFont()</span><br><span class="line">            -&gt;setBold(<span class="keyword">$this</span>-&gt;config[<span class="string">'bold'</span>])</span><br><span class="line">            -&gt;setName(<span class="string">'Verdana'</span>)</span><br><span class="line">            -&gt;setSize(<span class="keyword">$this</span>-&gt;config[<span class="string">'size'</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;tableHeader <span class="keyword">as</span> $index =&gt; $name) &#123;</span><br><span class="line">            $worksheet-&gt;setCellValue(<span class="keyword">$this</span>-&gt;cellIndex[$index] . <span class="string">'1'</span>, $name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $baseRow = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;tableDefaultData <span class="keyword">as</span> $index =&gt; $data) &#123;</span><br><span class="line">            $i = $index + $baseRow;</span><br><span class="line">            <span class="keyword">for</span> ($k = <span class="number">0</span>; $k &lt;= <span class="keyword">$this</span>-&gt;config[<span class="string">'column'</span>] - <span class="number">1</span>; $k++) &#123;</span><br><span class="line">                $item = $data[$k];</span><br><span class="line">                $worksheet-&gt;setCellValue(<span class="keyword">$this</span>-&gt;cellIndex[$k] . $i, <span class="string">' '</span> . $item);</span><br><span class="line">                <span class="comment">// ä¸­æ–‡è®¾ç½®è¡¨æ ¼å®½åº¦</span></span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">"/[\x7f-\xff]/"</span>, $data[$k])) &#123;</span><br><span class="line">                    $worksheet-&gt;getColumnDimension(<span class="keyword">$this</span>-&gt;cellIndex[$k])-&gt;setWidth(strlen($item));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// éä¸­æ–‡è‡ªåŠ¨è®¾ç½®å®½åº¦</span></span><br><span class="line">                    $worksheet-&gt;getColumnDimension(<span class="keyword">$this</span>-&gt;cellIndex[$k])-&gt;setAutoSize(<span class="keyword">true</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        $worksheet-&gt;calculateColumnWidths();</span><br><span class="line">        <span class="keyword">self</span>::downloadExcel($spreadsheet, <span class="keyword">$this</span>-&gt;config[<span class="string">'name'</span>], <span class="string">'Xls'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ä¸‹è½½ downloadExcel</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data $spreadsheet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $filename</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $format</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">downloadExcel</span><span class="params">($spreadsheet, $filename, $format)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// $formatåªèƒ½ä¸º Xlsx æˆ– Xls</span></span><br><span class="line">        <span class="keyword">if</span> ($format == <span class="string">'Xlsx'</span>) &#123;</span><br><span class="line">            header(<span class="string">'Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> ($format == <span class="string">'Xls'</span>) &#123;</span><br><span class="line">            header(<span class="string">'Content-Type: application/vnd.ms-excel'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        header(<span class="string">"Content-Disposition: attachment;filename="</span></span><br><span class="line">            . urlencode($filename) . <span class="string">'.'</span> . strtolower($format)); <span class="comment">//. date('Y-m-d')</span></span><br><span class="line">        header(<span class="string">'Cache-Control: max-age=0'</span>);</span><br><span class="line">        $objWriter = IOFactory::createWriter($spreadsheet, $format);</span><br><span class="line">        $objWriter-&gt;save(<span class="string">'php://output'</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">getColumn</span><span class="params">($row = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $index = <span class="keyword">$this</span>-&gt;cellIndex[<span class="keyword">$this</span>-&gt;config[<span class="string">'column'</span>]];</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'A'</span> . $row . <span class="string">':'</span> . $index . $row;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">autoFitColumnWidthToContent</span><span class="params">($sheet, $fromCol, $toCol)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($toCol)) &#123; <span class="comment">//not defined the last column, set it the max one</span></span><br><span class="line">            $toCol = $sheet-&gt;getColumnDimension($sheet-&gt;getHighestColumn())-&gt;getColumnIndex();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> ($i = $fromCol; $i &lt;= $toCol; $i++) &#123;</span><br><span class="line">            $sheet-&gt;getColumnDimension($i)-&gt;setAutoSize(<span class="keyword">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $sheet-&gt;calculateColumnWidths();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">helper</span>\<span class="title">Export</span>;</span><br><span class="line">...</span><br><span class="line"><span class="comment">// è®¾ç½®è¡¨å¤´</span></span><br><span class="line">$export = <span class="keyword">new</span> Export(</span><br><span class="line">    [</span><br><span class="line">        <span class="string">'æµ‹è¯•æ ‡é¢˜'</span>,</span><br><span class="line">        <span class="string">'æµ‹è¯•æ ‡é¢˜2'</span>,</span><br><span class="line">        <span class="string">'æ—¶é—´'</span>,</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        [<span class="string">'11111111111111'</span>, <span class="string">'æµ‹è¯•æ•°æ®2'</span>, <span class="string">'2020-04-30'</span>],</span><br><span class="line">        [<span class="string">'æµ‹è¯•æ•°æ®1-1'</span>, <span class="string">'æµ‹è¯•æ•°æ®2-2'</span>, <span class="string">'2020-04-30'</span>],</span><br><span class="line">    ]</span><br><span class="line">);</span><br><span class="line"><span class="keyword">echo</span> $export-&gt;createTable();</span><br><span class="line"><span class="keyword">exit</span>;</span><br></pre></td></tr></table></figure><h4 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h4><img src="/phpOffice-phpSpreadsheetå¯¼å‡ºexcel/img/3.gif">]]></content>
      
      
      
        <tags>
            
            <tag> phpæ‰©å±•ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxè´Ÿè½½å‡è¡¡çš„å®ç°</title>
      <link href="/nginx%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
      <url>/nginx%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h4 id="è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ"></a>è´Ÿè½½å‡è¡¡æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>&emsp;è´Ÿè½½å‡è¡¡å»ºç«‹åœ¨ç°æœ‰ç½‘ç»œç»“æ„ä¹‹ä¸Šï¼Œå®ƒæä¾›äº†ä¸€ç§å»‰ä»·æœ‰æ•ˆé€æ˜çš„æ–¹æ³•æ‰©å±•ç½‘ç»œè®¾å¤‡å’ŒæœåŠ¡å™¨çš„å¸¦å®½ã€å¢åŠ ååé‡ã€åŠ å¼ºç½‘ç»œæ•°æ®å¤„ç†èƒ½åŠ›ã€æé«˜ç½‘ç»œçš„çµæ´»æ€§å’Œå¯ç”¨æ€§ã€‚</p><p>&emsp;è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰å…¶æ„æ€å°±æ˜¯åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿›è¡Œæ‰§è¡Œï¼Œä¾‹å¦‚WebæœåŠ¡å™¨ã€FTPæœåŠ¡å™¨ã€ä¼ä¸šå…³é”®åº”ç”¨æœåŠ¡å™¨å’Œå…¶å®ƒå…³é”®ä»»åŠ¡æœåŠ¡å™¨ç­‰ï¼Œä»è€Œå…±åŒå®Œæˆå·¥ä½œä»»åŠ¡ã€‚</p><h4 id="ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡"><a href="#ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡"></a>ä¸ºä»€ä¹ˆè¦åšè´Ÿè½½å‡è¡¡</h4><ul><li>æœåŠ¡å™¨æ€»æ˜¯å´©æºƒæ€ä¹ˆåŠï¼Ÿ</li><li>ä¸€å°æœåŠ¡å™¨æ‰›ä¸ä½å¤§é‡çš„å¹¶å‘æ€ä¹ˆåŠï¼Ÿ</li><li>â€¦â€¦</li></ul><p> &nbsp;æœ‰äº†è¿™äº›é—®é¢˜ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¸€å®šä¼šç”¨å¾—åˆ°è¿™ä¸ªæŠ€æœ¯ã€‚æœ€è®©äººé«˜å…´çš„ä¸€ç‚¹æ˜¯ï¼šåªéœ€è¦ä½ æ‡‚ç‚¹nginxçš„é…ç½®å°±èƒ½å®Œç¾çš„é©¾é©­è´Ÿè½½å‡è¡¡çš„é…ç½®ï¼Œè‡³äºé…ç½®ä¹‹åå¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œå†æ…¢æ…¢å»ç ”ç©¶ä¹Ÿä¸è¿Ÿã€‚<br><a id="more"></a></p><h4 id="æ¶æ„å›¾"><a href="#æ¶æ„å›¾" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h4><img src="/nginxè´Ÿè½½å‡è¡¡çš„å®ç°/img/1.png"><p>&emsp;ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬åˆ©ç”¨è´Ÿè½½å‡è¡¡å¯ä»¥å¾ˆå¥½çš„åº”å¯¹å¹¶å‘è¯·æ±‚è¿‡é«˜çš„æƒ…å†µï¼Œä½¿æ¯ä¸€å°æœåŠ¡å™¨å‘æŒ¥æœ€å¤§çš„æ•ˆç”¨ã€‚</p><h4 id="è´Ÿè½½å‡è¡¡çš„å®ç°æ–¹å¼"><a href="#è´Ÿè½½å‡è¡¡çš„å®ç°æ–¹å¼" class="headerlink" title="è´Ÿè½½å‡è¡¡çš„å®ç°æ–¹å¼"></a>è´Ÿè½½å‡è¡¡çš„å®ç°æ–¹å¼</h4><ul><li><p>è½®è¯¢(rr) ï¼šæŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨(é»˜è®¤);</p></li><li><p>æƒé‡(weight)ï¼šåŠ æƒè½®è¯¢(wrr)ã€‚weightå€¼è¶Šå¤§ï¼Œåˆ†é…åˆ°çš„è®¿é—®ç‡è¶Šé«˜;</p></li><li><p>æºIPåœ°å€hashè°ƒåº¦æ–¹æ³•(ip_hash):å°†æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®IPçš„hashå€¼æ¥åˆ†é…ï¼Œæ¥è‡ªåŒä¸€ä¸ªIPå›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨;</p></li><li><p>æœ€å°‘è¿æ¥æ•°(least_conn)ï¼šå½“serveræ‹¥æœ‰ä¸åŒçš„æƒé‡æ—¶ä¸ºwlcï¼Œå½“æ‰€æœ‰åç«¯ä¸»æœºï¼›è¿æ¥æ•°ç›¸åŒæ—¶ï¼Œåˆ™ä½¿ç”¨wrrï¼Œé€‚ç”¨äºé•¿è¿æ¥(keepalive_timeoutä¸ä¸º0);</p></li></ul><h4 id="å®æˆ˜é…ç½®"><a href="#å®æˆ˜é…ç½®" class="headerlink" title="å®æˆ˜é…ç½®"></a>å®æˆ˜é…ç½®</h4><p>&emsp;å‡†å¤‡ä¸‰å°æœåŠ¡å™¨ï¼šï¼ˆ1ï¼‰192.168.133.128ï¼ˆè°ƒåº¦å™¨ï¼‰ï¼ˆ2ï¼‰192.168.133.129ï¼ˆæœåŠ¡å™¨1ï¼‰ï¼ˆ3ï¼‰192.168.133.130ï¼ˆæœåŠ¡å™¨2ï¼‰<br>&emsp;åœ¨è°ƒåº¦æœåŠ¡å™¨ä¸­é…ç½®ï¼š<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">upstream 192.168.133.128&#123;</span><br><span class="line">    server 192.168.133.129:80 weight=1;</span><br><span class="line">    server 192.168.133.130:80 weight=1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#charset koi8-r;</span></span><br><span class="line">    <span class="comment">#access_log  /var/log/nginx/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">    client_max_body_size 50m;</span><br><span class="line">    client_body_buffer_size 256k;</span><br><span class="line"></span><br><span class="line">   location / &#123;</span><br><span class="line">       proxy_pass        http://192.168.133.128;</span><br><span class="line">       proxy_set_header X-Forwarded-For <span class="variable">$remote_addr</span>;</span><br><span class="line">       proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>&emsp;å…¶ä»–æœåŠ¡å™¨server_nameéƒ½é…ç½®æˆè‡ªå·±çš„IPå°±è¡Œã€‚åœ¨å„è‡ªçš„æœåŠ¡Htmlé‡Œå‘½åï¼ŒåŠ ä»¥åŒºåˆ†ã€‚</p><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><img src="/nginxè´Ÿè½½å‡è¡¡çš„å®ç°/img/2.gif">]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”¨æœ€å°‘çš„Sqlå®ç°ä¸€ä¸ªç‰¹æ®Šæ’è¡Œæ¦œ</title>
      <link href="/%E7%94%A8%E6%9C%80%E5%B0%91%E7%9A%84Sql%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%89%B9%E6%AE%8A%E6%8E%92%E8%A1%8C%E6%A6%9C/"/>
      <url>/%E7%94%A8%E6%9C%80%E5%B0%91%E7%9A%84Sql%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%89%B9%E6%AE%8A%E6%8E%92%E8%A1%8C%E6%A6%9C/</url>
      
        <content type="html"><![CDATA[<h4 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h4><p>&emsp;è¯´èµ·æ’è¡Œæ¦œä¸Šä¸€ç¯‡å·²ç»ä»‹ç»è¿‡äº†ç”¨Rediså®ç°çš„æ–¹æ³•ï¼Œè€Œè¿™ç¯‡å®Œå…¨æ˜¯ç”¨Sqlæ¥å®ç°ï¼Œä¸ä½¿ç”¨ä»»ä½•ç¼“å­˜ã€‚</p><h4 id="éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰"><a href="#éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰" class="headerlink" title="éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰"></a>éœ€æ±‚åŠŸèƒ½ï¼ˆ1ï¼‰</h4><p>&emsp;ç°æœ‰åä¸ªåŒå­¦ï¼Œå¹´é¾„åˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾ä½ æ˜¯<code>æˆ´ä¸ƒ</code>ï¼Œè¯·æ ¹æ®å¹´é¾„è·å¾—ä½ åœ¨è¿™åäººä¸­æ’ç¬¬å‡ ï¼ŸåŒæ—¶è¯·è·å¾—ä½ çš„å‰ä¸€åå’Œåä¸€åå„æ˜¯å“ªä¸€ä½åŒå­¦ï¼Ÿ</p><img src="/ç”¨æœ€å°‘çš„Sqlå®ç°ä¸€ä¸ªç‰¹æ®Šæ’è¡Œæ¦œ/img/1.png"><p>&emsp;è¿™ä¸ªé¢˜æ˜¯æˆ‘å»å¹´åœ¨ä¸€å®¶å…¬å¸è¢«é—®åˆ°çš„é¢è¯•é¢˜ã€‚æ ¹æ®ä¸Šå›¾åˆ†æï¼Œè·å–åˆ°è‡ªå·±çš„æ’åå¹¶ä¸æ˜¯éš¾äº‹ï¼Œé‚£å‰ä¸€åå’Œåä¸€åä¹Ÿéå¸¸ç®€å•äº†ã€‚<br><a id="more"></a></p><h5 id="è‡ªå·±çš„æ’å"><a href="#è‡ªå·±çš„æ’å" class="headerlink" title="è‡ªå·±çš„æ’å"></a>è‡ªå·±çš„æ’å</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// åŸç”Ÿå†™æ³•</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> <span class="string">`rank`</span> <span class="keyword">where</span> <span class="string">`age`</span> &gt; <span class="number">22</span> <span class="keyword">or</span> (<span class="string">`age`</span> = <span class="number">22</span> <span class="keyword">and</span> <span class="string">`created_at`</span> &gt; <span class="string">'2020-01-21 09:05:34'</span>);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Laravelæ¡†æ¶å†™æ³•</span></span><br><span class="line">$my = DB::table(<span class="string">'rank'</span>)-&gt;where(<span class="string">'name'</span>, <span class="string">'æˆ´ä¸ƒ'</span>)-&gt;first();</span><br><span class="line">$rank = DB::table(<span class="string">'rank'</span>)-&gt;where(<span class="string">'age'</span>, <span class="string">'&gt;'</span>, $my-&gt;age)-&gt;orWhere(<span class="function"><span class="keyword">function</span> <span class="params">($query)</span> <span class="title">use</span> <span class="params">($my)</span> </span>&#123;</span><br><span class="line">    $query-&gt;where(<span class="string">'age'</span>, <span class="string">'='</span>, $my-&gt;age)-&gt;where(<span class="string">'created_at'</span>, <span class="string">'&gt;'</span>, $my-&gt;created_at);</span><br><span class="line">&#125;)-&gt;count();</span><br><span class="line">$myRank = $rank + <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>&emsp;è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä¸¤ä¸ªäººçš„å¹´é¾„ç›¸åŒï¼Œé‚£ä¹ˆå°±è¦æ¯”è¾ƒæ—¶é—´ã€‚æœ€ç»ˆå¾—åˆ°çš„æ˜¯å¹´é¾„å¤§äºè‡ªå·±äººæœ‰å¤šå°‘ä¸ªï¼Œ+1å°±æ˜¯è‡ªå·±çš„æ’åã€‚</p><h5 id="å‰ä¸€å"><a href="#å‰ä¸€å" class="headerlink" title="å‰ä¸€å"></a>å‰ä¸€å</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// é€šè¿‡ä¸Šé¢çš„Sqlå¾—çŸ¥å¹´é¾„å¤§äºè‡ªå·±çš„äººæ•°æ˜¯6äºº</span><br><span class="line">$rankNum = 6;</span><br><span class="line">$top = $rankNum - 1;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">rank</span> <span class="keyword">where</span> age &gt; <span class="number">22</span> <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span> <span class="keyword">limit</span> $top,<span class="number">1</span></span><br></pre></td></tr></table></figure><h5 id="åä¸€å"><a href="#åä¸€å" class="headerlink" title="åä¸€å"></a>åä¸€å</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`rank`</span> <span class="keyword">where</span> <span class="string">`age`</span> &lt; <span class="number">22</span> <span class="keyword">or</span> (<span class="string">`age`</span> = <span class="number">22</span> <span class="keyword">and</span> <span class="string">`created_at`</span> &lt; <span class="string">'2020-01-21 09:05:34'</span>) <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>,created_at <span class="keyword">desc</span> <span class="keyword">limit</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>&emsp;è¿™é‡Œå’ŒåŸå§‹Sqlä¸åŒçš„æ˜¯ï¼šå¹´é¾„æ˜¯<code>&lt;22</code>ï¼Œæ—¶é—´ä¹Ÿæ˜¯<code>&lt;è‡ªå·±çš„å‡ºç”Ÿæ—¶é—´</code>ã€‚</p><h4 id="éœ€æ±‚åŠŸèƒ½ï¼ˆ2ï¼‰"><a href="#éœ€æ±‚åŠŸèƒ½ï¼ˆ2ï¼‰" class="headerlink" title="éœ€æ±‚åŠŸèƒ½ï¼ˆ2ï¼‰"></a>éœ€æ±‚åŠŸèƒ½ï¼ˆ2ï¼‰</h4><p>&emsp;è¿˜æ˜¯è¿™åååŒå­¦ï¼Œå‡è®¾<code>æˆ´ä¸ƒ</code>åŒå­¦å°±æ˜¯æœ¬äººï¼Œç°éœ€è¦äº”ååŒå­¦çš„å¹´é¾„ä½œä¸ºå‚è€ƒï¼Œè¦æ±‚è¿™åˆ†åˆ«å¾—çŸ¥ä½ æœ¬äººçš„å‰ä¸¤ååŒå­¦å’Œåä¸¤ååŒå­¦éƒ½æ˜¯è°ï¼ˆäº”ååŒå­¦ä¸­å¿…é¡»åŒ…å«ä½ è‡ªå·±ï¼‰ï¼Ÿ</p><h5 id="ç‰¹æ®Šæƒ…å†µï¼š"><a href="#ç‰¹æ®Šæƒ…å†µï¼š" class="headerlink" title="ç‰¹æ®Šæƒ…å†µï¼š"></a>ç‰¹æ®Šæƒ…å†µï¼š</h5><p>&emsp;ï¼ˆ1ï¼‰å¦‚æœä½ æ˜¯ç¬¬ä¸€åï¼Œé‚£ä¹ˆå°±è·å¾—ä½ åé¢çš„å››ä½åŒå­¦ã€‚<br>&emsp;ï¼ˆ2ï¼‰å¦‚æœä½ æ˜¯ç¬¬äºŒåï¼Œé‚£ä¹ˆå°±è·å¾—ä½ å‰é¢çš„ä¸€å+åé¢çš„ä¸‰ååŒå­¦ã€‚<br>&emsp;ï¼ˆ3ï¼‰å¦‚æœä½ æ˜¯å€’æ•°ç¬¬ä¸€åï¼Œé‚£ä¹ˆå°±è·å¾—ä½ å‰é¢çš„å››ä½åŒå­¦ã€‚<br>&emsp;ï¼ˆ4ï¼‰å¦‚æœä½ æ˜¯å€’æ•°ç¬¬äºŒåï¼Œé‚£ä¹ˆå°±è·å¾—ä½ å‰é¢çš„ä¸‰å+åé¢çš„ä¸€ä½åŒå­¦ã€‚<br>&emsp;ï¼ˆ5ï¼‰å¯ä½¿ç”¨å…¶ä»–è¯­è¨€è¾…åŠ©è§£å†³é—®é¢˜ï¼Œä½†å°½å¯èƒ½çš„ç®€å•æ¸…æ™°ã€‚</p><h4 id="ç­”æ¡ˆ"><a href="#ç­”æ¡ˆ" class="headerlink" title="ç­”æ¡ˆ"></a>ç­”æ¡ˆ</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$myRank = $rank + <span class="number">1</span>;</span><br><span class="line">$total = Db::table(<span class="string">'rank'</span>)-&gt;count();</span><br><span class="line"><span class="comment">// å¦‚æœæ’åæ˜¯åœ¨å‰ä¸‰å</span></span><br><span class="line"><span class="keyword">if</span> ($myRank &lt;= <span class="number">3</span>) &#123;</span><br><span class="line">    select * from rank where <span class="number">1</span> order by age desc,created_at desc limit <span class="number">5</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (($total - $myRank) &lt;= <span class="number">2</span>) &#123; <span class="comment">// å€’æ•°ä¸¤å</span></span><br><span class="line">    $unRank = $total - $myRank + <span class="number">1</span>;</span><br><span class="line">    $offset = $myRank - <span class="number">6</span> + $unRank;</span><br><span class="line">    select * from rank where <span class="number">1</span> order by age desc,created_at desc limit $offset,<span class="number">5</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $offset = $myRank - <span class="number">3</span>;</span><br><span class="line">    select * from rank where <span class="number">1</span> order by age desc,created_at desc limit $offset,<span class="number">5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php+rediså®ç°å®æ—¶æ’è¡Œæ¦œ</title>
      <link href="/php-redis%E5%AE%9E%E7%8E%B0%E5%AE%9E%E6%97%B6%E6%8E%92%E8%A1%8C%E6%A6%9C/"/>
      <url>/php-redis%E5%AE%9E%E7%8E%B0%E5%AE%9E%E6%97%B6%E6%8E%92%E8%A1%8C%E6%A6%9C/</url>
      
        <content type="html"><![CDATA[<h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><p>&emsp;è¯´èµ·æ’è¡Œæ¦œå¤§å®¶è‚¯å®šä¸é™Œç”Ÿï¼Œåœ¨é¡¹ç›®å¼€å‘ä¸­æ’è¡Œæ¦œçš„è¿ç”¨éå¸¸çš„å¤šã€‚å¦‚ç‹è€…å†œè¯çš„å¤©æ¢¯æ’è¡Œæ¦œã€å•†åŸçš„é”€é‡æ’è¡Œæ¦œã€çƒ­å–æ¦œã€ç”¨æˆ·ç§¯åˆ†æ’è¡Œæ¦œç­‰ç­‰ã€‚ä¸ç®¡ä»–æ˜¯ä»€ä¹ˆç±»å‹çš„æ’è¡Œæ¦œï¼Œå…¶ä¸šåŠ¡é€»è¾‘ã€å®ç°æ–¹æ³•å‡ ä¹æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚<br>&emsp;å¦‚è¿™æ ·çš„ä¸€ä¸ªæ‰‹æœºå’Œç¬”è®°æœ¬çš„é”€é‡æ’è¡Œæ¦œæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ<br><a id="more"></a></p><h4 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><img src="/php-rediså®ç°å®æ—¶æ’è¡Œæ¦œ/img/1.png"><h4 id="æ¦œå•å®ç°"><a href="#æ¦œå•å®ç°" class="headerlink" title="æ¦œå•å®ç°"></a>æ¦œå•å®ç°</h4><p>&emsp;å‡è®¾åšä¸€ä¸ªå¦‚ä¸Šå›¾ä¸€æ ·çš„æ’è¡Œæ¦œï¼Œè§„å®šæ¦œå•å¿…é¡»æ˜¯å®æ—¶æ›´æ–°çš„ï¼Œä½ ä¼šä½¿ç”¨ä»€ä¹ˆæŠ€æœ¯æ¥å®ç°å‘¢ï¼Ÿ</p><h5 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h5><p>&emsp;åœ¨æ•°æ®åº“æ–°å»ºä¸€å¼ æ•°æ®è¡¨ï¼Œé€šè¿‡ä¸‹å•äº‹ä»¶é’©å­æ¥æ›´æ–°è¿™å¼ è¡¨çš„æ•°æ®ï¼Œè®°å½•é”€é‡æƒ…å†µã€‚<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span>,image <span class="keyword">from</span> goods <span class="keyword">left</span> <span class="keyword">join</span> goods_top <span class="keyword">on</span> goods.id=goods_top.goods_id <span class="keyword">where</span> sales &gt; <span class="number">0</span> <span class="keyword">order</span> <span class="keyword">by</span> sales <span class="keyword">desc</span> <span class="keyword">limit</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure></p><p>&emsp;æœ€å¸¸è§ã€æœ€ç®€å•çš„å†™æ³•è«è¿‡äºæ­¤ï¼Œä½†è¿™ä¸ªå†™æ³•æœ‰ä¸€ä¸ªéå¸¸ä¸¥é‡çš„é—®é¢˜ã€‚å‡è®¾<code>goods</code>ä¸­æ•°æ®è§„æ¨¡æå¤§ï¼Œè®°å½•è¡¨<code>goods_top</code>è¡¨ä¸­æ•°æ®è§„æ¨¡ä¹Ÿä¸å°ï¼Œåœ¨æ¯æ¬¡æŸ¥è¯¢çš„æ€§èƒ½æ¶ˆè€—æ— ç–‘æ˜¯å¾ˆå¤§çš„ï¼Œåœ¨æç«¯çš„æƒ…å†µä¸‹ç”šè‡³å¯èƒ½ä¼šå‡ºç°è¯·æ±‚è¶…æ—¶çš„æƒ…å†µã€‚</p><p>&emsp;è¿™ä¸ªæ–¹æ¡ˆåœ¨å®é™…çš„é¡¹ç›®è¿ç”¨ä¸­ä¹Ÿå¾ˆå°‘å‡ºç°ï¼Œé™¤éä½ èƒ½ç¡®å®šæ•°æ®è¡¨è§„æ¨¡ä¸€å®šä¼šéå¸¸çš„å°ï¼Œæˆ–è€…ä½ æ ¹æœ¬ä¸è€ƒè™‘ä»€ä¹ˆæ€§èƒ½çš„æƒ…å†µä¸‹æ‰ä¼šä½¿ç”¨ã€‚</p><h5 id="æ–¹æ¡ˆäºŒ"><a href="#æ–¹æ¡ˆäºŒ" class="headerlink" title="æ–¹æ¡ˆäºŒ"></a>æ–¹æ¡ˆäºŒ</h5><p>&emsp;ä½¿ç”¨<code>redis</code>çš„<code>æœ‰åºé›†åˆ(zset)</code>æ¥å®ç°å®æ—¶æ’è¡Œæ¦œã€‚<em style="font-size:12px;">å…³äºredisæœ‰åºé›†åˆçš„ç›¸å…³ä»‹ç»ã€åŸç†ä»€ä¹ˆçš„å¤§å®¶è‡ªè¡Œç™¾åº¦</em></p><p>&emsp;(1)<code>Redis</code> æœ‰åºé›†åˆå’Œé›†åˆä¸€æ ·ä¹Ÿæ˜¯<code>string</code>ç±»å‹å…ƒç´ çš„é›†åˆ,ä¸”ä¸å…è®¸é‡å¤çš„æˆå‘˜ã€‚<br>&emsp;(2)ä¸åŒçš„æ˜¯æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ªdoubleç±»å‹çš„åˆ†æ•°ã€‚redisæ­£æ˜¯é€šè¿‡åˆ†æ•°æ¥ä¸ºé›†åˆä¸­çš„æˆå‘˜è¿›è¡Œä»å°åˆ°å¤§çš„æ’åºã€‚<br>&emsp;(3)æœ‰åºé›†åˆçš„æˆå‘˜æ˜¯å”¯ä¸€çš„,ä½†åˆ†æ•°(score)å´å¯ä»¥é‡å¤ã€‚<br>&emsp;(4)é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯O(1)ã€‚ é›†åˆä¸­æœ€å¤§çš„æˆå‘˜æ•°ä¸º 232 - 1 (4294967295, æ¯ä¸ªé›†åˆå¯å­˜å‚¨40å¤šäº¿ä¸ªæˆå‘˜)ã€‚</p><p>&emsp;ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹å•äº‹ä»¶é’©å­åˆ›å»ºä¸€ä¸ª<code>zseté›†åˆ</code>ï¼Œæˆ‘ä»¬é€šè¿‡<code>value</code>æ¥åŒºåˆ†æ˜¯å“ªä¸ªå•†å“ï¼Œé€šè¿‡<code>score</code>æ¥æ’åã€‚</p><img src="/php-rediså®ç°å®æ—¶æ’è¡Œæ¦œ/img/2.png"><h5 id="å…·ä½“ä»£ç "><a href="#å…·ä½“ä»£ç " class="headerlink" title="å…·ä½“ä»£ç "></a>å…·ä½“ä»£ç </h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Redis</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•†å“é”€é‡æ’è¡Œæ¦œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rank</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// key</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">key</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $activeActivityId = Main::info();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"goods_top"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¢åŠ é”€é‡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">($id, $number)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Redis::zIncrBy(<span class="keyword">self</span>::key(), $number, $id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–é”€é‡</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Redis::zScore(<span class="keyword">self</span>::key(), $id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æˆå‘˜æ’å-æ­£åº</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getRank</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Redis::zrevrank(<span class="keyword">self</span>::key(), $id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡æ’åè·å–æˆå‘˜</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getRevRange</span><span class="params">($start, $stop)</span>: <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Redis::zRevRange(<span class="keyword">self</span>::key(), $start, $stop);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨"></a>å¦‚ä½•ä½¿ç”¨</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Rank::add(<span class="number">1008</span>,<span class="number">10</span>); <span class="comment">// å•†å“IDä¸º1008çš„é”€é‡å¢åŠ 10</span></span><br><span class="line">Rank::get(<span class="number">1008</span>); <span class="comment">// è·å–å•†å“IDä¸º1008çš„é”€é‡</span></span><br><span class="line">Rank::getRank(<span class="number">1008</span>); <span class="comment">// è·å–å•†å“IDä¸º1008çš„æ’å</span></span><br><span class="line">Rank::getRevRange(<span class="number">0</span>,<span class="number">9</span>); <span class="comment">// è·å–æ’åå‰åçš„å•†å“ID,è¿”å›æ•°ç»„</span></span><br></pre></td></tr></table></figure><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>&emsp;å®ç°æ’è¡Œæ¦œçš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œå¤§å®¶æ ¹æ®å…·ä½“éœ€æ±‚å’Œç°æœ‰æŠ€æœ¯æ¥ç¡®å®šå®ç°æ–¹æ¡ˆã€‚ä¸è¦è¿‡åˆ†çš„è¿½æ±‚æ€§èƒ½æˆ–è€…æ˜¯å¼€å‘é€Ÿåº¦ï¼Œæ¬²é€Ÿåˆ™ä¸è¾¾ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php7.4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ</title>
      <link href="/php7-4%E9%A2%84%E5%8A%A0%E8%BD%BD%E4%B8%8Eswoole%E5%B8%B8%E9%A9%BB%E5%86%85%E5%AD%98%E6%9C%89%E4%BD%95%E5%8C%BA%E5%88%AB%EF%BC%9F/"/>
      <url>/php7-4%E9%A2%84%E5%8A%A0%E8%BD%BD%E4%B8%8Eswoole%E5%B8%B8%E9%A9%BB%E5%86%85%E5%AD%98%E6%9C%89%E4%BD%95%E5%8C%BA%E5%88%AB%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h4 id="é‡å¤§æ–°é—»"><a href="#é‡å¤§æ–°é—»" class="headerlink" title="é‡å¤§æ–°é—»"></a>é‡å¤§æ–°é—»</h4><img src="/php7-4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ/img/1.png"><p>php7.4åœ¨2019/11/28æ—¥å‘å¸ƒï¼<br><a id="more"></a><br>å…¶ä¸­RFC: Preloadingï¼ˆé¢„åŠ è½½ï¼‰æœ€å¼•äººç©ç›®ã€‚è¿™ä¸€æ–°ç‰¹æ€§çš„è¯ç”Ÿæ ‡å¿—ç€phpä½œä¸ºè§£é‡Šå‹è¯­è¨€åœ¨æ€§èƒ½ç“¶é¢ˆä¸Šå†æ¬¡çªç ´ã€‚</p><p>æ ¹æ®å„å¤§ç½‘å‹çš„æµ‹è¯•ç»Ÿè®¡ï¼Œphp7.4ä¸php7.0ç›¸æ¯”æå‡å°†è¿‘10%ã€‚</p><h4 id="ç‰¹æ€§ä»‹ç»"><a href="#ç‰¹æ€§ä»‹ç»" class="headerlink" title="ç‰¹æ€§ä»‹ç»"></a>ç‰¹æ€§ä»‹ç»</h4><h5 id="phpç”Ÿå‘½å‘¨æœŸ"><a href="#phpç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="phpç”Ÿå‘½å‘¨æœŸ"></a>phpç”Ÿå‘½å‘¨æœŸ</h5><img src="/php7-4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ/img/3.png"><p>æ¯æ¬¡è¯·æ±‚phpéƒ½ä¼šä»0åˆ°1é‡å¤ä¸Šå›¾æ‰€ç¤ºçš„æ“ä½œï¼Œæ¯æ¬¡å¸¦æ¥çš„å†…å­˜ã€IOæ–¹é¢çš„æ¶ˆè€—æ— ç–‘æ˜¯å¾ˆå¤§çš„ã€‚</p><h5 id="é¢„åŠ è½½"><a href="#é¢„åŠ è½½" class="headerlink" title="é¢„åŠ è½½"></a>é¢„åŠ è½½</h5><img src="/php7-4é¢„åŠ è½½ä¸swooleå¸¸é©»å†…å­˜æœ‰ä½•åŒºåˆ«ï¼Ÿ/img/2.png" title="ç½‘å›¾"><p>åœ¨é¢„åŠ è½½çš„ç‰¹æ€§ä¸‹ï¼Œphpä¼šå½“é¢„åŠ è½½å®Œæˆåçš„è¯·æ±‚ç›´æ¥ä¼šå‘½ä¸­ç¼“å­˜ï¼Œçœä¸‹äº†ç¼–è¯‘ã€è¯­æ³•è§£æã€è¯­æ³•åˆ†æã€ç±»åº“å¼•å…¥ç­‰ç­‰æ“ä½œã€‚</p><p>è¿™é‡Œä½ ä¼šå‘ç°æ€ä¹ˆå’Œswooleçš„å¸¸é©»å†…å­˜æœ‰ç‚¹åƒï¼Ÿ</p><p>ä¸è¿‡è¯´å®è¯ï¼Œåœ¨æ²¡æœ‰çœŸæ­£ä½¿ç”¨çš„æƒ…å†µä¸‹è¿˜çœŸæ²¡æ³•åˆ¤æ–­ä¸¤è€…çš„åŒºåˆ«ã€‚</p><p>å…³äºæ›´è¯¦ç»†çš„é¢„åŠ è½½ä½¿ç”¨å¤§å®¶å¯ä»¥çœ‹è¿™é‡Œï¼š<a href="https://blog.csdn.net/qmhball/article/details/103503939" target="_blank" rel="noopener">php7.4 preload(é¢„åŠ è½½)</a></p><p>æ¬¢è¿å¤§å®¶æ¥è®¨è®ºæœ‰å…³äºé¢„åŠ è½½å’Œå¸¸é©»å†…å­˜çš„åŒºåˆ«åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php+element+aliyunOsså®ç°å•å›¾webç›´ä¼ </title>
      <link href="/php-element-aliyunOss%E5%AE%9E%E7%8E%B0%E5%8D%95%E5%9B%BEweb%E7%9B%B4%E4%BC%A0/"/>
      <url>/php-element-aliyunOss%E5%AE%9E%E7%8E%B0%E5%8D%95%E5%9B%BEweb%E7%9B%B4%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<h4 id="ä¸šåŠ¡é€»è¾‘"><a href="#ä¸šåŠ¡é€»è¾‘" class="headerlink" title="ä¸šåŠ¡é€»è¾‘"></a>ä¸šåŠ¡é€»è¾‘</h4><h5 id="åŸæœ‰ä¸šåŠ¡"><a href="#åŸæœ‰ä¸šåŠ¡" class="headerlink" title="åŸæœ‰ä¸šåŠ¡"></a>åŸæœ‰ä¸šåŠ¡</h5><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/1.png"><a id="more"></a><p>å’Œæ•°æ®ç›´ä¼ åˆ° OSS ç›¸æ¯”ï¼Œä»¥ä¸Šæ–¹æ³•æœ‰ä¸‰ä¸ªç¼ºç‚¹ï¼š</p><ul><li>ä¸Šä¼ æ…¢ï¼šç”¨æˆ·æ•°æ®éœ€å…ˆä¸Šä¼ åˆ°åº”ç”¨æœåŠ¡å™¨ï¼Œä¹‹åå†ä¸Šä¼ åˆ°OSSã€‚ç½‘ç»œä¼ è¾“æ—¶é—´æ¯”ç›´ä¼ åˆ°OSSå¤šä¸€å€ã€‚å¦‚æœç”¨æˆ·æ•°æ®ä¸é€šè¿‡åº”ç”¨æœåŠ¡å™¨ä¸­è½¬ï¼Œè€Œæ˜¯ç›´ä¼ åˆ°OSSï¼Œé€Ÿåº¦å°†å¤§å¤§æå‡ã€‚è€Œä¸”OSSé‡‡ç”¨BGPå¸¦å®½ï¼Œèƒ½ä¿è¯å„åœ°å„è¿è¥å•†ä¹‹é—´çš„ä¼ è¾“é€Ÿåº¦ã€‚</li><li>æ‰©å±•æ€§å·®ï¼šå¦‚æœåç»­ç”¨æˆ·å¤šäº†ï¼Œåº”ç”¨æœåŠ¡å™¨ä¼šæˆä¸ºç“¶é¢ˆã€‚</li><li>è´¹ç”¨é«˜ï¼šéœ€è¦å‡†å¤‡å¤šå°åº”ç”¨æœåŠ¡å™¨ã€‚ç”±äºOSSä¸Šä¼ æµé‡æ˜¯å…è´¹çš„ï¼Œå¦‚æœæ•°æ®ç›´ä¼ åˆ°OSSï¼Œä¸é€šè¿‡åº”ç”¨æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°†èƒ½çœä¸‹å‡ å°åº”ç”¨æœåŠ¡å™¨ã€‚</li></ul><h5 id="ä»£æ›¿ä¸šåŠ¡"><a href="#ä»£æ›¿ä¸šåŠ¡" class="headerlink" title="ä»£æ›¿ä¸šåŠ¡"></a>ä»£æ›¿ä¸šåŠ¡</h5><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/2.png"><p>ä½¿ç”¨Oss webç›´ä¼ ï¼Œèƒ½æœ‰æ•ˆçš„è§£å†³ä¸Šä¼ é€Ÿåº¦è¿‡æ…¢çš„é—®é¢˜ã€‚</p><h4 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h4><h5 id="phpåç«¯ç­¾åä»£ç "><a href="#phpåç«¯ç­¾åä»£ç " class="headerlink" title="phpåç«¯ç­¾åä»£ç "></a>phpåç«¯ç­¾åä»£ç </h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é˜¿é‡ŒOssä¸Šä¼ éªŒç­¾ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OssPolicy</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="function"><span class="keyword">function</span> <span class="title">gmtIso8601</span><span class="params">($time)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $dtStr = date(<span class="string">"c"</span>, $time);</span><br><span class="line">        $mydatetime = <span class="keyword">new</span> DateTime($dtStr);</span><br><span class="line">        $expiration = $mydatetime-&gt;format(DateTime::ISO8601);</span><br><span class="line">        $pos = strpos($expiration, <span class="string">'+'</span>);</span><br><span class="line">        $expiration = substr($expiration, <span class="number">0</span>, $pos);</span><br><span class="line">        <span class="keyword">return</span> $expiration . <span class="string">"Z"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç­¾å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">policy</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $id = Config(<span class="string">'aliyun.webOss.accessKeyId'</span>); <span class="comment">// oss accessKeyId</span></span><br><span class="line">        $key = Config(<span class="string">'aliyun.webOss.accessKeySecret'</span>); <span class="comment">// oss accessKeySecret</span></span><br><span class="line">        $host = Config(<span class="string">'aliyun.webOss.host'</span>); <span class="comment">// oss ä¸Šä¼ åœ°å€</span></span><br><span class="line">        $callbackUrl = Config(<span class="string">'aliyun.webOss.callbackUrl'</span>);<span class="comment">// å›è°ƒåœ°å€ è¿™ä¸ªå¯ä»¥å¿½ç•¥</span></span><br><span class="line">        $dir =  Config(<span class="string">'aliyun.webOss.dir'</span>); <span class="comment">// å­˜æ”¾çš„æ–‡ä»¶å¤¹</span></span><br><span class="line"></span><br><span class="line">        $callback_param = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'callbackUrl'</span> =&gt; $callbackUrl,</span><br><span class="line">            <span class="string">'callbackBody'</span> =&gt; <span class="string">'filename=$&#123;object&#125;&amp;size=$&#123;size&#125;&amp;mimeType=$&#123;mimeType&#125;&amp;height=$&#123;imageInfo.height&#125;&amp;width=$&#123;imageInfo.width&#125;'</span>,</span><br><span class="line">            <span class="string">'callbackBodyType'</span> =&gt; <span class="string">"application/x-www-form-urlencoded"</span></span><br><span class="line">        );</span><br><span class="line">        $callback_string = json_encode($callback_param);</span><br><span class="line">        $base64_callback_body = base64_encode($callback_string);</span><br><span class="line">        $now = time();</span><br><span class="line">        $expire = <span class="number">30</span>;</span><br><span class="line">        $end = $now + $expire;</span><br><span class="line">        $expiration = <span class="keyword">$this</span>-&gt;gmtIso8601($end);</span><br><span class="line"></span><br><span class="line">        $condition = <span class="keyword">array</span>(<span class="number">0</span> =&gt; <span class="string">'content-length-range'</span>, <span class="number">1</span> =&gt; <span class="number">0</span>, <span class="number">2</span> =&gt; <span class="number">1048576000</span>);</span><br><span class="line">        $conditions[] = $condition;</span><br><span class="line"></span><br><span class="line">        $start = <span class="keyword">array</span>(<span class="number">0</span> =&gt; <span class="string">'starts-with'</span>, <span class="number">1</span> =&gt; <span class="string">'$key'</span>, <span class="number">2</span> =&gt; $dir);</span><br><span class="line">        $conditions[] = $start;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        $arr = <span class="keyword">array</span>(<span class="string">'expiration'</span> =&gt; $expiration, <span class="string">'conditions'</span> =&gt; $conditions);</span><br><span class="line">        $policy = json_encode($arr);</span><br><span class="line">        $base64_policy = base64_encode($policy);</span><br><span class="line">        $string_to_sign = $base64_policy;</span><br><span class="line">        $signature = base64_encode(hash_hmac(<span class="string">'sha1'</span>, $string_to_sign, $key, <span class="keyword">true</span>));</span><br><span class="line"></span><br><span class="line">        $response = <span class="keyword">array</span>();</span><br><span class="line">        $response[<span class="string">'accessid'</span>] = $id;</span><br><span class="line">        $response[<span class="string">'host'</span>] = $host;</span><br><span class="line">        $response[<span class="string">'policy'</span>] = $base64_policy;</span><br><span class="line">        $response[<span class="string">'signature'</span>] = $signature;</span><br><span class="line">        $response[<span class="string">'expire'</span>] = $end;</span><br><span class="line">        $response[<span class="string">'callback'</span>] = $base64_callback_body;</span><br><span class="line">        $response[<span class="string">'dir'</span>] = $dir;</span><br><span class="line">        <span class="keyword">return</span> $response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="å°è£…ç»„ä»¶-ossSingleUpload-vue"><a href="#å°è£…ç»„ä»¶-ossSingleUpload-vue" class="headerlink" title="å°è£…ç»„ä»¶ ossSingleUpload.vue"></a>å°è£…ç»„ä»¶ ossSingleUpload.vue</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-upload</span><br><span class="line">      list-type=<span class="string">"picture-card"</span></span><br><span class="line">      <span class="class"><span class="keyword">class</span></span>=<span class="string">"avatar-uploader"</span></span><br><span class="line">      action=<span class="string">"http://daichongwbe.oss-cn-beijing.aliyuncs.com"</span> <span class="comment">// ä¸Šä¼ åœ°å€</span></span><br><span class="line">      :data=<span class="string">"dataObj"</span></span><br><span class="line">      accept=<span class="string">".jpeg, .png, .jpg"</span> <span class="comment">// å…è®¸ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line">      :multiple=<span class="string">"false"</span> <span class="comment">// ç¦æ­¢å¤šå›¾ä¸Šä¼ </span></span><br><span class="line">      :before-upload=<span class="string">"beforeUpload"</span> <span class="comment">// ä¸Šä¼ å‰å›è°ƒ</span></span><br><span class="line">      :on-success=<span class="string">"handleUploadSuccess"</span> <span class="comment">// ä¸Šä¼ æˆåŠŸåå›è°ƒ</span></span><br><span class="line">      :limit=<span class="string">"limit"</span> <span class="comment">// é™åˆ¶ä¸Šä¼ æ•°é‡</span></span><br><span class="line">      :show-file-list=<span class="string">"false"</span> <span class="comment">// ç¦æ­¢åˆ—è¡¨å±•ç¤º</span></span><br><span class="line">      ref=<span class="string">"upload"</span></span><br><span class="line">    &gt;</span><br><span class="line">      &lt;img v-<span class="keyword">if</span>=<span class="string">"imageUrl"</span> :src=<span class="string">"imageUrl"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"avatar"</span> /&gt;</span><br><span class="line">      &lt;i v-<span class="keyword">else</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"el-icon-plus avatar-uploader-icon"</span>&gt;&lt;<span class="regexp">/i&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>el-upload&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; getPolicy &#125; <span class="keyword">from</span> <span class="string">"@/api/oss/token"</span>; <span class="comment">// åç«¯éªŒç­¾æ¥å£</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">"ossSingleUpload"</span>, <span class="comment">//ç»„ä»¶å‘½å</span></span><br><span class="line">  props: &#123;</span><br><span class="line">    limit: <span class="built_in">Number</span>, <span class="comment">// å‚æ•°</span></span><br><span class="line">    imgCover: <span class="built_in">String</span> <span class="comment">// å‚æ•°</span></span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      dataObj: &#123;</span><br><span class="line">        policy: <span class="string">""</span>,</span><br><span class="line">        signature: <span class="string">""</span>,</span><br><span class="line">        key: <span class="string">""</span>,</span><br><span class="line">        ossaccessKeyId: <span class="string">""</span>,</span><br><span class="line">        dir: <span class="string">""</span>,</span><br><span class="line">        host: <span class="string">""</span>,</span><br><span class="line">        callback: <span class="string">""</span></span><br><span class="line">      &#125;,</span><br><span class="line">      imageUrl: <span class="string">""</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.imageUrl = <span class="keyword">this</span>.imgCover;</span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    emitInput(val) &#123; <span class="comment">// ç»„ä»¶äº¤äº’</span></span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">"input"</span>, val);</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeUpload(file) &#123; <span class="comment">// ä¸Šä¼ å‰é’©å­</span></span><br><span class="line">      <span class="keyword">let</span> _self = <span class="keyword">this</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        getPolicy()</span><br><span class="line">          .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">            _self.dataObj.policy = response.data.policy;</span><br><span class="line">            _self.dataObj.signature = response.data.signature;</span><br><span class="line">            _self.dataObj.ossaccessKeyId = response.data.accessid;</span><br><span class="line">            _self.dataObj.key = response.data.dir + <span class="string">"$&#123;filename&#125;"</span>;</span><br><span class="line">            _self.dataObj.dir = response.data.dir;</span><br><span class="line">            _self.dataObj.host = response.data.host;</span><br><span class="line">            _self.dataObj.callback = response.data.callback;</span><br><span class="line">            resolve(<span class="literal">true</span>);</span><br><span class="line">          &#125;)</span><br><span class="line">          .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">            reject(<span class="literal">false</span>);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleUploadSuccess(res, file) &#123; <span class="comment">// ä¸Šä¼ æˆåŠŸå</span></span><br><span class="line">       <span class="comment">// æ¸…é™¤ä¸Šæ¬¡çš„ä¸Šä¼ è®°å½•ï¼Œè¿™é‡Œå¦‚æœä¸æ¸…é™¤ä¼šå¯¼è‡´ç¬¬äºŒæ¬¡ä¸Šä¼ æ— æ•ˆã€‚</span></span><br><span class="line">      <span class="keyword">this</span>.$refs.upload.clearFiles(); </span><br><span class="line">       <span class="comment">// ç»„è£…å›¾ç‰‡è·¯å¾„ï¼Œè¿™é‡Œæ ¹æ®ä¸šåŠ¡éœ€è¦æ¥ã€‚</span></span><br><span class="line">      <span class="keyword">this</span>.imageUrl = <span class="keyword">this</span>.dataObj.host + <span class="string">"/"</span> + <span class="keyword">this</span>.dataObj.dir + file.name; </span><br><span class="line">      <span class="comment">// ç»„ä»¶äº¤äº’ï¼ŒæŠŠå›¾ç‰‡è·¯å¾„å‘é€ç»™é¡µé¢</span></span><br><span class="line">      <span class="keyword">this</span>.$emit(<span class="string">"getMessage"</span>, <span class="keyword">this</span>.imageUrl); </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.avatar-uploader</span> <span class="selector-class">.el-upload</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#d9d9d9</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.avatar-uploader</span> <span class="selector-class">.el-upload</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#409eff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.avatar-uploader-icon</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">28px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#8c939d</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.avatar</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="é¡µé¢è°ƒç”¨"><a href="#é¡µé¢è°ƒç”¨" class="headerlink" title="é¡µé¢è°ƒç”¨"></a>é¡µé¢è°ƒç”¨</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"app-container"</span>&gt;</span><br><span class="line">    &lt;oss-single-upload @getMessage=<span class="string">"coverImg"</span> :imgCover=<span class="string">"imgCover"</span> :limit=<span class="string">"1"</span>&gt;&lt;<span class="regexp">/oss-single-upload&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">import ossSingleUpload from "@/</span>components/Upload/ossSingleUpload<span class="string">"; // å¼•å…¥ç»„ä»¶</span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">  components: &#123; ossSingleUpload &#125;,</span></span><br><span class="line"><span class="string">  data() &#123;</span></span><br><span class="line"><span class="string">    return &#123;</span></span><br><span class="line"><span class="string">      imgCover:"</span><span class="string">"</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  methods: &#123;</span></span><br><span class="line"><span class="string">    coverImg(imgUrl) &#123;</span></span><br><span class="line"><span class="string">      console.log(imgUrl); //å¾—åˆ°çš„ä¸Šä¼ å›¾ç‰‡è·¯å¾„</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h4 id="è¯·æ±‚ç»“æœ"><a href="#è¯·æ±‚ç»“æœ" class="headerlink" title="è¯·æ±‚ç»“æœ"></a>è¯·æ±‚ç»“æœ</h4><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/3.png"><p>åœ¨callbackurlä¸ºç©ºæˆ–è€…callbackurlæ–‡ä»¶å†…å®¹é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œè¿™é‡Œæ˜¯æ²¡æœ‰è¿”å›å€¼çš„ã€‚</p><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/4.png"><h4 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h4><img src="/php-element-aliyunOsså®ç°å•å›¾webç›´ä¼ /img/5.gif"><h4 id="githubä»“åº“"><a href="#githubä»“åº“" class="headerlink" title="githubä»“åº“"></a>githubä»“åº“</h4><p><a href="https://github.com/DaiChongyu/osswebupload" target="_blank" rel="noopener">ç‚¹å‡»æŸ¥çœ‹æºä»£ç </a></p>]]></content>
      
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Laravelæ¶ˆæ¯é˜Ÿåˆ—</title>
      <link href="/Laravel%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/"/>
      <url>/Laravel%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/</url>
      
        <content type="html"><![CDATA[<h4 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h4><img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/2.png"><a id="more"></a><h4 id="æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰"><a href="#æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰"></a>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰</h4><h5 id="ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—-MQ"><a href="#ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—-MQ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—(MQ)"></a>ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—(MQ)</h5><p>å…³äºæ¶ˆæ¯é˜Ÿåˆ—å¤§å®¶è‚¯å®šéƒ½ä¸é™Œç”Ÿï¼ŒåŸºæœ¬ä¸Šæ¯ä¸ªé¡¹ç›®ä¸­éƒ½ä¼šä½¿ç”¨åˆ°çš„æŠ€æœ¯ï¼Œåœ¨æˆ‘å‰å‡ æœŸçš„åšæ–‡ä¸­ä¹Ÿæœ‰ä»‹ç»ã€‚</p><p>&emsp;æ¶ˆæ¯é˜Ÿåˆ—æœ¬è´¨å°±æ˜¯é€»è¾‘æ‰§è¡Œé¡ºåºï¼Œé˜Ÿåˆ—å°±å¦‚åŒä¸€æ‘ç¢—å †æ”¾åœ¨ä¸€èµ·ï¼Œä½ æ¯æ”¾ä¸€ä¸ªç¢—éƒ½ä¼šæ”¾åœ¨è¿™èºç¢—çš„æœ€ä¸Šé¢ï¼Œå½“ä½ æ‹¿ç¢—çš„æ—¶å€™ä¹Ÿæ˜¯åªèƒ½ä»æœ€ä¸Šé¢æ‹¿ã€‚è¿™ä¸ªå¦‚åŒé˜Ÿåˆ—çš„æ¶ˆè´¹ç‰¹æ€§ï¼ˆé˜Ÿåˆ—çš„ç‰¹æ€§æ˜¯å…ˆè¿›å…ˆå‡ºï¼Œå…ˆè¿›åå‡ºï¼Œé“ç†æ˜¯ä¸€æ ·çš„ï¼‰ã€‚<br><img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/1.png"></p><h5 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ</h5><ul><li>æé«˜ç³»ç»Ÿæ€§èƒ½ï¼ˆå‰Šå³°ï¼Œå‡å°‘å“åº”æ—¶é—´ï¼‰ã€‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># å‡è®¾ä½ æœ‰ä¸€ä¸ªè¿™æ ·çš„æ¥å£</span><br><span class="line"># æ–°ç”¨æˆ·æ³¨å†Œå‘é€é‚®ä»¶éªŒè¯ç </span><br><span class="line">public function SendMailCode(Request $request)&#123;</span><br><span class="line">    $mail = $request-&gt;input(&apos;mail);</span><br><span class="line">    SendReminderEmail::dispatch($mail); // æŠŠé‚®ç®±åŠ å…¥é˜Ÿåˆ—</span><br><span class="line">    return &apos;éªŒè¯ç å‘é€æˆåŠŸï¼Œè¯·æ³¨æ„æŸ¥æ”¶ï¼&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>&emsp;å‡è®¾æ³¨å†Œæ¥å£çš„å¹¶å‘åœ¨1ç§’100ï¼Œåœ¨ä½¿ç”¨é˜Ÿåˆ—çš„æƒ…å†µä¸‹å‘é€é‚®ä»¶è¿™ä¸ªæ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ç¬¬100åç”¨æˆ·ç‚¹å‡»è·å–éªŒè¯ç åç«‹åˆ»å°±èƒ½è·å¾—å“åº”ï¼Œæ— éœ€ç­‰å¾…å‰99åæ‰€æœ‰é‚®ä»¶å‘é€æˆåŠŸåæ‰èƒ½å¾—åˆ°ç›¸åº”ï¼Œè¿™å°±æ˜¯ä¸é˜»å¡ã€‚<br>å½“<code>SendReminderEmail::dispatch($mail)</code>æ‰§è¡Œä¹‹åç«‹åˆ»å°±ä¼šæ‰§è¡Œ <code>return &#39;éªŒè¯ç å‘é€æˆåŠŸï¼Œè¯·æ³¨æ„æŸ¥æ”¶ï¼&#39;</code>ï¼Œæ§åˆ¶å™¨ä¸éœ€è¦çŸ¥é“é‚®ä»¶æ˜¯å¦å‘é€æˆåŠŸï¼Œå‡å°‘äº†é˜»å¡çš„ç­‰å¾…æ—¶é—´ã€‚</p><ul><li>é™ä½ç³»ç»Ÿçš„è€¦åˆæ€§ã€‚<br>ä¼ ç»Ÿå†™æ³•<img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/3.png">æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰å†™æ³•<img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/4.png"><h5 id="æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„ä¼˜ç¼ºç‚¹"><a href="#æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„ä¼˜ç¼ºç‚¹"></a>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„ä¼˜ç¼ºç‚¹</h5></li><li>ä¼˜ç‚¹ï¼šä¸Šè¾¹å·²ç»è®²è¿‡äº†ã€‚</li><li>ç¼ºç‚¹ï¼š<br>&emsp; (1)ç³»ç»Ÿå¯ç”¨æ€§é™ä½:å¯ä»¥çœ‹å‡ºå¼•å…¥äº†MQä¹‹åï¼Œå¦‚æœMQæŒ‚äº†ç›¸å½“äºæ•´ä¸ªæ—¥å¿—ç³»ç»Ÿä¹Ÿéšä¹‹å´©æºƒã€‚<br>&emsp; (2)ç³»ç»Ÿå¤æ‚æ€§æé«˜:å¼•å…¥MQå¢åŠ äº†ç»´æŠ¤ç³»ç»Ÿçš„å·¥ä½œé‡ï¼Œå‡ºç°é—®é¢˜çš„å¯èƒ½æ€§ä¼šæ›´é«˜ã€‚<br>&emsp; (3)ä¸€è‡´æ€§é—®é¢˜ã€‚</li></ul><h4 id="é˜Ÿåˆ—çš„åº”ç”¨"><a href="#é˜Ÿåˆ—çš„åº”ç”¨" class="headerlink" title="é˜Ÿåˆ—çš„åº”ç”¨"></a>é˜Ÿåˆ—çš„åº”ç”¨</h4><p>&emsp;Laravelä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—å°±éå¸¸ç®€å•äº†ï¼Œä»–å¯ä»¥è®¾ç½®é©±åŠ¨å’Œæ‰§è¡Œæ–¹å¼ã€‚</p><h5 id="å®‰è£…æ‰©å±•"><a href="#å®‰è£…æ‰©å±•" class="headerlink" title="å®‰è£…æ‰©å±•"></a>å®‰è£…æ‰©å±•</h5><ul><li>aws/aws-sdk-php ~3.0</li><li>pda/pheanstalk ~3.0</li><li>predis/predis ~1.0</li></ul><h5 id="ç”Ÿæˆä»»åŠ¡ç±»"><a href="#ç”Ÿæˆä»»åŠ¡ç±»" class="headerlink" title="ç”Ÿæˆä»»åŠ¡ç±»"></a>ç”Ÿæˆä»»åŠ¡ç±»</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan make:job SendReminderEmail</span><br></pre></td></tr></table></figure><h5 id="ä»»åŠ¡ç±»ç»“æ„"><a href="#ä»»åŠ¡ç±»ç»“æ„" class="headerlink" title="ä»»åŠ¡ç±»ç»“æ„"></a>ä»»åŠ¡ç±»ç»“æ„</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Jobs</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Bus</span>\<span class="title">Queueable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Contracts</span>\<span class="title">Queue</span>\<span class="title">ShouldQueue</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Bus</span>\<span class="title">Dispatchable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Queue</span>\<span class="title">InteractsWithQueue</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Queue</span>\<span class="title">SerializesModels</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendReminderEmail</span> <span class="keyword">implements</span> <span class="title">ShouldQueue</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">Dispatchable</span>, <span class="title">InteractsWithQueue</span>, <span class="title">Queueable</span>, <span class="title">SerializesModels</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $id; <span class="comment">// æ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a new job instance.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;id = $id; <span class="comment">// æ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Execute the job.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'jobsss'</span> . <span class="keyword">$this</span>-&gt;id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="åŠ å…¥é˜Ÿåˆ—"><a href="#åŠ å…¥é˜Ÿåˆ—" class="headerlink" title="åŠ å…¥é˜Ÿåˆ—"></a>åŠ å…¥é˜Ÿåˆ—</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">SendReminderEmail</span>;</span><br><span class="line">SendReminderEmail::dispatch($id); <span class="comment">// åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line">ehco <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h5 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h5><p>&emsp;ï¼ˆ1ï¼‰å½“æˆ‘æœªå¼€å¯æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è¯·æ±‚æ¥å£ï¼Œä¼šè¿”å›1ã€‚<br>&emsp;ï¼ˆ2ï¼‰å¼€å¯æ¶ˆæ¯é˜Ÿåˆ—<br><img src="/Laravelæ¶ˆæ¯é˜Ÿåˆ—/img/5.png"></p><h4 id="æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰æ‹©"><a href="#æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰æ‹©" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰æ‹©"></a>æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰æ‹©</h4><p>&emsp;ä¸€èˆ¬æƒ…å†µä¸‹å¤§éƒ¨åˆ†ä¸šåŠ¡éƒ½ä½¿ç”¨çš„æ˜¯redisçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚åŠ å…¥ä½ ä»¬å…¬å¸ä¸šåŠ¡é‡éå¸¸å¤§ï¼Œå‡ åƒä¸‡ç”šè‡³å‡ äº¿å°±å¿…é¡»è€ƒè™‘ä½¿ç”¨å…¶ä»–çš„MQå·¥å…·ã€‚å¦‚<code>ActiveMQ</code>ã€<code>RabbitMQ</code>ã€<code>RocketMQ</code>ã€<code>Kafka</code>ã€‚</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>&emsp;Laravelçš„æ¶ˆæ¯é˜Ÿåˆ—åº”ç”¨æ¯”è¾ƒç®€å•ä¸”éå¸¸çš„å¥½ç”¨ï¼Œå»ºè®®å¤§å®¶å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚å…·ä½“å¯ä»¥çœ‹<a href="https://learnku.com/docs/laravel/6.x/queues/5168" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡</title>
      <link href="/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF-mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E9%85%8D%E7%BD%AE%E7%AF%87/"/>
      <url>/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF-mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E9%85%8D%E7%BD%AE%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h4 id="å‰ç¯‡å›å¿†"><a href="#å‰ç¯‡å›å¿†" class="headerlink" title="å‰ç¯‡å›å¿†"></a>å‰ç¯‡å›å¿†</h4><p>ä¸Šä¸€ç¯‡ä»‹ç»äº†ä¸»ä»å¤åˆ¶çš„æ­å»ºçš„åŸºç¡€æµç¨‹ï¼Œä¸ºè¿™ç¯‡çš„é…ç½®åšäº†é“ºå«ã€‚ä¾¿äºç†è§£æ˜¯è¿™ç¯‡æœ€å¤§çš„äº®ç‚¹ï¼Œè¯´å®è¯ç»è¿‡äº²æ‰‹å°è¯•äº†ä¸»ä»å¤åˆ¶ä¹‹åï¼Œæ„Ÿè§‰è¿™ä¸ªä¸œè¥¿ç¡®å®ä¸éš¾ï¼Œå°±ç®€å•çš„æ”¹å‡ ä¸ªé…ç½®å°±å¯ä»¥æå®šï¼Œä½†æ˜¯ä½œä¸ºé«˜çº§ç¨‹åºä¼˜åŒ–çš„ä¸€éƒ¨åˆ†ï¼Œå­¦ä¹ è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚<br><a id="more"></a></p><h4 id="é…ç½®ä»‹ç»"><a href="#é…ç½®ä»‹ç»" class="headerlink" title="é…ç½®ä»‹ç»"></a>é…ç½®ä»‹ç»</h4><h5 id="ç¡®è®¤ç¯å¢ƒ"><a href="#ç¡®è®¤ç¯å¢ƒ" class="headerlink" title="ç¡®è®¤ç¯å¢ƒ"></a>ç¡®è®¤ç¯å¢ƒ</h5><p>1.æœåŠ¡å™¨1å·ï¼š192.168.22.130ï¼ˆä¸»åº“æœåŠ¡å™¨ï¼‰<br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/1.png"><br>2.æœåŠ¡å™¨2å·ï¼š192.168.22.128ï¼ˆä»åº“æœåŠ¡å™¨ï¼‰<br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/2.png"></p><h5 id="ä¸»åº“é…ç½®"><a href="#ä¸»åº“é…ç½®" class="headerlink" title="ä¸»åº“é…ç½®"></a>ä¸»åº“é…ç½®</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"><span class="meta">#</span><span class="bash"> é…ç½®ä¸»åº“æ ‡è¯†ï¼ˆè¿™é‡Œæ•°å­—éšæ„ï¼Œä½†æ˜¯ä¸€å®šè¦æ¯”ä»åº“é…ç½®çš„æ•°å­—å¤§ï¼Œå¿…é¡»æ˜¯æ•°å­—ï¼‰</span></span><br><span class="line">server_id=1</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¼€å¯æ—¥å¿—åŠŸèƒ½&amp;é…ç½®æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">log_bin=master_log</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿å­˜é€€å‡º&amp;é‡å¯mysqlæœåŠ¡</span></span><br><span class="line">systemctl restart mysqld</span><br></pre></td></tr></table></figure><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/3.png"><h5 id="é…ç½®ä»åº“è¿æ¥ç”¨æˆ·"><a href="#é…ç½®ä»åº“è¿æ¥ç”¨æˆ·" class="headerlink" title="é…ç½®ä»åº“è¿æ¥ç”¨æˆ·"></a>é…ç½®ä»åº“è¿æ¥ç”¨æˆ·</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç™»é™†mysql</span></span><br><span class="line">mysql -uroot -p</span><br><span class="line"><span class="comment"># è¿›å…¥mysqlåº“</span></span><br><span class="line">use mysql</span><br><span class="line"><span class="comment"># æ–°å¢ä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”ç»‘å®šè¿™ä¸ªç”¨æˆ·åªèƒ½ä»192.168.22.128è¿™ä¸ªIPè®¿é—®</span></span><br><span class="line">grant all privileges on *.* to <span class="string">'slave'</span>@<span class="string">'192.168.22.128'</span> identified by <span class="string">'slave123'</span> with grant option;</span><br><span class="line"><span class="comment"># åˆ·æ–°æƒé™</span></span><br><span class="line">flush privileges;</span><br><span class="line"><span class="comment"># è¿™é‡Œè¦æ³¨æ„ï¼ŒçœŸå®çš„æ­£å¼ç¯å¢ƒé…ç½®éœ€è¦è§„å®šä»åº“çš„è¿æ¥IPï¼Œä¸èƒ½è®¾ç½®ä¸º*ã€‚</span></span><br><span class="line"><span class="comment"># å¯†ç ä¸èƒ½è®¾ç½®è¿‡äºç®€å•ï¼Œæœ€å°‘æ˜¯å­—æ¯å’Œæ•°å­—ç»„åˆçš„6ä½ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸»åº“çŠ¶æ€<code>show master status</code><br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/4.png"><br>è¿™é‡Œçš„<code>File</code>å°±æ˜¯ä¸»åº“çš„<code>binlog</code>æ–‡ä»¶ã€‚</p><h5 id="ä»åº“é…ç½®"><a href="#ä»åº“é…ç½®" class="headerlink" title="ä»åº“é…ç½®"></a>ä»åº“é…ç½®</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"><span class="comment"># è¿™é‡Œåªéœ€è¦é…ç½®ä¸€ä¸ªæ ‡è¯†å°±è¡Œ(ä¸€å®šè¦æ¯”ä¸»åº“çš„æ ‡è¯†æ•°å­—å°)</span></span><br><span class="line">server_id=2</span><br><span class="line"><span class="comment"># é‡å¯mysqlæœåŠ¡</span></span><br><span class="line">systemctl restart mysqld</span><br><span class="line"><span class="comment"># å…³é—­slave</span></span><br><span class="line">stop slave</span><br><span class="line"><span class="comment"># ç»™ä»åº“é…ç½®ä¸»åº“å‚æ•°</span></span><br><span class="line">mysql&gt; change master to</span><br><span class="line">-&gt; master_host=<span class="string">"ipåœ°å€"</span>ï¼Œ</span><br><span class="line">-&gt; master_user=<span class="string">"æˆæƒæ—¶æŒ‡å®šçš„ç”¨æˆ·å"</span>ï¼Œ</span><br><span class="line">-&gt; master_password=<span class="string">"ç”¨æˆ·å¯†ç "</span>ï¼Œ</span><br><span class="line">-&gt; master_log_file=<span class="string">"binlogæ—¥å¿—"</span>ï¼Œ</span><br><span class="line">-&gt; master_log_pos=åç§»é‡ï¼›</span><br><span class="line"><span class="comment"># é‡å¯ä»åº“æœåŠ¡</span></span><br><span class="line">start slave</span><br><span class="line"><span class="comment"># æµ‹è¯•æ˜¯å¦æ­£å¸¸è¿æ¥</span></span><br><span class="line">show slave status \G;</span><br><span class="line"><span class="comment"># å¦‚æœæŠ¥é”™error connecting to master 'repluse@192.168.22.130:3306' - retry-time: 60 retries:1</span></span><br><span class="line"><span class="comment"># è¯·æ£€æŸ¥å¯†ç æ˜¯ä¸æ˜¯é…ç½®é”™äº†</span></span><br></pre></td></tr></table></figure><h5 id="æœ€åæµ‹è¯•åŒæ­¥"><a href="#æœ€åæµ‹è¯•åŒæ­¥" class="headerlink" title="æœ€åæµ‹è¯•åŒæ­¥"></a>æœ€åæµ‹è¯•åŒæ­¥</h5><p>å†ä¸»åº“åˆ›å»ºä¸€ä¸ªæ•°æ®è¡¨ï¼Œç„¶ååˆ·æ–°ä»åº“çœ‹çœ‹æ˜¯å¦åŒæ­¥æˆåŠŸã€‚<br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶é…ç½®ç¯‡/img/5.gif"></p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>æ€»ä½“æµç¨‹ä¸‹æ¥å¾ˆç®€å•ã€æµç¨‹ä¹Ÿä¸å¤æ‚ã€å‡ºç°å¥‡æ€ªé—®é¢˜çš„å‡ ç‡å°ã€‚<br>å¦‚æœåœ¨é…ç½®ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯åœ¨è¯„è®ºåŒºæé—®ï¼Œæˆ‘ä¼šç¬¬ä¸€æ—¶é—´å›å¤ã€‚<br><strong>é¢„å‘Šï¼šä¸‹ä¸€ç¯‡æ˜¯è¯»å†™åˆ†ç¦»çš„é…ç½®</strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡</title>
      <link href="/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF-mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%9F%BA%E7%A1%80%E6%90%AD%E5%BB%BA%E7%AF%87/"/>
      <url>/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF-mysql%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%9F%BA%E7%A1%80%E6%90%AD%E5%BB%BA%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h4 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h4><p>æœ¬æ–‡ä»‹ç»çš„æ˜¯åœ¨è™šæ‹Ÿæœºä¸Šæ­å»ºï¼Œå®é™…æƒ…å†µå…¶å®å’ŒçœŸæ­£çš„çº¿ä¸Šç¯å¢ƒä¸€æ¯›ä¸€æ ·ï¼Œä½¿ç”¨çš„ç³»ç»Ÿæ˜¯Centos 7ã€‚</p><h4 id="ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>ç­”ï¼šç®€å•ç‚¹ç†è§£ï¼Œä¸»ä»å¤åˆ¶å…¶å®å°±æ˜¯ä¸¤ä¸ªæ•°æ®åº“æ•°æ®çš„é¡¹ç›®å¤‡ä»½è¿‡ç¨‹ã€‚å…¶åŸç†å°±æ˜¯ä¸»åº“äº§ç”Ÿçš„æ“ä½œéƒ½ä¼šç”Ÿæˆ<code>binlog</code>ä¼ å…¥ä»åº“ï¼Œä»åº“é€šè¿‡<code>I/O</code>çº¿ç¨‹æŠŠ<code>binlog</code>å†™å…¥<code>relaylog</code>ï¼Œç„¶åä»åº“åˆ›å»º<code>I/O</code>çº¿ç¨‹æ‰§è¡Œ<code>relaylog</code>è¿›è¡Œæ•°æ®å¤‡ä»½ã€‚<br><a id="more"></a></p><h4 id="æµç¨‹å›¾"><a href="#æµç¨‹å›¾" class="headerlink" title="æµç¨‹å›¾"></a>æµç¨‹å›¾</h4><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/1.png"><h4 id="ä¸ºä»€ä¹ˆè¦åšä¸»ä»å¤åˆ¶ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦åšä¸»ä»å¤åˆ¶ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åšä¸»ä»å¤åˆ¶ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦åšä¸»ä»å¤åˆ¶ï¼Ÿ</h4><p>ç­”ï¼šä¸€æ–¹é¢æ˜¯ä¸ºäº†å¤‡ä»½æ•°æ®ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±å’Œç ´åï¼Œå¦ä¸€æ–¹é¢æ˜¯ä¸ºè¯»å†™åˆ†ç¦»åšé“ºå«ã€‚</p><h4 id="æ­å»ºæ­¥éª¤"><a href="#æ­å»ºæ­¥éª¤" class="headerlink" title="æ­å»ºæ­¥éª¤"></a>æ­å»ºæ­¥éª¤</h4><h5 id="æ–°å»ºè™šæ‹Ÿæœº"><a href="#æ–°å»ºè™šæ‹Ÿæœº" class="headerlink" title="æ–°å»ºè™šæ‹Ÿæœº"></a>æ–°å»ºè™šæ‹Ÿæœº</h5><p>é¦–å…ˆåœ¨æœ¬åœ°å®‰è£…è™šæ‹Ÿæœºï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒæ¨è <code>VMware Workstation Pro</code>ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨å…¶ä»–çš„ã€‚<br>è™šæ‹Ÿæœºçš„å®‰è£…å°±ä¸åšä»‹ç»äº†ï¼Œæ— ééƒ½æ˜¯ä¸‹ä¸€æ­¥ä¸‹ä¸€æ­¥ã€‚å®‰è£…å¥½ä¹‹ååœ¨éœ€è¦ä¸‹è½½å¯¹ç”¨çš„ç³»ç»Ÿé•œåƒï¼Œå› ä¸ºæœ¬æ–‡ä¸»è¦æ˜¯åœ¨<code>Centos</code>ä¸Šåšæ¼”ç¤ºï¼Œæ‰€ä»¥æˆ‘å°±ä¸‹è½½äº†<code>Centos</code>çš„é•œåƒï¼Œä½†æ˜¯æ— æ³•åˆ†äº«ç»™å¤§å®¶ï¼Œå› ä¸ºå¤ªå¤§äº†ï¼Œè¶³è¶³<code>4G</code>ã€‚</p><p>å®‰è£…å¥½ä¹‹åæ–°å»ºä¸¤ä¸ªè™šæ‹Ÿæœº(æ€ä¹ˆæ–°å»ºè™šæ‹Ÿæœºå°±ä¸åšä»‹ç»äº†):<br><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/2.png"></p><h5 id="å®‰è£…mysql"><a href="#å®‰è£…mysql" class="headerlink" title="å®‰è£…mysql"></a>å®‰è£…mysql</h5><p>æ³¨æ„ï¼šå°½é‡ä¸¤ä¸ªè™šæ‹Ÿæœºä¸Šçš„mysqlç‰ˆæœ¬ä¿æŒä¸€ç›´ï¼Œé¿å…å‡ºç°ä¸å¯é¢„çŸ¥çš„é”™è¯¯ã€‚<br>æˆ‘å®‰è£…çš„ç‰ˆæœ¬æ˜¯5.7.<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥</span></span><br><span class="line">cd /usr/local/src</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸‹è½½rpmåŒ…</span></span><br><span class="line">wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…rpm</span></span><br><span class="line">rpm -ivh mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£… mysql-server</span></span><br><span class="line">yum install -y mysql-server</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨ </span></span><br><span class="line">systemctl start mysqld</span><br><span class="line"><span class="meta">#</span><span class="bash"> è®¾ç½®å¼€æœºè‡ªå¯</span></span><br><span class="line">systemctl enable mysqld</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç™»é™†mysql</span></span><br><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure></p><p>å› ä¸º5.7ä¹‹åçš„ç‰ˆæœ¬éƒ½æ˜¯ç¦æ­¢åŒ¿åç™»é™†çš„ï¼Œä½ å¯ä»¥é€šè¿‡æŸ¥çœ‹å¯†ç å¹¶ç™»é™†ï¼Œç„¶åä¿®æ”¹å¯†ç ï¼Œæˆ–è€…ç›´æ¥ä¿®æ”¹<code>my.cnf</code>æ¥ç¦æ­¢ç™»é™†éªŒè¯ã€‚<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/mysqld.log|grep 'A temporary password'</span><br></pre></td></tr></table></figure></p><p>å› ä¸ºç³»ç»Ÿç»™æˆ‘çš„é»˜è®¤å¯†ç å«æœ‰ä¸€äº›ç‰¹æ®Šç¬¦å·ï¼Œæˆ‘æ²¡æ³•è¾“å…¥ï¼Œæˆ‘åªèƒ½ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vi \etc\my.cnf</span><br><span class="line"><span class="meta">#</span><span class="bash"> åœ¨æœ€åå¢åŠ ä¸€è¡Œ</span></span><br><span class="line">skip-grant-tables=1</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç™»é™†mysqlï¼Œåˆ·æ–°æƒé™</span></span><br><span class="line">flush privileges;</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ”¹å¯†ç </span></span><br><span class="line">use mysql;</span><br><span class="line">update user set password='password' where user='root'ï¼›</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ”¹æˆåŠŸåå†æ¬¡åˆ·æ–°æƒé™</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æœ€åé‡å¯ä¸€ä¸‹mysqlæœåŠ¡</span></span><br></pre></td></tr></table></figure></p><h5 id="æœ¬åœ°è¿æ¥è™šæ‹Ÿæœºä¸Šçš„mysql"><a href="#æœ¬åœ°è¿æ¥è™šæ‹Ÿæœºä¸Šçš„mysql" class="headerlink" title="æœ¬åœ°è¿æ¥è™šæ‹Ÿæœºä¸Šçš„mysql"></a>æœ¬åœ°è¿æ¥è™šæ‹Ÿæœºä¸Šçš„mysql</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹IP</span></span><br><span class="line">ifconfig</span><br><span class="line"><span class="meta">#</span><span class="bash"> åœ¨æœ¬åœ°Cmdä¸­pingè¿™ä¸ªIP</span></span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨telnetæµ‹è¯•mysqlè¿æ¥çŠ¶æ€"><a href="#ä½¿ç”¨telnetæµ‹è¯•mysqlè¿æ¥çŠ¶æ€" class="headerlink" title="ä½¿ç”¨telnetæµ‹è¯•mysqlè¿æ¥çŠ¶æ€"></a>ä½¿ç”¨telnetæµ‹è¯•mysqlè¿æ¥çŠ¶æ€</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.168.22.130 3360</span><br></pre></td></tr></table></figure><h5 id="é”™è¯¯çš„æƒ…å†µï¼ˆå› æˆ‘è¿™é‡Œæ˜¯å¥½çš„ï¼Œæ‰€ä»¥æˆ‘æŠŠ3306å¡«æˆäº†3360ï¼‰"><a href="#é”™è¯¯çš„æƒ…å†µï¼ˆå› æˆ‘è¿™é‡Œæ˜¯å¥½çš„ï¼Œæ‰€ä»¥æˆ‘æŠŠ3306å¡«æˆäº†3360ï¼‰" class="headerlink" title="é”™è¯¯çš„æƒ…å†µï¼ˆå› æˆ‘è¿™é‡Œæ˜¯å¥½çš„ï¼Œæ‰€ä»¥æˆ‘æŠŠ3306å¡«æˆäº†3360ï¼‰"></a>é”™è¯¯çš„æƒ…å†µï¼ˆå› æˆ‘è¿™é‡Œæ˜¯å¥½çš„ï¼Œæ‰€ä»¥æˆ‘æŠŠ3306å¡«æˆäº†3360ï¼‰</h5><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/3.png"><h5 id="æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦å®‰è£…äº†iptables"><a href="#æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦å®‰è£…äº†iptables" class="headerlink" title="æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦å®‰è£…äº†iptables"></a>æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦å®‰è£…äº†iptables</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å…³é—­é˜²ç«å¢™</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¦æ­¢é˜²ç«å¢™</span></span><br><span class="line">systemctl mask firewalld</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¦æ­¢å¼€æœºå¯åŠ¨</span></span><br><span class="line">systemctl disable firewalld</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœå®åœ¨ä¸è¡Œï¼Œè¿˜è¦æŠŠselinuxå…³é—­</span></span><br><span class="line">vi /etc/selinux/config</span><br><span class="line">SELINUX=disabled</span><br></pre></td></tr></table></figure><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/4.png"><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/5.png"><p>å†æ¬¡ä½¿ç”¨<code>telnet 192.168.22.130 3306</code>è¿˜æ˜¯æŠ¥é”™ä¸Šè¾¹å›¾ç‰‡æ‰€ç¤ºæ—¶ã€‚</p><h5 id="é…ç½®æƒé™"><a href="#é…ç½®æƒé™" class="headerlink" title="é…ç½®æƒé™"></a>é…ç½®æƒé™</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºä¸€ä¸ªç”¨æˆ·</span></span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO 'daichong'@'%' IDENTIFIED BY 'daichong' WITH GRANT OPTION;</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ·æ–°æƒé™</span></span><br><span class="line">FLUSH PRIVILEGES;</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿™é‡Œæ³¨æ„çœŸå®çº¿ä¸Šæƒ…å†µæƒé™ä¸èƒ½è¿™ä¹ˆå¼€</span></span><br></pre></td></tr></table></figure><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/6.png"><p>å‡ºç°è¿™ä¸ªè¯´æ˜å·²ç»æˆåŠŸäº†</p><h5 id="ä½¿ç”¨navicatè¿æ¥"><a href="#ä½¿ç”¨navicatè¿æ¥" class="headerlink" title="ä½¿ç”¨navicatè¿æ¥"></a>ä½¿ç”¨navicatè¿æ¥</h5><img src="/æ¶æ„ä¹‹è·¯-mysqlä¸»ä»å¤åˆ¶åŸºç¡€æ­å»ºç¯‡/img/7.png"><p>åˆ°è¿™é‡ŒåŸºç¡€çš„å®‰è£…å·²ç»å®Œæˆäº†ï¼Œå¦‚æœé‡åˆ°é—®é¢˜å¯åœ¨è¯„è®ºä¸­æé—®ï¼Œä¸‹ä¸€ç¯‡ä»‹ç»ä¸»ä»å¤åˆ¶å¦‚ä½•é…ç½®ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>laravelæ¨¡å‹å…³è”æŸ¥è¯¢ä¸JOINå“ªä¸ªæ€§èƒ½å¥½</title>
      <link href="/laravel%E6%A8%A1%E5%9E%8B%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E4%B8%8EJOIN%E5%93%AA%E4%B8%AA%E6%80%A7%E8%83%BD%E5%A5%BD/"/>
      <url>/laravel%E6%A8%A1%E5%9E%8B%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E4%B8%8EJOIN%E5%93%AA%E4%B8%AA%E6%80%A7%E8%83%BD%E5%A5%BD/</url>
      
        <content type="html"><![CDATA[<p><strong>åˆå­¦Laravel</strong></p><p>æœ€è¿‘æ¥æ‰‹ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæ•´ä¸ªé¡¹ç›®å®Œå…¨çœ‹ä¸åˆ°<code>left join</code>è¿™æ ·çš„å†™æ³•ï¼Œæˆ‘æ‰“å°äº†æ¨¡å‹å…³è”æŸ¥è¯¢åçš„<code>sql</code>åå‘ç°è·Ÿå¸¸æœ‰çš„æŸ¥è¯¢å†™æ³•å®Œå…¨ä¸åŒã€‚<br>åŸè°…æˆ‘ä¸€ç›´æ˜¯ä¸ªç å†œï¼Œå‡ ä¹æ²¡è§è¿‡è¿™æ ·çš„å†™æ³•ï¼Œä¸€ç›´æƒ³å¯¹æ¯”ä¸€ä¸‹è¿™æ ·çš„å†™æ³•å’Œå¸¸ç”¨çš„å†™æ³•æ€§èƒ½æ–¹é¢åˆ°åº•æœ‰ä»€ä¹ˆå·®åˆ«ã€‚<br><a id="more"></a><br><strong>ä¸€ä¸ªå°æ —å­</strong></p><p>æ¨¡å‹å…³è”ç”Ÿæˆçš„sql<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`comment`</span> <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`post_comment`</span> <span class="keyword">where</span> <span class="string">`comment`</span>.<span class="string">`id`</span> = <span class="string">`post_comment`</span>.<span class="string">`comment_id`</span> <span class="keyword">and</span> <span class="string">`post_id`</span> = ?)</span><br></pre></td></tr></table></figure></p><p>å¸¸ç”¨æŸ¥è¯¢<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="string">`comment`</span>.id,<span class="string">`comment`</span>.info,<span class="string">`comment`</span>.user_id <span class="keyword">from</span> <span class="string">`comment`</span> <span class="keyword">left</span> <span class="keyword">join</span> post_comment <span class="keyword">on</span> <span class="string">`comment`</span>.id = <span class="string">`post_comment`</span>.comment_id <span class="keyword">where</span> post_comment.post_id = ?</span><br></pre></td></tr></table></figure></p><p>å•ä»<code>sql</code>ä¸Šçœ‹åŒºåˆ«è¿˜æ˜¯æŒºå¤§çš„ï¼Œå†åšç å†œçš„æœŸé—´ï¼Œæœ€å¸¸å¬åˆ°çš„å°±æ˜¯é“¾è¡¨æŸ¥è¯¢æ€§èƒ½ä¸å¥½ã€‚ä½†æ˜¯è¿˜çœŸä¸èƒ½ç¡®å®šè¿™ä¸¤ä¸ª<code>sql</code>åˆ°åº•å“ªä¸ªæ€§èƒ½å¥½ä¸€ç‚¹ï¼Œæ²¡åŠæ³•åªèƒ½æµ‹è¯•ä¸€ä¸‹ã€‚</p><h3 id="posts-Tables"><a href="#posts-Tables" class="headerlink" title="posts Tables"></a>posts Tables</h3><table><thead><tr><th style="text-align:left">id</th><th style="text-align:center">title</th><th style="text-align:right">time</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:center">æ¨¡å‹å…³è”æŸ¥è¯¢</td><td style="text-align:right">2019-11-08</td></tr><tr><td style="text-align:left">2</td><td style="text-align:center">left join æŸ¥è¯¢</td><td style="text-align:right">2019-11-08</td></tr></tbody></table><h3 id="comment-Tables"><a href="#comment-Tables" class="headerlink" title="comment Tables"></a>comment Tables</h3><table><thead><tr><th style="text-align:left">id</th><th style="text-align:center">info</th><th style="text-align:right">time</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:center">æ¨¡å‹å…³è”æŸ¥è¯¢çš„æ€§èƒ½å¥½</td><td style="text-align:right">2019-11-08</td></tr><tr><td style="text-align:left">2</td><td style="text-align:center">left join æŸ¥è¯¢çš„æ€§èƒ½å¥½</td><td style="text-align:right">2019-11-08</td></tr><tr><td style="text-align:left">3</td><td style="text-align:center">ä¸¤ä¸ªéƒ½æŒºå¥½</td><td style="text-align:right">2019-11-08</td></tr></tbody></table><h3 id="post-comment-Tables"><a href="#post-comment-Tables" class="headerlink" title="post_comment Tables"></a>post_comment Tables</h3><table><thead><tr><th style="text-align:left">id</th><th style="text-align:center">post_id</th><th style="text-align:right">comment_id</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:center">1</td><td style="text-align:right">1</td></tr><tr><td style="text-align:left">2</td><td style="text-align:center">2</td><td style="text-align:right">2</td></tr><tr><td style="text-align:left">3</td><td style="text-align:center">3</td><td style="text-align:right">2</td></tr></tbody></table><p>ä¸ºäº†é¿å…äº‰è®®ï¼Œæˆ‘æ·»åŠ äº†ä¸€äº›æ¯”è¾ƒåˆç†çš„æ•°æ®ã€‚</p><h4 id="æ•°æ®é‡"><a href="#æ•°æ®é‡" class="headerlink" title="æ•°æ®é‡"></a>æ•°æ®é‡</h4><table><thead><tr><th style="text-align:left">posts</th><th style="text-align:center">comment</th><th style="text-align:right">post_comment</th></tr></thead><tbody><tr><td style="text-align:left">29999æ¡</td><td style="text-align:center">29999æ¡</td><td style="text-align:right">29999æ¡</td></tr></tbody></table><h4 id="ä¸‹é¢ä½¿ç”¨EXPLAINè¿›è¡Œåˆ†æ"><a href="#ä¸‹é¢ä½¿ç”¨EXPLAINè¿›è¡Œåˆ†æ" class="headerlink" title="ä¸‹é¢ä½¿ç”¨EXPLAINè¿›è¡Œåˆ†æ"></a>ä¸‹é¢ä½¿ç”¨EXPLAINè¿›è¡Œåˆ†æ</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`comment`</span> <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">`post_comment`</span> <span class="keyword">where</span> <span class="string">`comment`</span>.<span class="string">`id`</span> = <span class="string">`post_comment`</span>.<span class="string">`comment_id`</span> <span class="keyword">and</span> <span class="string">`post_id`</span> = <span class="number">2</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">select_type</th><th style="text-align:right">table</th><th style="text-align:right">partitions</th><th style="text-align:right">type</th></tr></thead><tbody><tr><td style="text-align:center">PRIMARY</td><td style="text-align:right">comment</td><td style="text-align:right">NULL</td><td style="text-align:right">ALL</td></tr><tr><td style="text-align:center">DEPENDENT SUBQUERY</td><td style="text-align:right">post_comment</td><td style="text-align:right">NULL</td><td style="text-align:right">ref</td></tr></tbody></table><table><thead><tr><th style="text-align:right">possible_keys</th><th style="text-align:right">key</th><th style="text-align:right">key_len</th><th style="text-align:right">ref</th></tr></thead><tbody><tr><td style="text-align:right">NULL</td><td style="text-align:right">NULL</td><td style="text-align:right">NULL</td><td style="text-align:right">NULL</td></tr><tr><td style="text-align:right">post_id,comment_id</td><td style="text-align:right">post_id</td><td style="text-align:right">5</td><td style="text-align:right">const</td></tr></tbody></table><table><thead><tr><th style="text-align:right">rows</th><th style="text-align:right">filtered</th><th style="text-align:right">Extra</th></tr></thead><tbody><tr><td style="text-align:right">29999</td><td style="text-align:right">100.00</td><td style="text-align:right">Using where</td></tr><tr><td style="text-align:right">1</td><td style="text-align:right">10.00</td><td style="text-align:right">Using where</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> <span class="string">`comment`</span>.id,<span class="string">`comment`</span>.info,<span class="string">`comment`</span>.user_id <span class="keyword">from</span> <span class="string">`comment`</span> <span class="keyword">left</span> <span class="keyword">join</span> post_comment <span class="keyword">on</span> <span class="string">`comment`</span>.id = <span class="string">`post_comment`</span>.comment_id <span class="keyword">where</span> post_comment.post_id = <span class="number">2</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">select_type</th><th style="text-align:center">table</th><th style="text-align:right">partitions</th></tr></thead><tbody><tr><td style="text-align:left">SIMPLE</td><td style="text-align:center">post_comment</td><td style="text-align:right">NULL</td></tr><tr><td style="text-align:left">SIMPLE</td><td style="text-align:center">comment</td><td style="text-align:right">NULL</td></tr></tbody></table><table><thead><tr><th style="text-align:right">type</th><th style="text-align:right">possible_keys</th><th style="text-align:right">key</th><th style="text-align:right">key_len</th></tr></thead><tbody><tr><td style="text-align:right">ref</td><td style="text-align:right">post_id,comment_id</td><td style="text-align:right">post_id</td><td style="text-align:right">5</td></tr><tr><td style="text-align:right">eq_ref</td><td style="text-align:right">PRIMARY</td><td style="text-align:right">PRIMARY</td><td style="text-align:right">4</td></tr></tbody></table><table><thead><tr><th style="text-align:right">ref</th><th style="text-align:right">rows</th><th style="text-align:right">filtered</th><th style="text-align:right">Extra</th></tr></thead><tbody><tr><td style="text-align:right">const</td><td style="text-align:right">1</td><td style="text-align:right">100.00</td><td style="text-align:right">Using where</td></tr><tr><td style="text-align:right">test.post_comment.comment_id</td><td style="text-align:right">1</td><td style="text-align:right">100.00</td><td style="text-align:right">NULL</td></tr></tbody></table><p>ä»ä¸Šè¾¹çš„<code>EXPLAIN</code>ç»“æœæ¥çœ‹ï¼Œ<code>left join</code>æ¯”æ¨¡å‹å…³è”çš„å†™æ³•æ•ˆç‡é«˜å¤ªå¤šäº†ï¼Œä¹‹åæˆ‘åœ¨<code>laravel</code>ç¤¾åŒºä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æé—®ï¼Œå¾—åˆ°çš„ç»“è®ºæ˜¯<code>æ•°æ®é‡å¤§çš„æ—¶å€™ç”¨JOINï¼Œæ•°æ®é‡å°çš„æ—¶å€™ç”¨æ¨¡å‹</code>ã€‚</p><p>ä»å¾—çš„çš„ç»“è®ºæ¥çœ‹ï¼Œæ¨¡å‹å¹¶é€‚åˆå¤§æ•°æ®æŸ¥è¯¢ï¼Œä½†æ˜¯å¯¹ä¸€äº›æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤æ“ä½œæä¾›äº†å¾ˆå¥½çš„æ•ˆæœï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>laravelæ¨¡å‹å…³è”</title>
      <link href="/laravel%E6%A8%A1%E5%9E%8B%E5%85%B3%E8%81%94/"/>
      <url>/laravel%E6%A8%A1%E5%9E%8B%E5%85%B3%E8%81%94/</url>
      
        <content type="html"><![CDATA[<p><b>ä¸€å¯¹ä¸€</b></p><p>&emsp;ä»€ä¹ˆæ˜¯ä¸€å¯¹å¤šï¼Ÿ</p><p>&emsp;åœ¨ç¨‹åºè§’åº¦è®²ï¼šä¸€å¯¹å¤šåŸºæœ¬ä¸Šéƒ½æ˜¯ç”¨æ¥æè¿°ä¸¤ä¸ªæ•°æ®è¡¨ä¹‹é—´çš„å…³ç³»ã€‚</p><p>&emsp;å‡è®¾ç°æœ‰ä¸¤ä¸ªæ•°æ®è¡¨ï¼šï¼ˆ1ï¼‰æ–‡ç« è¡¨posts ï¼ˆ2ï¼‰è¯„è®ºè¡¨commentã€‚ä¸€ä¸ªæ–‡ç« å¯ä»¥æœ‰å¤šä¸ªè¯„è®ºï¼Œä½†ä¸€ä¸ªè¯„è®ºåªèƒ½å±äºä¸€ä¸ªæ–‡ç« ï¼Œç›¸å¯¹äºè¯„è®ºæ¥è¯´å®ƒä¸æ–‡ç« çš„å…³ç³»æ˜¯å¤šå¯¹ä¸€ï¼Œç›¸å¯¹ä¸æ–‡ç« æ¥è¯´å®ƒä¸è¯„è®ºçš„å…³ç³»æ˜¯ä¸€å¯¹å¤šï¼Œè¿™ä¹Ÿå°±æ˜¯laravelé‡Œåå‘å…³è”çš„åŸºç¡€ã€‚</p><p><em>æ–‡ç« è¡¨posts</em></p><table><th>id</th><th>title</th><th>time</th><tr><td>1</td><td>ä»€ä¹ˆæ˜¯ä¸€å¯¹ä¸€ï¼Ÿ</td><td>2019-11-07</td></tr><tr><td>2</td><td>ä»€ä¹ˆæ˜¯ä¸€å¯¹å¤šï¼Ÿ</td><td>2019-11-08</td></tr><tr><td>3</td><td>ä»€ä¹ˆæ˜¯å¤šå¯¹å¤šï¼Ÿ</td><td>2019-11-06</td></tr></table><br><a id="more"></a><br><br><em>è¯„è®ºè¡¨comment</em><br><br><table><th>id</th><th>info</th><th>user_id</th><tr><td>1</td><td>æˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯ä¸€å¯¹ä¸€ã€‚</td><td>10086</td></tr><tr><td>2</td><td>æˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯ä¸€å¯¹å¤šã€‚</td><td>10085</td></tr><tr><td>3</td><td>æˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯å¤šå¯¹å¤šã€‚</td><td>10084</td></tr><td>4</td><td>è¿™è°ä¸çŸ¥é“å•Šï¼</td><td>10084</td></table><p><em>ä¸­é—´è¡¨posts_commentï¼ˆä¹Ÿå¯ä»¥å«åšå…³ç³»è¡¨ï¼‰</em></p><table><th>id</th><th>post_id</th><th>comment_id</th><tr><td>1</td><td>1</td><td>1</td></tr><tr><td>2</td><td>2</td><td>2</td></tr><tr><td>3</td><td>3</td><td>3</td></tr><tr><td>4</td><td>3</td><td>4</td></tr></table><p>&emsp;ä»è¡¨çš„ç»“æ„å¯ä»¥çœ‹å‡ºæ¥ï¼ŒID=1ã€2çš„æ–‡ç« åªæœ‰ä¸€æ¡è¯„è®ºï¼ŒID=3çš„æ–‡ç« æœ‰ä¸¤æ¡è¯„è®ºã€‚</p><p>&emsp;é‚£ä¹ˆè¿™æ˜¯è¦æœ‰ä¸ªä¸šåŠ¡ï¼Œå·²çŸ¥æ–‡ç« çš„ID=3ï¼Œè¯·ä½¿ç”¨laravelçš„æ¨¡å‹å…³è”æ‰¾å‡ºè¯¥æ–‡ç« ä¸‹çš„æ‰€æœ‰è¯„è®ºã€‚</p><p>&emsp;é¦–å…ˆç¡®è®¤ä¸¤ä¸ªè¡¨ä¹‹é—´çš„å…³ç³»ï¼Œä¸€ä¸ªè¯„è®ºåœ¨ä¸­é—´è¡¨åªæœ‰ä¸€æ¡æ•°æ®ï¼Œä¸­é—´è¡¨é‡Œçš„comment_idè‚¯å®šæ˜¯å”¯ä¸€çš„ï¼Œä¸å¯èƒ½å‡ºç°ä¸€ä¸ªè¯„è®ºåŒæ—¶å±äºä¸¤ä¸ªæ–‡ç« ï¼Œæ‰€ä»¥å®ƒä»¬ä¹‹é—´çš„å…³ç³»æ˜¯<em>ä¸€å¯¹ä¸€</em>ã€‚<a>ä½†æ˜¯ï¼Œä½ ä¼šå‘ç°ä½¿ç”¨hasMany(å¤šå¯¹å¤š)å…³è”æ–¹æ³•è·å–çš„æ•°æ®å±…ç„¶æ˜¯ä¸€æ ·çš„</a>ã€‚</p><figure class="highlight plain"><figcaption><span>æ¨¡å‹å…³è”</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># ä¸€å¯¹å¤šå†™æ³•</span><br><span class="line">public function comments()</span><br><span class="line">&#123;</span><br><span class="line">    return $this-&gt;hasMany(&apos;App\Models\PostComment&apos;, &apos;comment_id&apos;, &apos;id&apos;);</span><br><span class="line">&#125;</span><br><span class="line"># ä¸€å¯¹ä¸€å†™æ³•</span><br><span class="line">public function comment()</span><br><span class="line">&#123;</span><br><span class="line">    return $this-&gt;hasOne(&apos;App\Models\PostComment&apos;, &apos;comment_id&apos;, &apos;id&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æŸ¥è¯¢å†™æ³•ä½¿ç”¨ï¼ˆwithï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public function list()</span><br><span class="line">&#123;</span><br><span class="line">    $postId = 3;</span><br><span class="line">    $data = \App\Models\Comment::with(&apos;comments&apos;)-&gt;whereHas(&quot;comments&quot;, function ($query) use ($postId) &#123;</span><br><span class="line">        return $query-&gt;where(&quot;post_id&quot;, $postId);</span><br><span class="line">    &#125;)-&gt;get();</span><br><span class="line">    dump($data-&gt;toArray());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>è·å–çš„æ•°æ®ç»“æœï¼ˆä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"># with(&apos;comments);</span><br><span class="line">array:2 [â–¼</span><br><span class="line">  0 =&gt; array:4 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 3</span><br><span class="line">    &quot;info&quot; =&gt; &quot;\tæˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯å¤šå¯¹å¤š&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">    &quot;comments&quot; =&gt; array:1 [â–¼</span><br><span class="line">      0 =&gt; array:3 [â–¼</span><br><span class="line">        &quot;id&quot; =&gt; 3</span><br><span class="line">        &quot;post_id&quot; =&gt; 3</span><br><span class="line">        &quot;comment_id&quot; =&gt; 3</span><br><span class="line">      ]</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">  1 =&gt; array:4 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 4</span><br><span class="line">    &quot;info&quot; =&gt; &quot;è¿™è°ä¸çŸ¥é“å•Šï¼&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">    &quot;comments&quot; =&gt; array:1 [â–¼</span><br><span class="line">      0 =&gt; array:3 [â–¼</span><br><span class="line">        &quot;id&quot; =&gt; 4</span><br><span class="line">        &quot;post_id&quot; =&gt; 3</span><br><span class="line">        &quot;comment_id&quot; =&gt; 4</span><br><span class="line">      ]</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># with(&apos;comment);</span><br><span class="line">array:2 [â–¼</span><br><span class="line">  0 =&gt; array:4 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 3</span><br><span class="line">    &quot;info&quot; =&gt; &quot;\tæˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯å¤šå¯¹å¤š&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">    &quot;comment&quot; =&gt; array:3 [â–¼</span><br><span class="line">      &quot;id&quot; =&gt; 3</span><br><span class="line">      &quot;post_id&quot; =&gt; 3</span><br><span class="line">      &quot;comment_id&quot; =&gt; 3</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">  1 =&gt; array:4 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 4</span><br><span class="line">    &quot;info&quot; =&gt; &quot;è¿™è°ä¸çŸ¥é“å•Šï¼&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">    &quot;comment&quot; =&gt; array:3 [â–¼</span><br><span class="line">      &quot;id&quot; =&gt; 4</span><br><span class="line">      &quot;post_id&quot; =&gt; 3</span><br><span class="line">      &quot;comment_id&quot; =&gt; 4</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æ‰§è¡Œçš„SQLï¼ˆä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># ä¸¤æ¬¡sqlæ˜¯ä¸€æ ·çš„</span><br><span class="line">array:2 [â–¼</span><br><span class="line">  0 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;query&quot; =&gt; &quot;select * from `comment` where exists (select * from `post_comment` where `comment`.`id` = `post_comment`.`comment_id` and `post_id` = ?)&quot;</span><br><span class="line">    &quot;bindings&quot; =&gt; array:1 [â–¶]</span><br><span class="line">    &quot;time&quot; =&gt; 12.67</span><br><span class="line">  ]</span><br><span class="line">  1 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;query&quot; =&gt; &quot;select * from `post_comment` where `post_comment`.`comment_id` in (3, 4)&quot;</span><br><span class="line">    &quot;bindings&quot; =&gt; []</span><br><span class="line">    &quot;time&quot; =&gt; 0.21</span><br><span class="line">  ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>&emsp;æˆ‘ä»¬åˆ†æä¸€ä¸‹laravelåº•å±‚çš„å¤„ç†é€»è¾‘ï¼Œä»ä¸Šè¾¹çš„sqlå¯ä»¥çœ‹å‡ºä½¿ç”¨æ¨¡å‹å…³è”ç¬¬ä¸€æ­¥ä¼šä½¿ç”¨ä¸€ä¸ªåµŒå¥—æŸ¥è¯¢æ‰¾å‡ºcommentåœ¨post_commenté‡Œå­˜åœ¨çš„ç»“æœé›†ï¼Œæœ€ç»ˆçš„å¾—åˆ°çš„ç»“æœæ˜¯3ã€4ã€‚éšåä¼šåšä¸€ä¸ªINæŸ¥è¯¢å¾—åˆ°æœ€ç»ˆcomment.id=3ã€4çš„æ•°æ®æœ€ååˆå¹¶æˆç»“æœé›†è¿”å›ã€‚</p><figure class="highlight plain"><figcaption><span>æŸ¥è¯¢å†™æ³•ä½¿ç”¨ï¼ˆä¸ä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public function list()</span><br><span class="line">&#123;</span><br><span class="line">    $postId = 3;</span><br><span class="line"></span><br><span class="line">    $data = \App\Models\Comment::whereHas(&quot;comment&quot;, function ($query) use ($postId) &#123;</span><br><span class="line">        return $query-&gt;where(&quot;post_id&quot;, $postId);</span><br><span class="line">    &#125;)-&gt;get();</span><br><span class="line">    dump($data-&gt;toArray());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æ‰§è¡Œçš„SQLï¼ˆä¸ä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># ä¸¤æ¬¡æ‰§è¡Œsqlä¹Ÿæ˜¯ä¸€æ ·çš„</span><br><span class="line">array:1 [â–¼</span><br><span class="line">  0 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;query&quot; =&gt; &quot;select * from `comment` where exists (select * from `post_comment` where `comment`.`id` = `post_comment`.`comment_id` and `post_id` = ?)&quot;</span><br><span class="line">    &quot;bindings&quot; =&gt; array:1 [â–¶]</span><br><span class="line">    &quot;time&quot; =&gt; 2.82</span><br><span class="line">  ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æŸ¥è¯¢çš„ç»“æœï¼ˆä¸ä½¿ç”¨withï¼‰</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># å¾—åˆ°çš„ç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„</span><br><span class="line">array:2 [â–¼</span><br><span class="line">  0 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 3</span><br><span class="line">    &quot;info&quot; =&gt; &quot;\tæˆ‘çŸ¥é“ä»€ä¹ˆæ˜¯å¤šå¯¹å¤š&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">  ]</span><br><span class="line">  1 =&gt; array:3 [â–¼</span><br><span class="line">    &quot;id&quot; =&gt; 4</span><br><span class="line">    &quot;info&quot; =&gt; &quot;è¿™è°ä¸çŸ¥é“å•Šï¼&quot;</span><br><span class="line">    &quot;user_id&quot; =&gt; 10084</span><br><span class="line">  ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>&emsp;ä¸¤ç§å†™æ³•çš„ç«¯å¼‚æƒ³å¿…å¤§å®¶éƒ½èƒ½çœ‹å¾—å‡ºæ¥ï¼Œå°±ä¸å†ä»‹ç»äº†ã€‚</p><p><b>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¨¡å‹å…³è”å‘¢ï¼Ÿ</b></p><p>&emsp;å‡è®¾æŸä¸€ä¸ªæ–‡ç« è¢«è¯„è®ºäº†ï¼Œåœ¨ä¸ä½¿ç”¨æ¨¡å‹å…³è”çš„æƒ…å†µä¸‹éœ€è¦è¿™æ ·å†™ï¼š</p><figure class="highlight plain"><figcaption><span>æ™®é€šå†™æ³•</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$mode = new \App\Models\Comment();</span><br><span class="line">$mode-&gt;info = &apos;æµ‹è¯•&apos;;</span><br><span class="line">$mode-&gt;user_id = 11;</span><br><span class="line">$mode-&gt;save();</span><br><span class="line"></span><br><span class="line">\App\Models\PostComment::create([</span><br><span class="line">  &apos;post_id&apos; =&gt; 3,</span><br><span class="line">  &apos;comment_id&apos; =&gt; $mode-&gt;id</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>æ¨¡å‹å…³è”å†™æ³•</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$mode = new \App\Models\Comment();</span><br><span class="line">$mode-&gt;info = &apos;æµ‹è¯•&apos;;</span><br><span class="line">$mode-&gt;user_id = 11;</span><br><span class="line">$mode-&gt;save();</span><br><span class="line"></span><br><span class="line">$mode-&gt;comment()-&gt;create([</span><br><span class="line">    &apos;post_id&apos; =&gt; 3,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure><p>&emsp;è€Œä¸”æˆ‘çš„å…¬å¸æœ‰è§„å®šä¸èƒ½ä½¿ç”¨left joinå†™æ³•ï¼Œè€Œä¸”æ¨¡å‹ä¸­ä¸å…è®¸å†™æœ‰å…³ä¸šåŠ¡çš„ä»£ç ï¼Œè¿™æ ·å¤§å¤§é™åˆ¶äº†éšå¿ƒæ‰€æ¬²å¼€å‘ï¼Œé™ä½äº†é¡¹ç›®çš„ç»´æŠ¤æˆæœ¬ã€‚å¹¶ä¸”åœ¨ä½¿ç”¨æ¨¡å‹å…³è”åï¼Œä¸€åˆ‡çš„ä»£ç å˜å¾—ç®€å•äº†ï¼Œå¯è¯»æ€§æé«˜ï¼Œå€’æ˜¯æ€§èƒ½è¿™å—æˆ‘æ²¡æœ‰çœŸæ­£çš„æµ‹è¯•è¿‡ï¼Œä¹‹åè‚¯å®šä¼šç ”ç©¶ä¸€ä¸‹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue+elementå®æˆ˜ï¼ˆå…¥é—¨ç¯‡ ä¸€ï¼‰</title>
      <link href="/vue-element%E5%AE%9E%E6%88%98%EF%BC%88%E5%85%A5%E9%97%A8%E7%AF%87%EF%BC%89/"/>
      <url>/vue-element%E5%AE%9E%E6%88%98%EF%BC%88%E5%85%A5%E9%97%A8%E7%AF%87%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p><b>æˆ‘ä¸ºä»€ä¹ˆä¼šå­¦vueï¼Ÿ</b></p><p>&emsp;å­¦Vueä¹‹å‰ä¸€ç›´è§‰å¾—å®ƒå¥½éš¾ï¼Œé¦–å…ˆæºä»£ç çœ‹ä¸æ‡‚ï¼Œå¯¹äºæˆ‘ä¸€ä¸ªä¸»è¦æ˜¯åšPHPåç«¯æ¥è¯´ï¼Œçœ‹è§é‚£äº›importè¿˜æœ‰å“ªäº›èŠ±é‡Œèƒ¡å“¨çš„è¯­æ³•ï¼ŒçœŸçš„æ˜¯å¤ªéš¾çœ‹æ‡‚äº†ã€‚<br><img src="/vue-elementå®æˆ˜ï¼ˆå…¥é—¨ç¯‡ï¼‰/img/vue.jpg"><br>&emsp;åæ¥åœ¨æœºç¼˜å·§åˆçš„è¿›äº†ä¸€å®¶åå°æ˜¯ç”¨vue+elementæ­å»ºçš„å…¬å¸ï¼Œå› ä¸ºå…¬å¸çš„å‰ç«¯å°±ä¸€ä¸ªï¼Œå…³é”®è¿˜æ˜¯ä¸ªå¦¹å­ï¼Œä¹Ÿä¸å¥½æ„ç»™å¥¹å¢åŠ å·¥ä½œé‡ï¼ŒåŸºæœ¬ä¸Šç®¡ç†åå°çš„åç«¯ä»£ç å’Œå‰ç«¯ä»£ç éƒ½éœ€è¦æˆ‘æ¥å†™ã€‚</p><p>&emsp;å¥½åœ¨æ¡†æ¶å·²ç»æ­å»ºå¥½äº†ï¼Œæˆ‘åªéœ€è¦å†™ä¸€äº›æ•°æ®äº¤äº’å’Œæ•°æ®æ¸²æŸ“ã€‚</p><p>&emsp;æ›´æ·±å…¥çš„äº†è§£Vueçš„è®¾è®¡æ€æƒ³ç‚¹å‡»è¿™é‡Œï¼š <a href="https://cn.vuejs.org/" target="_blank" rel="noopener">Vueå®˜ç½‘</a>ã€<a href="https://www.cnblogs.com/baiyang2292/p/11172675.html" target="_blank" rel="noopener">Vueè®¾è®¡æ€æƒ³</a>ã€‚<br><a id="more"></a></p><p><b>vueåˆ°åº•éš¾ä¸éš¾ï¼Ÿ</b></p><p>&emsp;ä»æˆ‘çœŸæ­£æ¥è§¦vueæ¥è¯´ï¼Œæƒ³çœŸæ­£æŠŠvueæ‘¸é€ç¡®å®å¾ˆéš¾ï¼Œä½†æ˜¯åªæƒ³å­¦ä¼šæ€ä¹ˆç”¨vueæ­å»ºåå°ç®¡ç†ç³»ç»Ÿè¿™å€’ä¸éš¾ã€‚</p><p>&emsp;å½“ç„¶è¿™éœ€è¦ä½ æœ‰ç‚¹å‰ç«¯çš„åŸºç¡€ï¼ˆhtml\css\jsï¼‰ï¼Œåœ¨æ²¡æœ‰å‰ç«¯çš„åŸºç¡€æƒ…å†µä¸‹ï¼Œå…¥é—¨vueç¡®å®æœ‰ç‚¹éš¾ã€‚</p><p><b>æœ‰ä¸€å®šå‰ç«¯çš„åŸºç¡€çš„æƒ…å†µä¸‹ï¼Œæ€ä¹ˆå¿«é€Ÿçš„å…¥é—¨vueï¼Ÿ</b></p><p>&emsp;é¦–å…ˆä½ è¦çŸ¥é“vue+elementUiæˆ–è€…å…¶ä»–uiå¼€å‘çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>&emsp;ç®€å•çš„ä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight js"><figcaption><span>å°æ —å­</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-table :data=<span class="string">"tableData"</span>&gt;</span><br><span class="line">      &lt;el-table-column prop=<span class="string">"date"</span> label=<span class="string">"æ—¥æœŸ"</span>&gt;&lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">      &lt;el-table-column prop="name" label="å§“å"&gt;&lt;/</span>el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=<span class="string">"address"</span> label=<span class="string">"åœ°å€"</span>&gt;&lt;<span class="regexp">/el-table-column&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>el-table&gt;</span><br><span class="line">  &lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">  &lt;script&gt;</span></span><br><span class="line"><span class="regexp">    export default &#123;</span></span><br><span class="line"><span class="regexp">      data() &#123;</span></span><br><span class="line"><span class="regexp">        return &#123;</span></span><br><span class="line"><span class="regexp">          tableData: [&#123;</span></span><br><span class="line"><span class="regexp">            date: '2016-05-02',</span></span><br><span class="line"><span class="regexp">            name: 'ç‹å°è™',</span></span><br><span class="line"><span class="regexp">            address: 'ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1518 å¼„'</span></span><br><span class="line"><span class="regexp">          &#125;, &#123;</span></span><br><span class="line"><span class="regexp">            date: '2016-05-04',</span></span><br><span class="line"><span class="regexp">            name: 'ç‹å°è™',</span></span><br><span class="line"><span class="regexp">            address: 'ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1517 å¼„'</span></span><br><span class="line"><span class="regexp">          &#125;, &#123;</span></span><br><span class="line"><span class="regexp">            date: '2016-05-01',</span></span><br><span class="line"><span class="regexp">            name: 'ç‹å°è™',</span></span><br><span class="line"><span class="regexp">            address: 'ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1519 å¼„'</span></span><br><span class="line"><span class="regexp">          &#125;, &#123;</span></span><br><span class="line"><span class="regexp">            date: '2016-05-03',</span></span><br><span class="line"><span class="regexp">            name: 'ç‹å°è™',</span></span><br><span class="line"><span class="regexp">            address: 'ä¸Šæµ·å¸‚æ™®é™€åŒºé‡‘æ²™æ±Ÿè·¯ 1516 å¼„'</span></span><br><span class="line"><span class="regexp">          &#125;]</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>script&gt;</span><br></pre></td></tr></table></figure><img src="/vue-elementå®æˆ˜ï¼ˆå…¥é—¨ç¯‡ï¼‰/img/table.png"><p>&emsp;ä»ä»£ç å¯ä»¥çœ‹å‡ºTableçš„æ•°æ®æ¥æºæ˜¯Jsé‡ŒtableDataæ•°ç»„ï¼Œå®ƒä»¬æ˜¯é€šè¿‡Vueçš„ç‰¹æ€§åŒå‘ç»‘å®šæ¥å®ç°çš„<a>:data=â€tableDataâ€</a>ï¼Œå­—æ®µé€šè¿‡<a>:prop=â€å­—æ®µåâ€</a>ã€‚</p><p>&emsp;é‚£ä¹ˆåœ¨çœŸå®æ•°æ®äº¤äº’çš„æƒ…å†µä¸‹å°±è¿™ä¹ˆå†™ï¼š</p><figure class="highlight js"><figcaption><span>å°æ —å­</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">      data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          tableData: []</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      created() &#123; <span class="comment">// é¡µé¢åˆ›å»ºåæ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">this</span>.getList(); <span class="comment">// æŸ¥è¯¢æ•°æ®</span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123; <span class="comment">// æ–¹æ³•é›†åˆ</span></span><br><span class="line">        getList()&#123;</span><br><span class="line">          axios(&#123; <span class="comment">// é¦–é€‰ä½ è¦å®‰è£… axios</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â method:<span class="string">'get'</span>,</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â url:<span class="string">'è¯·æ±‚åœ°å€'</span></span><br><span class="line">Â  Â  Â  Â  Â  &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">              <span class="comment">// è¯·æ±‚æˆåŠŸï¼ŒæŠŠæ•°æ®èµ‹å€¼ç»™tableData</span></span><br><span class="line">              <span class="keyword">this</span>.tableData = resp.data</span><br><span class="line">Â  Â  Â  Â  Â  &#125;).catch(<span class="function"><span class="params">resp</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="comment">// è¯·æ±‚å¤±è´¥</span></span><br><span class="line">Â  Â  Â  Â  Â  &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>&emsp;å°±è¿™ä¹ˆç®€å•ï¼Œvue+element+axiosæ•°æ®äº¤äº’å’Œæ¸²æŸ“å·²ç»å®Œæˆäº†ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Navicat Premium 12.1å®‰è£…ä¸æ¿€æ´»</title>
      <link href="/Navicat-Premium-12-1%E5%AE%89%E8%A3%85%E4%B8%8E%E6%BF%80%E6%B4%BB/"/>
      <url>/Navicat-Premium-12-1%E5%AE%89%E8%A3%85%E4%B8%8E%E6%BF%80%E6%B4%BB/</url>
      
        <content type="html"><![CDATA[<p><b>å‰è¨€</b></p><p>&emsp;<a>ï¼ˆ1ï¼‰å³å°†å›½åº†ï¼Œåœ¨æˆ‘å›è€å®¶ä¹‹å‰ç»™å¤§å®¶åˆ†äº«ä¸€æ³¢ç¦åˆ©ï¼</a></p><p>&emsp;ï¼ˆ2ï¼‰åç«¯å¼€å‘ç¦»ä¸å¼€æ•°æ®åº“çš„ç®¡ç†ï¼Œä¸ºäº†æ›´åŠ æ–¹ä¾¿çš„ç®¡ç†æ•°æ®ï¼Œç»å¸¸ä¼šä½¿ç”¨ä¸€äº›æ•°æ®åº“ç®¡ç†å·¥ã€‚å¦‚<a href="https://www.phpmyadmin.net" target="_blank" rel="noopener">phpMyAdmin</a>ã€<a href="https://www.webyog.com/" target="_blank" rel="noopener">SQLyog</a>ã€<a href="https://dev.mysql.com/downloads/workbench/" target="_blank" rel="noopener">Workbench</a>ã€ <a href="https://www.navicat.com.cn/" target="_blank" rel="noopener">Navicat</a>ç­‰ç­‰ã€‚</p><p>&emsp;ï¼ˆ3ï¼‰ä½†æˆ‘ä¸ªäººè§‰å¾—ä»UIã€åŠŸèƒ½ä¸Šæ¥è¯´æœ€ä¼˜çš„æ˜¯<a>Navicat</a>ã€‚</p><p>&emsp;ï¼ˆ4ï¼‰å…·ä½“çš„åŠŸèƒ½å°±ä¸åšä»‹ç»äº†ï¼Œæœ¬ç¯‡å°±æ•™å¤§å®¶æ€ä¹ˆç ´è§£ä½¿ç”¨æœ€æ–°ç‰ˆçš„<a>Navicat</a>ï¼Œè€Œä¸”æ˜¯ç ´è§£å®˜æ–¹ç‰ˆçš„å“¦ï¼Œç»å¯¹ä¸æ˜¯é‚£ç§ä»ä¹±ä¸ƒå…«ç³Ÿçš„ç½‘ç«™ä¸Šä¸‹è½½æ¥çš„ã€‚</p><p>&emsp;ï¼ˆ5ï¼‰å®‰å…¨å¯é ï¼Œå¥½ç”¨ï¼Œ<a>å®˜æ–¹æ”¶è´¹3ä¸ªæœˆ1699äººæ°‘å¸</a>ï¼Œé©¬ä¸Šèƒ½å…è´¹ç”¨åˆ°ä»–ï¼Œæƒ³æƒ³å°±è§‰å¾—å…´å¥‹ã€‚<br><a id="more"></a></p><p><b>ä¸‹è½½&amp;å®‰è£…</b></p><p>&emsp;ï¼ˆ1ï¼‰å®˜æ–¹æœ€æ–°ç‰ˆä¸‹è½½åœ°å€:<a href="https://www.navicat.com.cn/download/navicat-premium" target="_blank" rel="noopener">Navicat Premium 12.1</a>ã€‚</p><p>&emsp;ï¼ˆ2ï¼‰æ³¨å†Œæœºä¸‹è½½åœ°å€ï¼š <a href="https://pan.baidu.com/s/1ADnw3MrVnzV4j1-MTLv1qg" target="_blank" rel="noopener">Navicatæ³¨å†Œæœº</a>ã€‚</p><p><b>ç ´è§£</b></p><p>&emsp;ï¼ˆ2ï¼‰<a>Navicat Premium 12.1</a>å®‰è£…æ­¥éª¤å°±ä¸ä»‹ç»äº†ï¼Œç›´æ¥éƒ½nextå°±å¥½äº†ã€‚</p><p>&emsp;ï¼ˆ3ï¼‰å®‰è£…æ³¨å†Œæœºï¼ˆæŠŠæ€æ¯’è½¯ä»¶å…¨éƒ¨é€€å‡ºï¼‰ã€‚</p><p>&emsp;ï¼ˆ4ï¼‰é€‰æ‹©ä½ å¯¹åº”çš„ç‰ˆæœ¬ä¿¡æ¯å’Œè¯­è¨€ã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p.png"><p>&emsp;ï¼ˆ5ï¼‰ç‚¹å‡»Patché€‰æ‹©Navicatå®‰è£…ç›®å½•ä¸‹çš„navicat.exeã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p1.png"><p>&emsp;ï¼ˆ6ï¼‰ç‚¹å‡»Generateç”Ÿæˆæ³¨å†Œç ã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p2.png"><p>&emsp;ï¼ˆ7ï¼‰æŠŠæ³¨å†Œç å¤åˆ¶åˆ°è½¯ä»¶ä¸­ï¼Œç‚¹å‡»æ¿€æ´»ï¼Œè¿™é‡Œä¼šæç¤ºæ¿€æ´»å¤±è´¥ï¼Œç„¶åå’±ä»¬ç‚¹å‡»æ‰‹åŠ¨æ¿€æ´»ã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p4.png"><p>&emsp;ï¼ˆ8ï¼‰æŠŠè¯·æ±‚ç å¤åˆ¶åˆ°æ³¨å†Œæœºä¸­ï¼Œå¦‚ä¸‹é¢çš„ä½ç½®ï¼Œç„¶åç‚¹å‡»Generateï¼ŒæŠŠè¿”å›çš„æ¿€æ´»ç å†å¤åˆ¶å›è½¯ä»¶ä¸­ï¼Œç‚¹å‡»æ¿€æ´»ã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p5.png"><p>&emsp;ï¼ˆ9ï¼‰æ¿€æ´»æˆåŠŸã€‚</p><img src="/Navicat-Premium-12-1å®‰è£…ä¸æ¿€æ´»/img/p6.png"><p><b>æœ€å</b></p><p>&emsp;ç„¶åå°±å°½æƒ…çš„ä½¿ç”¨å§ï¼ï¼ï¼ï¼å“ˆå“ˆå“ˆã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>swoole+websocketå®ç°èŠå¤©å®¤åŠŸèƒ½</title>
      <link href="/swoole+websocket%E5%AE%9E%E7%8E%B0%E8%81%8A%E5%A4%A9%E5%AE%A4%E5%8A%9F%E8%83%BD/"/>
      <url>/swoole+websocket%E5%AE%9E%E7%8E%B0%E8%81%8A%E5%A4%A9%E5%AE%A4%E5%8A%9F%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<p><b>åŸºç¡€ä»‹ç»</b></p><p>&emsp;ï¼ˆ1ï¼‰<a href="https://baike.baidu.com/item/Swoole/3707136?fr=aladdin" target="_blank" rel="noopener">Swoole</a>æ˜¯ä¸€ä¸ªé¢å‘ç”Ÿäº§ç¯å¢ƒçš„ PHP å¼‚æ­¥ç½‘ç»œé€šä¿¡å¼•æ“ï¼Œä½¿ PHP å¼€å‘äººå‘˜å¯ä»¥ç¼–å†™é«˜æ€§èƒ½çš„å¼‚æ­¥å¹¶å‘ TCPã€UDPã€Unix Socketã€HTTPï¼ŒWebSocket æœåŠ¡ã€‚Swoole å¯ä»¥å¹¿æ³›åº”ç”¨äºäº’è”ç½‘ã€ç§»åŠ¨é€šä¿¡ã€ä¼ä¸šè½¯ä»¶ã€äº‘è®¡ç®—ã€ç½‘ç»œæ¸¸æˆã€ç‰©è”ç½‘ï¼ˆIOTï¼‰ã€è½¦è”ç½‘ã€æ™ºèƒ½å®¶å±…ç­‰é¢†åŸŸã€‚ ä½¿ç”¨ PHP + Swoole ä½œä¸ºç½‘ç»œé€šä¿¡æ¡†æ¶ï¼Œå¯ä»¥ä½¿ä¼ä¸š IT ç ”å‘å›¢é˜Ÿçš„æ•ˆç‡å¤§å¤§æå‡ã€‚â€”<em>ç™¾åº¦ç™¾ç§‘</em></p><p>&emsp;ï¼ˆ2ï¼‰<a href="https://baike.baidu.com/item/WebSocket/1953845?fr=aladdin" target="_blank" rel="noopener">WebSocket</a>æ˜¯ä¸€ç§åœ¨å•ä¸ªTCPè¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„åè®®ã€‚WebSocketé€šä¿¡åè®®äº2011å¹´è¢«IETFå®šä¸ºæ ‡å‡†RFC 6455ï¼Œå¹¶ç”±RFC7936è¡¥å……è§„èŒƒã€‚WebSocket APIä¹Ÿè¢«W3Cå®šä¸ºæ ‡å‡†ã€‚<br>WebSocketä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚åœ¨WebSocket APIä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚ â€”<em>ç™¾åº¦ç™¾ç§‘</em><br><a id="more"></a></p><p>&emsp;ï¼ˆ3ï¼‰é‚£è¿™ç¯‡çš„ä¸»é¢˜å°±æ˜¯å¦‚ä½•ä½¿ç”¨<a>Swoole</a>+<a>WebSocket</a>å®ç°ä¸€ä¸ªç®€æ˜“çš„èŠå¤©å®¤ã€‚</p><p>&emsp;&emsp;ç†Ÿæ‚‰ç½‘ç»œé€šä¿¡åè®®çš„åŒå­¦è‚¯å®šä¸ä¼šé™Œç”Ÿã€‚</p><p><b>åŠŸèƒ½éœ€æ±‚åŠé—®é¢˜å¤„ç†</b></p><p>&emsp;webç«¯ï¼š<br>&emsp;&emsp;ï¼ˆ1ï¼‰æ¯æ¬¡åˆ·æ–°éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ID(idå€¼ä»1å¼€å§‹).<br>&emsp;&emsp;ï¼ˆ2ï¼‰ç¬¬ä¸€æ¬¡è¿›å…¥ç½‘ç«™æ—¶ä¼šè¦æ±‚ç”¨æˆ·è®¾ç½®æ˜µç§°å¹¶ä¼šä¸IDè¿›è¡Œç»‘å®šã€‚<br>&emsp;é—®é¢˜ç‚¹ï¼š<br>&emsp;&emsp;ï¼ˆ1ï¼‰åˆ·æ–°é¡µé¢åç”¨æˆ·æ ‡è¯†ï¼ˆIDï¼‰ä¼šé‡æ–°ç”Ÿæˆï¼Œä¹‹å‰ç”ŸæˆIDè¢«å¼ƒç”¨ã€‚<br>&emsp;&emsp;ï¼ˆ2ï¼‰websocketç”Ÿæˆäº†æ–°çš„ç”¨æˆ·ID,ä½†æ˜¯è·Ÿç°åœ¨çš„æ— æ³•å½¢æˆå…³è”å…³ç³»ã€‚</p><p>&emsp;serverç«¯ï¼š<br>&emsp;ï¼ˆ1ï¼‰å½“ç”¨æˆ·è¿›å…¥èŠå¤©å®¤åï¼Œå‘é€å¹¿æ’­ç»™æ‰€æœ‰äººå¹¶åŠ å…¥èŠå¤©ç¾¤ç»„ï¼ˆä½¿ç”¨rediså­˜å‚¨ï¼‰ã€‚<br>&emsp;ï¼ˆ2ï¼‰å½“ç”¨æˆ·é€€å‡ºç›´æ’­é—´åï¼Œå‘é€å¹¿æ’­ç»™æ‰€æœ‰äººå¹¶æ¸…é™¤è¯¥ç”¨æˆ·çš„è®°å½•ã€‚<br>&emsp;ï¼ˆ3ï¼‰ç”¨æˆ·æ¯å‘é€ä¸€æ¬¡æ¶ˆæ¯éƒ½è¦å½¢æˆæ–°çš„è®°å½•å¹¿æ’­ç»™æ‰€æœ‰äººã€‚<br>&emsp;ï¼ˆ4ï¼‰ç”¨æˆ·ç”Ÿæˆæ–°çš„æ˜µç§°åæŠŠæ˜µç§°æ¨é€ç»™ä»–ã€‚</p><p>&emsp;webç«¯é—®é¢˜å¤„ç†æ–¹æ³•ï¼š<br>&emsp;ï¼ˆ1ï¼‰æµè§ˆå™¨åˆ·æ–°æ—¶æé†’ç”¨æˆ·åˆ·æ–°å³å°†é‡æ–°è·å¾—æ–°çš„èº«ä»½ã€‚<br>&emsp;ï¼ˆ2ï¼‰ç”¨æˆ·è¿æ¥æˆåŠŸåè®°å½•ç”¨æˆ·name,æ¯æ¬¡è¿æ¥æŠŠè¿™ä¸ªnameå¸¦ä¸Šï¼Œæ¸…é™¤ä¹‹å‰è¯¥nameçš„ç»‘å®šå…³ç³»ï¼Œå½¢æˆæ–°çš„å…³ç³»ã€‚</p><p><b>æ¼”ç¤ºåœ°å€</b></p><p>&emsp;<a href="http://swoole.daichongweb.cn" target="_blank" rel="noopener">èŠå¤©å®¤æ¼”ç¤º</a></p><p><b>ä»£ç å®ç°</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;RedisManager.php&quot;;</span><br><span class="line"></span><br><span class="line">$server = new Swoole\WebSocket\Server(&quot;0.0.0.0&quot;, 8877);</span><br><span class="line"></span><br><span class="line">// å®¢æˆ·ç«¯è¿æ¥</span><br><span class="line">$server-&gt;on(&apos;open&apos;, function (Swoole\WebSocket\Server $server, $request) &#123;</span><br><span class="line">    //è¿æ¥æˆåŠŸæŠŠå½“å‰åœ¨çº¿çš„ç”¨æˆ·è¿”å›</span><br><span class="line">    $user_list = RedisConnect::getRedis()-&gt;hGetAll(&apos;message:user&apos;);</span><br><span class="line">    alone($server, $request-&gt;fd, [</span><br><span class="line">        &apos;type&apos; =&gt; &apos;first&apos;,</span><br><span class="line">        &apos;data&apos; =&gt; $user_list</span><br><span class="line">    ]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// æ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯</span><br><span class="line">$server-&gt;on(&apos;message&apos;, function (Swoole\WebSocket\Server $server, $frame) &#123;</span><br><span class="line">    $message_data = json_decode($frame-&gt;data, true);</span><br><span class="line">    $type = $message_data[&apos;type&apos;];</span><br><span class="line">    $data = $message_data[&apos;user_name&apos;];</span><br><span class="line">    if (isset($message_data[&apos;send_message&apos;])) &#123;</span><br><span class="line">        $user_message = $message_data[&apos;send_message&apos;];</span><br><span class="line">    &#125;</span><br><span class="line">    switch ($type) &#123;</span><br><span class="line">        case &apos;save_user&apos;:</span><br><span class="line">            $new_name = &apos;å¤§å¦å•å­&apos; . $frame-&gt;fd . &apos;å·&apos;;</span><br><span class="line">            // ä¿®æ”¹ç”¨æˆ·æ˜µç§°</span><br><span class="line">            RedisConnect::getRedis()-&gt;hset(&apos;message:user&apos;, $frame-&gt;fd, $new_name);</span><br><span class="line"></span><br><span class="line">            // æŠŠç”Ÿæˆçš„ç”¨æˆ·æ˜µç§°è¿”å›ç»™ä»–</span><br><span class="line">            alone($server, $frame-&gt;fd, [</span><br><span class="line">                &apos;type&apos; =&gt; &apos;new_name&apos;,</span><br><span class="line">                &apos;name&apos; =&gt; $new_name,</span><br><span class="line">                &apos;id&apos; =&gt; $frame-&gt;fd</span><br><span class="line">            ]);</span><br><span class="line"></span><br><span class="line">            // å¹¿æ’­æ¶ˆæ¯ç»™å…¶ä»–ç”¨æˆ·</span><br><span class="line">            groupSending($server, [</span><br><span class="line">                &apos;type&apos; =&gt; &apos;open&apos;,</span><br><span class="line">                &apos;name&apos; =&gt; $new_name,</span><br><span class="line">                &apos;id&apos; =&gt; $frame-&gt;fd</span><br><span class="line">            ]);</span><br><span class="line">            break;</span><br><span class="line">        case &apos;send_message&apos;:</span><br><span class="line">            $msg = [</span><br><span class="line">                &apos;id&apos; =&gt; $frame-&gt;fd,</span><br><span class="line">                &apos;user_name&apos; =&gt; $data,</span><br><span class="line">                &apos;message&apos; =&gt; $user_message,</span><br><span class="line">                &apos;type&apos; =&gt; &apos;message&apos;</span><br><span class="line">            ];</span><br><span class="line">            // æ¥å—ç”¨æˆ·å‘é€çš„æ¶ˆæ¯</span><br><span class="line">            RedisConnect::getRedis()-&gt;lpush(&apos;message:user:say&apos;, $msg);</span><br><span class="line">            groupSending($server, $msg);</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// é€€å‡ºèŠå¤©å®¤</span><br><span class="line">$server-&gt;on(&apos;close&apos;, function ($ser, $fd) &#123;</span><br><span class="line">    $user = RedisConnect::getRedis()-&gt;hget(&apos;message:user&apos;, $fd);</span><br><span class="line">    RedisConnect::getRedis()-&gt;hdel(&apos;message:user&apos;, $fd);</span><br><span class="line">    $msg = [</span><br><span class="line">        &apos;id&apos; =&gt; $fd,</span><br><span class="line">        &apos;user_name&apos; =&gt; $user,</span><br><span class="line">        &apos;message&apos; =&gt; &apos;é€€å‡ºèŠå¤©å®¤&apos;,</span><br><span class="line">        &apos;type&apos; =&gt; &apos;close&apos;</span><br><span class="line">    ];</span><br><span class="line">    groupSending($ser, $msg, $fd);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// å¼€å¯æœåŠ¡</span><br><span class="line">$server-&gt;start();</span><br><span class="line"></span><br><span class="line">// ç¾¤å‘æ¶ˆæ¯</span><br><span class="line">function groupSending($server, $msg, $self = null)</span><br><span class="line">&#123;</span><br><span class="line">    foreach ($server-&gt;connections as $conn) &#123;</span><br><span class="line">        if ($conn == $self) break; //ä¸å†æ¨é€ç»™å½“å‰é€€å‡ºçš„ç”¨æˆ·</span><br><span class="line">        $server-&gt;push($conn, json_encode($msg));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å•ç‹¬å‘æ¶ˆæ¯</span><br><span class="line">function alone($server, $fd, $msg)</span><br><span class="line">&#123;</span><br><span class="line">    $server-&gt;push($fd, json_encode($msg));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">    &lt;title&gt;èŠå¤©å®¤&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">       *&#123;margin:0;padding:0&#125;.box&#123;width:602px;height:500px;margin:20px auto&#125;.body&#123;width:500px;height:500px;border:1px solid #333;padding:20px;box-sizing:border-box;float:right&#125;.title&#123;text-align:center;margin-top:10px&#125;.msg&#123;margin-top:20px;width:100%;text-align:left&#125;.message_box&#123;width:100%;height:90%;margin-top:10px;font-size:12px;overflow:hidden;overflow-y:auto&#125;.name&#123;font-weight:bold&#125;.right&#123;text-align:right&#125;.prompt&#123;width:600px;margin:0 auto&#125;.live&#123;width:100px;height:500px;float:left;border:1px solid #333;font-size:12px;text-align:center&#125;.live-box&#123;height:100%;overflow:hidden;overflow-y:auto&#125;.live-box p&#123;margin-top:10px&#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;body&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;title&quot;&gt;+++++++++++èŠå¤©å®¤++++++++++++&lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;message_box&quot; id=&quot;test&quot;&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;live&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;live-title&quot;&gt;åœ¨çº¿äººæ•°&lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;live-box&quot;&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;prompt&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;say&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;button&quot; value=&quot;å‘é€&quot; id=&quot;send&quot;&gt;</span><br><span class="line">        &lt;!-- &lt;input type=&quot;button&quot; value=&quot;å¢åŠ æ¶ˆæ¯&quot; id=&quot;add&quot;&gt; --&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    window.onbeforeunload = function (event) &#123;</span><br><span class="line">        window.localStorage.clear();</span><br><span class="line">    &#125;;</span><br><span class="line">    $(function () &#123;</span><br><span class="line">        window.user_name = &apos;&apos;;</span><br><span class="line">        // è·å–åœ¨çº¿ç”¨æˆ·</span><br><span class="line">        if (!(&quot;WebSocket&quot; in window)) &#123;</span><br><span class="line">            alert(&quot;æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ WebSocket!&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        // è¿æ¥</span><br><span class="line">        let ws = new WebSocket(&quot;ws://49.235.172.110:8877&quot;);</span><br><span class="line">        //è¿æ¥æˆåŠŸ</span><br><span class="line">        ws.onopen = function (event) &#123;</span><br><span class="line">            // ä¿®æ”¹æ˜µç§°</span><br><span class="line">            let user_info = &#123;</span><br><span class="line">                &apos;type&apos;: &apos;save_user&apos;,</span><br><span class="line">                &apos;user_name&apos;: &apos;&apos;,</span><br><span class="line">            &#125;;</span><br><span class="line">            ws.send(JSON.stringify(user_info));</span><br><span class="line">            console.log(&apos;è¿æ¥æˆåŠŸ&apos;, &apos;ä¿®æ”¹æ˜µç§°æˆåŠŸ&apos;);</span><br><span class="line">        &#125;;</span><br><span class="line">        ws.onmessage = function (evt) &#123;</span><br><span class="line">            let received_msg = JSON.parse(evt.data);</span><br><span class="line">            let type = received_msg[&apos;type&apos;];</span><br><span class="line">            switch (type) &#123;</span><br><span class="line">                case &apos;message&apos;:</span><br><span class="line">                    add_msg(received_msg);</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;close&apos;:</span><br><span class="line">                    $(&quot;.live-box&quot;).find(&apos;p[user=&apos; + received_msg[&apos;id&apos;] + &apos;]&apos;).remove();</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;connect&apos;:</span><br><span class="line">                    console.log(received_msg);</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;new_name&apos;:</span><br><span class="line">                    user_name = received_msg[&apos;name&apos;];</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;open&apos;:</span><br><span class="line">                    $(&apos;.live-box&apos;).append(&apos;&lt;p user=&quot;&apos; + received_msg[&apos;id&apos;] + &apos;&quot;&gt;&apos; + received_msg[&apos;name&apos;] + &apos;&lt;/p&gt;&apos;);</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;first&apos;:</span><br><span class="line">                    let data = received_msg[&apos;data&apos;];</span><br><span class="line">                    let str = &apos;&apos;;</span><br><span class="line">                    $.each(data, function (k, v) &#123;</span><br><span class="line">                        if (isNaN(v)) &#123;</span><br><span class="line">                            str += &apos;&lt;p user=&quot;&apos; + k + &apos;&quot;&gt;&apos; + v + &apos;&lt;/p&gt;&apos;;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    $(&apos;.live-box&apos;).append(str);</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        // å‘é€æ¶ˆæ¯</span><br><span class="line">        $(&quot;#send&quot;).click(function () &#123;</span><br><span class="line">            send_msg();</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        $(&quot;input[name=say]&quot;).bind(&quot;keydown&quot;, function (e) &#123;</span><br><span class="line">            var theEvent = e || window.event;</span><br><span class="line">            var code = theEvent.keyCode || theEvent.which || theEvent.charCode;</span><br><span class="line">            if (code == 13) &#123;</span><br><span class="line">                send_msg();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // å‘é€æ¶ˆæ¯</span><br><span class="line">        function send_msg() &#123;</span><br><span class="line">            var message = $(&apos;input[name=say]&apos;).val();</span><br><span class="line">            if (message !== &apos; &apos;) &#123;</span><br><span class="line">                var arr = &#123;</span><br><span class="line">                    &apos;type&apos;: &apos;send_message&apos;,</span><br><span class="line">                    &apos;user_name&apos;: user_name,</span><br><span class="line">                    &apos;send_message&apos;: message</span><br><span class="line">                &#125;;</span><br><span class="line">                ws.send(JSON.stringify(arr));</span><br><span class="line">            &#125;</span><br><span class="line">            $(&apos;input[name=say]&apos;).val(&apos; &apos;);</span><br><span class="line">            var ele = document.getElementById(&quot;test&quot;);</span><br><span class="line">            if (ele.scrollHeight &gt; ele.clientHeight) &#123;</span><br><span class="line">                ele.scrollTop = ele.scrollHeight + 100;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // å¢åŠ æ¶ˆæ¯</span><br><span class="line">        function add_msg(data) &#123;</span><br><span class="line">            let str = &apos;&lt;div class=&quot;msg&quot;&gt;&apos;;</span><br><span class="line">            str += &apos;&lt;span class=&quot;name&quot;&gt;&apos; + data[&apos;user_name&apos;] + &apos;&lt;/span&gt;:&apos;;</span><br><span class="line">            str += &apos;&lt;span class=&quot;text&quot;&gt;&apos; + data[&apos;message&apos;] + &apos;&lt;/span&gt;&lt;/div&gt;&apos;;</span><br><span class="line">            $(&apos;.message_box&apos;).append(str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><b>æ€»ç»“</b></p><p>&emsp;è¿™ç¯‡æ–‡ç« åªæ˜¯ç®€å•çš„ä»‹ç»å‰åç«¯å¦‚ä½•å®ç°é€šä¿¡ï¼Œå¾ˆå¤šçš„ç»†èŠ‚é—®é¢˜æ²¡æœ‰è¿›è¡Œå¤„ç†ã€‚<br>&emsp;UIæ¯”è¾ƒlowï¼Œè¿™é‡Œå¤§å®¶åªçœ‹ä»£ç å°±å¥½äº†â€¦<br>&emsp;æ›´å¤šå…³äºSwooleçš„åŠŸèƒ½è¿˜å¾…æ¢ç´¢â€¦æ•¬è¯·æœŸå¾…â€¦</p>]]></content>
      
      
      
        <tags>
            
            <tag> phpæ‰©å±•ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•</title>
      <link href="/WEB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95-%E5%B9%B6%E5%8F%91%E6%B5%8B%E8%AF%95/"/>
      <url>/WEB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95-%E5%B9%B6%E5%8F%91%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<p><b>å‰ç¯‡å›å¿†ï¼š</b></p><p>&emsp;å‰ä¸¤ç¯‡ä»‹ç»äº†<a>redis</a>é˜Ÿåˆ—å¦‚ä½•å¤„ç†è®¢å•å’Œ<a>JMeter</a>çš„ç¯å¢ƒé…ç½®åŠå®‰è£…æ–¹æ³•ï¼Œè¿™ç¯‡æ ¹æ®ç¨‹åºå¼€å‘çš„é€»è¾‘å’Œä¹ æƒ¯æ¥è§£å†³å‡ ä¸ªé—®é¢˜ï¼š</p><p>&emsp;&emsp;ï¼ˆ1ï¼‰JMeterå¹¶å‘æµ‹è¯•çš„åŸºæœ¬ä½¿ç”¨ã€‚<br>&emsp;&emsp;ï¼ˆ2ï¼‰<a>redis</a>å’Œ<a>mysql</a>ç›¸æ¯”çš„æ€§èƒ½å·®è·å¦‚ä½•ï¼Ÿ<br>&emsp;&emsp;ï¼ˆ3ï¼‰å¤§é‡çš„å¹¶å‘å’Œè¯·æ±‚ä¸‹<a>redis</a>ã€<a>mysql</a>ã€<a>nginx</a>å„è‡ªä¼šå‡ºç°çš„é—®é¢˜ï¼Ÿ<br>&emsp;&emsp;ï¼ˆ4ï¼‰é‡åˆ°å¹¶å‘å¸¦æ¥å„ç§å„æ ·çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ<br><a id="more"></a></p><p><b>é—®é¢˜ä¸€ï¼š<sup>JMeterå¹¶å‘æµ‹è¯•çš„åŸºæœ¬ä½¿ç”¨<sup></sup></sup></b></p><p>&emsp;ï¼ˆ1ï¼‰è®¾ç½®ç³»ç»Ÿè¯­è¨€ï¼šOptions-&gt;Choose Lanuage é‡Œé€‰æ‹©é€‚åˆä½ çš„è¯­è¨€ã€‚<br>&emsp;ï¼ˆ2ï¼‰æ·»åŠ çº¿ç¨‹ç»„ï¼š<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan.png"><br>&emsp;ï¼ˆ3ï¼‰è®¾ç½®çº¿ç¨‹å±æ€§ï¼š<br>&emsp;&emsp;çº¿ç¨‹æ•°ï¼šä¹Ÿå°±æ˜¯å¹¶å‘æ•°ã€‚<br>&emsp;&emsp;Ramp-Upæ—¶é—´ï¼ˆç§’ï¼‰ï¼šå¹¶å‘æ—¶é—´ï¼Œ0ä¸ºåŒæ—¶å¹¶å‘ã€‚<br>&emsp;&emsp;å¾ªç¯æ¬¡æ•°ï¼šé‡å¤æ¬¡æ•°ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan1.png"><br>&emsp;ï¼ˆ4ï¼‰æ·»åŠ HTTPè¯·æ±‚ï¼š<br>&emsp;&emsp;åè®®ï¼šhttpæˆ–httpsã€‚<br>&emsp;&emsp;æœåŠ¡å™¨åç§°æˆ–IPï¼šè¯·æ±‚åœ°å€ã€‚<br>&emsp;&emsp;è·¯å¾„ï¼šè¦è¯·æ±‚çš„è·¯ç”±æˆ–æ–‡ä»¶è·¯å¾„ã€‚<br>&emsp;&emsp;å‚æ•°ï¼šæ·»åŠ è¯·æ±‚å‚æ•°ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan2.png"><br>&emsp;ï¼ˆ5ï¼‰æ·»åŠ å¯Ÿçœ‹ç»“æœæ ‘ï¼šå¯æŸ¥çœ‹å‘é€çš„æ•°æ®ï¼Œè¿”å›çš„ç»“æœç­‰ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan3.png"><br>&emsp;ï¼ˆ6ï¼‰æ·»åŠ æ±‡æ€»æŠ¥å‘Šï¼šå¯æŸ¥çœ‹é”™è¯¯ç‡ï¼Œååé‡ç­‰ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan4.png"></p><p><b>é—®é¢˜äºŒï¼š<sup>å¤§é‡çš„å¹¶å‘å’Œè¯·æ±‚ä¸‹<a>redis</a>ã€<a>mysql</a>ã€<a>nginx</a>å„è‡ªä¼šå‡ºç°çš„é—®é¢˜ï¼Ÿ<sup></sup></sup></b></p><p>&emsp;åœ¨åŒæ—¶å¹¶å‘2000çš„æƒ…å†µä¸‹ï¼ˆå› ä¸ºredisé˜Ÿåˆ—ä¸ºå¼‚æ­¥ï¼Œæ‰€ä»¥è¿™é‡Œä¸è€ƒè™‘rediså‡ºåˆ—çš„æ€§èƒ½é—®é¢˜ï¼‰ï¼š<br>&emsp;<a>mysql</a>ï¼šé”™è¯¯ç‡87.9%ï¼ŒæˆåŠŸæ¡æ•°241ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan5.png"><br>&emsp;<a>redis</a>ï¼šé”™è¯¯ç‡0.35%ï¼ŒæˆåŠŸæ¡æ•°1993ã€‚<br><img src="/WEBæ€§èƒ½æµ‹è¯•-å¹¶å‘æµ‹è¯•/img/plan5.png"><br>&emsp;æ€»ç»“ï¼šä»ä»¥ä¸Šç»“æœå¯ä»¥çœ‹å‡ºåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹msyqlæ‰›ä¸ä½å‹åŠ›é”™è¯¯ç‡é«˜ã€‚<br>&emsp;ç»“è®ºï¼šredisåœ¨å¤„ç†å¹¶å‘æ€§èƒ½ä¼˜äºmysqlã€‚</p><p><b>é—®é¢˜ä¸‰ï¼šå¤§é‡çš„å¹¶å‘å’Œè¯·æ±‚ä¸‹<a>redis</a>ã€<a>mysql</a>ã€<a>nginx</a>å„è‡ªä¼šå‡ºç°çš„é—®é¢˜ï¼Ÿ</b></p><p>&emsp;3000å¹¶å‘å¾ªç¯è¯·æ±‚3æ¬¡ç›¸å½“äº9000çš„æ¬¡è¯·æ±‚çš„æƒ…å†µä¸‹ï¼š<br>&emsp;&emsp;ï¼ˆ1ï¼‰nginxæŠ¥é”™ï¼š<a>Too many open files</a>ï¼ˆæ‰“å¼€çš„æ–‡ä»¶æ•°è¶…è¿‡é™åˆ¶nginxé»˜è®¤ä¸º1024ï¼‰ã€‚<br>&emsp;&emsp;ï¼ˆ2ï¼‰redisæŠ¥é”™ï¼š<a>RDB: 2 MB of memory used by copy-on-write</a>ã€‚<br>&emsp;&emsp;ï¼ˆ3ï¼‰mysqlç›´æ¥å†™å…¥å¤±è´¥ã€‚</p><p><b>é—®é¢˜å››ï¼š<sup>é‡åˆ°å¹¶å‘å¸¦æ¥å„ç§å„æ ·çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ<sup></sup></sup></b></p><p>&emsp;ï¼ˆ1ï¼‰<a>nginxé”™è¯¯åˆ†æï¼šæœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°è¶…è¿‡é™åˆ¶</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶å€¼ Max open files</span><br><span class="line">catÂ /proc/`psÂ -efÂ |Â grepÂ nginx|grepÂ -vÂ grep|headÂ -1|awkÂ &apos;&#123;printÂ $2&#125;&apos;`/limits</span><br><span class="line"># ä¿®æ”¹</span><br><span class="line">vi /etc/systemd/ststem.conf</span><br><span class="line"># ä¿®æ”¹ä¸¤ä¸ªå€¼</span><br><span class="line">DefaultLimitNOFILE = 102400</span><br><span class="line">DefaultLimitNPROC = 102400</span><br><span class="line"># éšåé‡å¯ç³»ç»Ÿ</span><br></pre></td></tr></table></figure><br>&emsp;ï¼ˆ2ï¼‰<a>redisé”™è¯¯åˆ†æï¼šä¿å­˜é¢‘ç¹å¯¼è‡´å†…å­˜ä¸å¤Ÿäº†ã€‚</a>ï¼ˆæš‚æœªæ‰¾åˆ°æœ€åˆé€‚çš„æ–¹æ¡ˆï¼‰<br>&emsp;ç‚¹å‡»æŸ¥çœ‹æ›´è¯¦ç»†çš„é”™è¯¯åˆ†æ:<a href="https://yq.aliyun.com/articles/629296" target="_blank" rel="noopener">Redis-rediså¼‚å¸¸è§£å†³ä»¥åŠæ—¥å¸¸å‘½ä»¤</a></p><p>&emsp;ï¼ˆ3ï¼‰<a>mysql</a>æš‚æ²¡æ‰¾åˆ°æ–¹æ¡ˆã€‚</p><p><b>æ€»ç»“ï¼š</b></p><p>&emsp;ç›¸åŒçš„é…ç½®&amp;é«˜å¹¶å‘åœºæ™¯ä¸‹<a>redis</a>æ¯”<a>mysql</a>è¦å¯é å¾ˆå¤šï¼Œä¼´éšç€å¹¶å‘è¶Šæ¥è¶Šé«˜æœåŠ¡å™¨ã€ç¨‹åºã€æ•°æ®åº“å„æ–¹é¢çš„é—®é¢˜æ‰‘é¢è€Œæ¥ï¼Œä¸è¦æ…Œï¼Œè¿™æ‰æ˜¯ä½ çœŸæ­£éœ€è¦å­¦ä¹ çš„ä¸œè¥¿ï¼ç”Ÿäºå¿§æ‚£æ­»äºå®‰ä¹ï¼Œåªæœ‰ä¸æ–­çš„å¤„ç†é—®é¢˜ï¼Œæ‰èƒ½çœŸæ­£çš„é©¾é©­ç¨‹åºï¼ç¥ä½ æ—©æ—¥æˆåŠŸï¼ï¼ï¼</p><p>&emsp;æœ¬æ–‡æœ€é«˜æµ‹è¯•å¹¶å‘åœ¨3000å¾ªç¯æ¬¡æ•°ä¸º3æ¬¡ï¼ŒæœåŠ¡å™¨ç¯å¢ƒä¸ºlnmrp,ç³»ç»Ÿé…ç½®ä¸º2æ ¸4G6M,å› ä¸ºredisçš„é—®é¢˜æ²¡æœ‰è§£å†³ä¸èƒ½åšæ›´é«˜çš„å¹¶å‘æµ‹è¯•ã€‚å¹¶ä¸”è¿˜æœ‰ä¸€ä¸ªredisçš„é—®é¢˜æ²¡æœ‰è§£å†³ï¼Œå¾…æˆ‘ç ”ç©¶å‡ æ—¥è¯´ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBæ€§èƒ½æµ‹è¯•-JMeterå®‰è£…</title>
      <link href="/WEB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95-JMeter%E5%AE%89%E8%A3%85/"/>
      <url>/WEB%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95-JMeter%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<p><b>ä¸€ã€äº†è§£JMeterå·¥å…·</b></p><p>&emsp;<a href="https://baike.baidu.com/item/Jmeter/3104456?fr=aladdin" target="_blank" rel="noopener">Apache JMeter</a>æ˜¯ <a href="https://baike.baidu.com/item/apache/6265" target="_blank" rel="noopener">Apache</a>ç»„ç»‡çš„å¼€æ”¾æºä»£ç é¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ª100%çº¯Javaæ¡Œé¢åº”ç”¨ï¼Œç”¨äºå‹åŠ›æµ‹è¯•å’Œæ€§èƒ½æµ‹é‡ã€‚å®ƒæœ€åˆè¢«è®¾è®¡ç”¨äºWebåº”ç”¨æµ‹è¯•ä½†åæ¥æ‰©å±•åˆ°å…¶å®ƒæµ‹è¯•é¢†åŸŸã€‚Apache JMeterå¯ä»¥ç”¨äºå¯¹é™æ€çš„å’ŒåŠ¨æ€çš„èµ„æºï¼ˆæ–‡ä»¶ï¼ŒServletï¼ŒPerlè„šæœ¬ï¼ŒJavaå¯¹è±¡ï¼Œæ•°æ®åº“å’ŒæŸ¥è¯¢ï¼ŒFTPæœåŠ¡å™¨æˆ–æ˜¯å…¶å®ƒèµ„æºï¼‰çš„æ€§èƒ½è¿›è¡Œæµ‹è¯•ã€‚JMeterå¯ä»¥ç”¨äºåœ¨æœåŠ¡å™¨ï¼Œç½‘ç»œæˆ–å¯¹è±¡æ¨¡æ‹Ÿç¹é‡çš„è´Ÿè½½æ¥æµ‹è¯•å®ƒä»¬æä¾›æœåŠ¡çš„å—å‹èƒ½åŠ›æˆ–è€…åˆ†æä¸åŒå‹åŠ›æ¡ä»¶ä¸‹çš„æ€»ä½“æ€§èƒ½æƒ…å†µã€‚ä½ å¯ä»¥ä½¿ç”¨JMeteræä¾›çš„å›¾å½¢åŒ–ç•Œé¢ï¼Œåˆ†ææ€§èƒ½æŒ‡æ ‡æˆ–è€…åœ¨é«˜è´Ÿè½½æƒ…å†µä¸‹æµ‹è¯•ä½ çš„æœåŠ¡å™¨/è„šæœ¬/å¯¹è±¡ã€‚<br><a id="more"></a><br><b>äºŒã€JMeterçš„ä½œç”¨</b></p><p>&emsp;ï¼ˆ1ï¼‰èƒ½å¤Ÿå¯¹<a href="https://baike.baidu.com/item/http/243074?fr=aladdin" target="_blank" rel="noopener">HTTP</a>å’Œ<a href="https://baike.baidu.com/item/FTP%E5%8D%8F%E8%AE%AE/7651119" target="_blank" rel="noopener">FTP</a>æœåŠ¡å™¨è¿›è¡Œå‹åŠ›å’Œæ€§èƒ½æµ‹è¯•ï¼Œä¹Ÿå¯ä»¥å¯¹ä»»ä½•çš„æ•°æ®åº“è¿›è¡ŒåŒæ ·çš„æµ‹è¯•ï¼ˆé€šè¿‡<a href="https://baike.baidu.com/item/JDBC" target="_blank" rel="noopener">JDBC</a>ï¼‰ã€‚</p><p>&emsp;ï¼ˆ2ï¼‰å®Œå…¨å¤šçº¿ç¨‹ æ¡†æ¶å…è®¸é€šè¿‡å¤šä¸ªçº¿ç¨‹å¹¶å‘å–æ ·å’Œ é€šè¿‡å•ç‹¬çš„çº¿ç¨‹ç»„å¯¹ä¸åŒçš„åŠŸèƒ½åŒæ—¶å–æ ·ã€‚</p><p>&emsp;ï¼ˆ3ï¼‰åœ¨è®¾è®¡é˜¶æ®µï¼ŒJMeterèƒ½å¤Ÿå……å½“HTTP PROXYï¼ˆä»£ç†ï¼‰æ¥è®°å½•IE/NETSCAPEçš„HTTPè¯·æ±‚ï¼Œä¹Ÿå¯ä»¥è®°å½•apacheç­‰WebServerçš„logæ–‡ä»¶æ¥é‡ç°HTTPæµé‡ã€‚å½“è¿™äº›HTTPå®¢æˆ·ç«¯è¯·æ±‚è¢«è®°å½•ä»¥åï¼Œæµ‹è¯•è¿è¡Œæ—¶å¯ä»¥æ–¹ä¾¿çš„è®¾ç½®é‡å¤æ¬¡æ•°å’Œå¹¶å‘åº¦ï¼ˆçº¿ç¨‹æ•°ï¼‰æ¥äº§ç”Ÿå·¨å¤§çš„æµé‡ã€‚JMeterè¿˜æä¾›å¯è§†åŒ–ç»„ä»¶ä»¥åŠæŠ¥è¡¨å·¥å…·æŠŠé‡æœåŠ¡å™¨åœ¨ä¸åŒå‹åŠ›ä¸‹çš„æ€§èƒ½å±•ç°å‡ºæ¥ã€‚</p><p><b>ä¸‰ã€å®‰è£…</b></p><p>&emsp;ï¼ˆ1ï¼‰JMeteræ˜¯å®Œå…¨åŸºäºJAVAå¼€å‘ï¼Œé¦–å…ˆè¦å®‰è£… <a href="https://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="noopener">JAVA JDK</a>ã€‚</p><p>&emsp;ï¼ˆ2ï¼‰å®‰è£…<a href="http://jmeter.apache.org/download_jmeter.cgi" target="_blank" rel="noopener">JMeterå®¢æˆ·ç«¯</a>ã€‚</p><p><b>å››ã€é…ç½®JAVAç¯å¢ƒå˜é‡</b></p><p>&emsp;ï¼ˆ1ï¼‰å³é”® â€œæˆ‘çš„ç”µè„‘\å±æ€§â€<sup>(ç¬¬ä¸€æ­¥)</sup> æˆ– â€œæ§åˆ¶é¢æ¿\æ‰€æœ‰æ§åˆ¶é¢æ¿é¡¹\ç³»ç»Ÿâ€<sup>(ç¬¬ä¸€æ­¥)</sup> æ‰¾åˆ° â€œé«˜çº§ç³»ç»Ÿè®¾ç½®â€<sup>(ç¬¬äºŒæ­¥)</sup> ç‚¹å‡» â€œç¯å¢ƒå˜é‡â€<sup>(ç¬¬ä¸‰æ­¥)</sup>ã€‚</p><p>&emsp;ï¼ˆ2ï¼‰æ–°å»ºç¯å¢ƒå˜é‡JAVA_HOMEï¼Œå€¼ä¸ºJAVAå®‰è£…çš„æ ¹ç›®å½•ã€‚</p><img src="/WEBæ€§èƒ½æµ‹è¯•-JMeterå®‰è£…/img/path.png"><p>&emsp;ï¼ˆ3ï¼‰æ–°å»ºç¯å¢ƒå˜é‡CLASSPATHï¼Œå€¼ä¸ºJAVAå®‰è£…ç›®å½•ä¸‹çš„lib/tools.jarå’Œlib/dt.jarã€‚</p><img src="/WEBæ€§èƒ½æµ‹è¯•-JMeterå®‰è£…/img/path1.png"><p>&emsp;ï¼ˆ4ï¼‰ä¿®æ”¹ç³»ç»Ÿå˜é‡çš„PATHå€¼ï¼Œå¢åŠ ä¸ºJAVAå®‰è£…ç›®å½•ä¸‹çš„binç›®å½•ã€‚</p><img src="/WEBæ€§èƒ½æµ‹è¯•-JMeterå®‰è£…/img/path2.png"><p><b>äº”ã€é…ç½®JMeterç¯å¢ƒå˜é‡</b></p><p>&emsp;ï¼ˆ1ï¼‰æ–°å»ºç¯å¢ƒå˜é‡JMETER_HOMEï¼Œå€¼ä¸ºJMeterçš„æ ¹ç›®å½•ã€‚</p><img src="/WEBæ€§èƒ½æµ‹è¯•-JMeterå®‰è£…/img/path3.png"><p>&emsp;ï¼ˆ2ï¼‰ä¿®æ”¹CLASSPATHï¼Œå¢åŠ JMeter/lib/ApacheJMeter_core.jarå’Œlogkit-2.0.jarã€‚</p><img src="/WEBæ€§èƒ½æµ‹è¯•-JMeterå®‰è£…/img/path4.png"><p>&emsp;ï¼ˆ3ï¼‰æ‰¾åˆ°JMeter/bin/JMeter.batåŒå‡»æ‰“å¼€ï¼Œå¦‚å‡ºç°é”™è¯¯ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰JMeter/lib/ApacheJMeter_core.jarè¿™ä¸ªæ–‡ä»¶ï¼Œæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å°±æ˜¯å®‰è£…é”™è¯¯äº†ï¼Œé‡æ–°æ¢ä¸ªåŒ…å®‰è£…ã€‚</p><p><b>å…­ã€æ‰“å¼€æˆåŠŸæ¼”ç¤º</b></p><p>&emsp;éšåä¼šè‡ªåŠ¨æ‰“å¼€JMeterå®¢æˆ·ç«¯ã€‚</p><img src="/WEBæ€§èƒ½æµ‹è¯•-JMeterå®‰è£…/img/path5.png"><p><b>ä¸ƒã€æ€»ç»“</b></p><p>&emsp;æ€»ä½“çš„å®‰è£…è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå°±æ˜¯æ­¥éª¤ç¹å¤šï¼Œæ¯ä¸€ä¸ªæ­¥éª¤éƒ½ä¸èƒ½æ¼ï¼Œå¦åˆ™å°±ä¼šæ— æ³•ä½¿ç”¨ã€‚</p><p>&emsp;ä¸‹ä¸€ç¯‡å°†ä¼šä»‹ç»JMeterçš„åŸºæœ¬ä½¿ç”¨ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆredisï¼‰-è®¢å•å¤„ç†</title>
      <link href="/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%EF%BC%88redis%EF%BC%89-%E8%AE%A2%E5%8D%95%E5%A4%84%E7%90%86/"/>
      <url>/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%EF%BC%88redis%EF%BC%89-%E8%AE%A2%E5%8D%95%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p><b>ä¸€ã€ç®€å•çš„ä»‹ç»</b></p><p>&emsp;<a href="https://baike.baidu.com/item/Redis/6549233?fr=aladdin" target="_blank" rel="noopener">Redis</a>æ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨<a href="https://baike.baidu.com/item/c%E8%AF%AD%E8%A8%80/105958?fr=aladdin" target="_blank" rel="noopener">ANSI Cè¯­è¨€</a>ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚<br>&emsp;<a href="https://www.php.net/manual/zh/book.mysqli.php" target="_blank" rel="noopener">MySQLi</a>æ˜¯ä¸€ä¸ªå¼€æºä½¿ç”¨çš„ <a href="https://baike.baidu.com/item/mySQL/471251?fr=aladdin" target="_blank" rel="noopener">MySQL</a>è¿æ¥æ‰©å±•ï¼Œç”¨äºå¯¹æ•°æ®åº“çš„æ“ä½œå’Œç®¡ç†ã€‚<br>&emsp;<a href="http://pecl.php.net/package/redis" target="_blank" rel="noopener">php-redis</a>æ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„phpæ‰©å±•ï¼Œç”¨äºphpè¿æ¥ã€ç®¡ç†redisã€‚<br><a id="more"></a><br><b>äºŒã€ä¸šåŠ¡ä»‹ç»</b></p><p>&emsp;æŸå•†åŸæä¿ƒé”€æ´»åŠ¨ï¼Œä¼šæœ‰å¤§é‡çš„è®¢å•æ¶Œå…¥æ•°æ®åº“ï¼Œæ¯ä¸ªè®¢å•15åˆ†é’Ÿæœªæ”¯ä»˜å³ä¸ºè¿‡æœŸè®¢å•å¹¶ä¸”ä¸èƒ½ç»§ç»­æ”¯ä»˜ã€‚</p><p><b>äºŒã€éœ€æ±‚åˆ†æ</b></p><p>&emsp;å¾ˆæ˜¾ç„¶æ­¤ä¸šåŠ¡éœ€æ±‚åœ¨ä¸ä½¿ç”¨redisé˜Ÿåˆ—çš„æƒ…å†µä¸‹ï¼Œå¤§é‡çš„è®¢å•å¹¶å‘ä¼šé€ æˆé˜»å¡ï¼Œç”šè‡³æœ‰å¯èƒ½è¶…æ—¶ï¼ˆphpé»˜è®¤çš„è¶…æ—¶æ—¶é—´ä¸º30sï¼‰ã€‚</p><p>&emsp;é‚£ä¹ˆå°±ä¼šæœ‰ä»¥ä¸‹æ­¥éª¤ï¼š<br>&emsp;&emsp;ï¼ˆ1ï¼‰ç”¨æˆ·ä¸‹å•åæŠŠæ•°æ®ç›´æ¥å†™å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆlistï¼‰è€Œä¸æ˜¯æ•°æ®åº“ï¼Œå†™å…¥é˜Ÿåˆ—æˆåŠŸå³è¿”å›ç”¨æˆ·æˆåŠŸæ¶ˆæ¯ã€‚<br>&emsp;&emsp;ï¼ˆ2ï¼‰åˆ›å»ºè®¢å•é˜Ÿåˆ—ï¼šå¯åŠ¨è„šæœ¬æ¥å¤„ç†è®¢å•é˜Ÿåˆ—ï¼Œé€ä¸€å†™å…¥æ•°æ®åº“ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªkeyä¸ºè®¢å•å·çš„hashè¿‡æœŸæ—¶é—´ä¸º15åˆ†é’Ÿã€‚<br>&emsp;&emsp;ï¼ˆ3ï¼‰ç”¨æˆ·æ”¯ä»˜æ—¶é¦–å…ˆæ‹¿è¿™ä¸ªè®¢å•å·å»redisé‡ŒæŸ¥æ˜¯å­˜åœ¨ï¼Œå¦‚å­˜åœ¨è®¢å•çŠ¶æ€ä¸ºæ­£å¸¸çŠ¶æ€ï¼Œå¦åˆ™ä¸ºè¿‡æœŸçŠ¶æ€ã€‚<br>&emsp;&emsp;ï¼ˆ4ï¼‰è®¢å•æ”¯ä»˜æˆåŠŸé˜Ÿåˆ—ï¼šæ”¯ä»˜æˆåŠŸåï¼ŒæŠŠè®¢å•æ•°æ®å†™å…¥å¦ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå¹¶å¯åŠ¨è„šæœ¬å¤„ç†è®¢å•çŠ¶æ€éƒ½ä¸ºâ€˜æ”¯ä»˜æˆåŠŸâ€™çš„é˜Ÿåˆ—ï¼ˆå¦‚å‘é€æ¶ˆæ¯ï¼Œä¿®æ”¹è®¢å•çŠ¶æ€ç­‰æ“ä½œï¼‰ã€‚</p><p>&emsp;<a>æ³¨æ„ï¼š</a>è¿™æœŸé—´å¯èƒ½ä¼šå‡ºç°æ•°æ®é‡è¿‡å¤§ï¼Œè®¢å•åˆ›å»ºçš„é˜Ÿåˆ—å°šæœªæ‰§è¡Œå®Œæ¯•ï¼Œè®¢å•æ”¯ä»˜æˆåŠŸåæŸ¥æ‰¾è¯¥è®¢å•å´æœªæ‰¾åˆ°(lpop)ï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠè¿™ä¸ªæœªæ‰¾åˆ°çš„è®¢å•é‡æ–°æ·»åŠ åˆ°é˜Ÿåˆ—çš„æœ€åï¼ˆrpushï¼‰ã€‚</p><p><b>ä¸‰ã€ä»£ç å®ç°</b><br>&emsp;<a>ï¼ˆ1ï¼‰åˆ›å»ºè®¢å•ï¼šcreate_order.php</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &quot;./RedisManager.php&quot;;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * æ¨¡æ‹Ÿä¸‹å•</span><br><span class="line"> */</span><br><span class="line">$post = $_POST;</span><br><span class="line">if (!empty($post)) &#123;</span><br><span class="line">    // å£°æ˜çŠ¶æ€</span><br><span class="line">    $status = 0;</span><br><span class="line">    $msg = &apos;error&apos;;</span><br><span class="line"></span><br><span class="line">    $order = [</span><br><span class="line">        &apos;order_id&apos; =&gt; &apos;HD&apos; . time(),</span><br><span class="line">        &apos;name&apos; =&gt; $post[&apos;name&apos;] . &apos;_&apos; . $post[&apos;id&apos;],</span><br><span class="line">        &apos;price&apos; =&gt; $post[&apos;price&apos;],</span><br><span class="line">        &apos;date&apos; =&gt; date(&apos;Y-m-d H:i:s&apos;)</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    // ç”¨æˆ·ä¸‹å•ä½†æœªæ”¯ä»˜åŠ å…¥é˜Ÿåˆ—ç­‰å¾…æ”¯ä»˜</span><br><span class="line">    return createOrder($order);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * åˆ›å»ºè®¢å• createOrder</span><br><span class="line"> *</span><br><span class="line"> * @return void</span><br><span class="line"> */</span><br><span class="line">function createOrder($order)</span><br><span class="line">&#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        $orderList = &apos;order:temp:list&apos;; // ä¸´æ—¶è®¢å•åˆ—è¡¨</span><br><span class="line">        // æŠŠè®¢å•å†™å…¥é˜Ÿåˆ— å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ä¸€ä¸ª watch_order.php æ¥å¤„ç†è®¢å•æ¶ˆæ¯</span><br><span class="line">        $result = RedisConnect::getRedis()-&gt;lpush($orderList, json_encode($order));</span><br><span class="line"></span><br><span class="line">        // è®°å½•æ—¥å¿—</span><br><span class="line">        if (!$result) &#123;</span><br><span class="line">            createLog(&apos;è®¢å•å†™å…¥é˜Ÿåˆ—å¤±è´¥&apos;, $order);</span><br><span class="line">            returnMsg(&apos;è®¢å•å†™å…¥é˜Ÿåˆ—å¤±è´¥&apos;);</span><br><span class="line">        &#125;</span><br><span class="line">        returnMsg(&apos;ä¸‹å•æˆåŠŸ&apos;, $order);</span><br><span class="line">    &#125; catch (Exception $e) &#123;</span><br><span class="line">        createLog($e-&gt;getMessage(), $order);</span><br><span class="line">        returnMsg($e-&gt;getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * å†™å…¥æ—¥å¿— createLog</span><br><span class="line"> *</span><br><span class="line"> * @param string $msg</span><br><span class="line"> * @param array $data</span><br><span class="line"> * @return void</span><br><span class="line"> */</span><br><span class="line">function createLog(string $msg, array $data = [])</span><br><span class="line">&#123;</span><br><span class="line">    $orderMsg = &apos;order:msg&apos;; // è®¢å•æ¶ˆæ¯</span><br><span class="line">    $data[&apos;errorMsg&apos;] = $msg;</span><br><span class="line">    $data[&apos;errorTime&apos;] = date(&apos;Y-m-d H:i:s&apos;);</span><br><span class="line"></span><br><span class="line">    RedisConnect::getRedis()-&gt;select(1);</span><br><span class="line">    RedisConnect::getRedis()-&gt;lPush($orderMsg, json_encode($data));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * è¾“å‡ºæ¶ˆæ¯ returnMsg</span><br><span class="line"> *</span><br><span class="line"> * @param string $msg</span><br><span class="line"> * @param array $data</span><br><span class="line"> * @return void</span><br><span class="line"> */</span><br><span class="line">function returnMsg(string $msg, array $data = [])</span><br><span class="line">&#123;</span><br><span class="line">    echo json_encode([</span><br><span class="line">        &apos;status&apos; =&gt; 200,</span><br><span class="line">        &apos;message&apos; =&gt; $msg,</span><br><span class="line">        &apos;data&apos; =&gt; $data</span><br><span class="line">    ]);</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>&emsp;<a>ï¼ˆ2ï¼‰è®¢å•å…¥åº“insert_db.phpï¼ˆä»¥å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ï¼‰</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&apos;default_socket_timeout&apos;, -1);</span><br><span class="line">include &apos;./RedisManager.php&apos;;</span><br><span class="line">include &apos;./MysqlManager.php&apos;;</span><br><span class="line"></span><br><span class="line">$orderExpire = &apos;order:temp:list&apos;;</span><br><span class="line">while (true) &#123;</span><br><span class="line">try &#123;</span><br><span class="line">        $orderList = &apos;order:temp:list&apos;; // ä¸´æ—¶è®¢å•åˆ—è¡¨</span><br><span class="line">if (RedisConnect::getRedis()-&gt;lSize($orderList) &lt; 1) &#123;</span><br><span class="line">var_dump(&apos;è®¢å•å·²å¤„ç†å®Œæ¯•&apos;) . &apos;\n&apos;;</span><br><span class="line">sleep(1);</span><br><span class="line">&#125;</span><br><span class="line">// å¤„ç†æ¶ˆæ¯</span><br><span class="line">$order = RedisConnect::getRedis()-&gt;lPop($orderList);</span><br><span class="line"></span><br><span class="line">if ($order) &#123;</span><br><span class="line">$order = json_decode($order, true);</span><br><span class="line">$order_id = $order[&apos;order_id&apos;];</span><br><span class="line">$name = $order[&apos;name&apos;];</span><br><span class="line">$price = $order[&apos;price&apos;];</span><br><span class="line">$sql = &quot;INSERT INTO `order`(`order_id`,`name`,`price`) VALUES(&apos;&#123;$order_id&#125;&apos;,&apos;&#123;$name&#125;&apos;,&#123;$price&#125;)&quot;;</span><br><span class="line">$result = MysqlConnect::getMysql()-&gt;query($sql);</span><br><span class="line"></span><br><span class="line">//ç»™æ¯ä¸€ä¸ªè®¢å•è®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´</span><br><span class="line">$expireResult = RedisConnect::getRedis()-&gt;hMset($orderExpire . &apos;:&apos; . $order[&apos;order_id&apos;], $order);</span><br><span class="line">RedisConnect::getRedis()-&gt;expire($orderExpire . &apos;:&apos; . $order[&apos;order_id&apos;], 900);</span><br><span class="line">var_dump($result) . &apos;\n&apos;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">sleep(1);</span><br><span class="line">&#125;</span><br><span class="line">&#125; catch (Exception $e) &#123;</span><br><span class="line">echo $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>&emsp;<a>ï¼ˆ3ï¼‰ç›‘å¬è¿‡æœŸçš„è®¢å•watch_order.phpï¼ˆä»¥å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ï¼‰</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&apos;default_socket_timeout&apos;, -1);</span><br><span class="line"></span><br><span class="line">include &apos;./RedisManager.php&apos;;</span><br><span class="line">include &apos;./MysqlManager.php&apos;;</span><br><span class="line"></span><br><span class="line">RedisConnect::getRedis()-&gt;psubscribe(array(&apos;__keyevent@0__:expired&apos;), &apos;keyCallback&apos;);</span><br><span class="line"></span><br><span class="line">function keyCallback($redis, $pattern, $channel, $message)</span><br><span class="line">&#123;</span><br><span class="line">    // æŠŠè¿‡æœŸçš„è®¢å•å†™å…¥é˜Ÿåˆ—è¿›è¡Œå¤„ç†ï¼ˆè¿™é‡Œå¯ä»¥å¤„ç†ä¸ºä¸åŒçš„è®¢å•å†™å…¥ä¸åŒçš„é˜Ÿåˆ—ï¼‰</span><br><span class="line">    $msgType = [</span><br><span class="line">        &apos;HD&apos; =&gt; &apos;home:order&apos;, // ä½æˆ¿è®¢å•</span><br><span class="line">        &apos;DD&apos; =&gt; &apos;ding:order&apos; // é¤é¥®è®¢å•</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    $keyArr = explode(&apos;:&apos;, $message);</span><br><span class="line">    $key = array_pop($keyArr);</span><br><span class="line">    $id = substr($key, 0, 2);</span><br><span class="line">    switch($id)&#123;</span><br><span class="line">        case &apos;HD&apos;:</span><br><span class="line">            $sql = &quot;UPDATE `order` SET `status` = 1 WHERE `order_id` = &apos;&#123;$key&#125;&apos;&quot;;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    $result = MysqlConnect::getMysql()-&gt;query($sql);</span><br><span class="line">    var_dump($result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>&emsp;<a>ï¼ˆ4ï¼‰æ”¯ä»˜æˆåŠŸåçš„è®¢å•å¤„ç†success_order.phpï¼ˆä»¥å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ï¼‰</a><br>&emsp;&emsp;ä»£ç ä¸Šè¾¹ä»£ç ä¸€æ ·ä¸åšå±•ç¤ºã€‚</p><p>&emsp;<a>ï¼ˆ5ï¼‰å¦å¤–å¯å¢åŠ æ—¥å¿—é˜Ÿåˆ—å¤„ç†æ¥å‘é€é”™è¯¯é‚®ä»¶ç»™ç®¡ç†å‘˜send_error_mail.phpï¼ˆä»¥å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ï¼‰</a><br>&emsp;&emsp;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“</p><p><b>å››ã€æ€»ç»“</b></p><p>&emsp;æœ¬æ–‡åªæ˜¯åšä¸šåŠ¡åˆ†æï¼Œæœªåœ¨çœŸå®çš„ä¸šåŠ¡åœºæ™¯ä¸­è¿›è¡Œå®ç°ï¼Œå¦‚æœ‰é”™è¯¯è¿˜è¯·å¤šå¤šæŒ‡æ­£ã€‚<br>&emsp;ä¸‹ä¸€ç¯‡å¯èƒ½ä¼šå†™åˆ©ç”¨<a href>Jmeter</a>æ¥åˆ†æè¯¥ä¸šåŠ¡ä»£ç çš„æ•ˆç‡æ€§èƒ½ç­‰é—®é¢˜ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³nginxå¾ªç¯é‡å®šå‘é—®é¢˜</title>
      <link href="/%E8%A7%A3%E5%86%B3nginx%E5%BE%AA%E7%8E%AF%E9%87%8D%E5%AE%9A%E5%90%91%E9%97%AE%E9%A2%98/"/>
      <url>/%E8%A7%A3%E5%86%B3nginx%E5%BE%AA%E7%8E%AF%E9%87%8D%E5%AE%9A%E5%90%91%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p><b>ä¸€ã€ä»€ä¹ˆæ˜¯é‡å®šå‘ã€å¾ªç¯é‡å®šå‘</b></p><p>&emsp;ï¼ˆ1ï¼‰é‡å®šå‘æ˜¯æŒ‡æµè§ˆå™¨å…ˆè®¿é—®äº†æœåŠ¡å™¨Aï¼Œç„¶åæœåŠ¡å™¨Aå¸¦ç€è¯·æ±‚çš„å‚æ•°ï¼ˆheaderã€çŠ¶æ€ç 3xxï¼‰è¿”å›åˆ°åœ°å€ä¸ºBçš„æœåŠ¡å™¨ä¸Šã€‚<br>&emsp;ï¼ˆ2ï¼‰å¾ªç¯é‡å®šå‘æ˜¯æŒ‡æœåŠ¡å™¨Aé‡å®šå‘åˆ°äº†æœåŠ¡å™¨Bï¼ŒæœåŠ¡å™¨Bç”±äºæŸç§åŸå› åˆé‡å®šå‘åˆ°äº†Aï¼Œè¿™æ ·å°±æ„æˆäº†é‡å®šå‘å¾ªç¯ã€‚</p><p><b>äºŒã€3xxé‡å®šå‘çŠ¶æ€ç </b></p><p>&emsp;ï¼ˆ1ï¼‰301(Move Permanently)ï¼šæ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„URIï¼Œä»¥åéƒ½ä½¿ç”¨è¿™ä¸ªï¼ˆgetï¼‰ã€‚<br>&emsp;ï¼ˆ2ï¼‰302(Found)ï¼šä¸´æ—¶æ€§é‡å®šå‘ï¼Œè¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„URIï¼Œæœ¬æ¬¡ä½¿ç”¨è¿™ä¸ªï¼ˆgetï¼Œå…è®¸ç¼“å­˜ï¼‰ã€‚<br>&emsp;ï¼ˆ3ï¼‰303(See Other)ï¼šè¯·æ±‚èµ„æºå­˜åœ¨å¦ä¸€ä¸ªURIï¼Œåº”ä½¿ç”¨getæ–¹æ³•è·å–è¯·æ±‚èµ„æºã€‚<br>&emsp;ï¼ˆ4ï¼‰307(Temporary Redirect)ï¼šç±»ä¼¼äº302ï¼Œåªæ˜¯302çš„POSTæ–¹æ³•ä¼šå˜ä¸ºGETï¼Œè€Œ307çš„ä¸ä¼šã€‚<br><a id="more"></a><br><b>ä¸‰ã€æ€ä¹ˆäº§ç”Ÿçš„ï¼Ÿ</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  www.daichongweb.cn;</span><br><span class="line"></span><br><span class="line">    root   /site/hexo/public;</span><br><span class="line">    index  index.html;</span><br><span class="line"></span><br><span class="line">    # è¿™æ®µæ˜¯äº§ç”Ÿå¾ªç¯é‡å®šå‘çš„åŸå› </span><br><span class="line">    # å½“æµè§ˆå™¨è®¿é—® www.daichongweb.cn æ—¶å‘ç°ä¸æ˜¯httpså°±ä¼šè¿›è¡Œé‡å®šå‘ï¼Œ</span><br><span class="line">    # ä½†é‡å®šå‘åˆ°httpsä¹‹ååˆæ²¡æœ‰åˆ¤æ–­æ˜¯å¦æ˜¯httpsï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ç¦æ­¢è·³è½¬ï¼Œæœ€ç»ˆé€ æˆäº†å¾ªç¯</span><br><span class="line">    return  301 https://$host$request_uri;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><b>å››ã€æ€ä¹ˆè§£å†³ï¼Ÿ</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  www.daichongweb.cn;</span><br><span class="line"></span><br><span class="line">    root   /site/hexo/public;</span><br><span class="line">    index  index.html;</span><br><span class="line"></span><br><span class="line">    # é€šè¿‡ä¸Šé¢çš„è§£é‡Šé€»è¾‘å°±å˜å¾—ç›¸å¯¹ç®€å•äº†ï¼Œåªéœ€è¦å¢åŠ ä¸€ä¸ªåˆ¤æ–­å°±å¯ä»¥è§£å†³</span><br><span class="line">    if ($scheme = http) &#123;</span><br><span class="line">        return 301 https://$host$request_uri;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><b>å››ã€æ€»ç»“</b></p><p>&emsp;åœ¨é¡¹ç›®å¼€å‘ä¸­ç»å¸¸ä¼šç”¨åˆ°é‡å®šå‘ï¼Œè®¤è¯†æ¯”è¾ƒå¸¸è§çš„çŠ¶æ€ç å¯¹ç½‘ç»œè¯·æ±‚çš„åˆ¤æ–­åˆå¾ˆå¤§å¸®åŠ©ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos7.6æ­å»ºlnmpç¯å¢ƒ</title>
      <link href="/Centos7.6%E6%90%AD%E5%BB%BAlnmp%E7%8E%AF%E5%A2%83/"/>
      <url>/Centos7.6%E6%90%AD%E5%BB%BAlnmp%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<p><b>ä¸€ã€å‰è¨€</b></p><p>&emsp;æ­å»ºç¨‹åºè¿è¡Œç¯å¢ƒæ˜¯ç¨‹åºå‘˜å¿…ä¸å¯å°‘çš„æŠ€èƒ½ï¼<br>&emsp;ä»Šå¤©ä¹°äº†ä¸ªæ–°çš„äº‘æœåŠ¡å™¨ï¼Œéœ€è¦æ­å»ºç¯å¢ƒï¼Œå€Ÿæ­¤æœºä¼šè‡ªå·±ä¹Ÿç†Ÿæ‚‰äº†ä¸€ç•ªæ­å»ºçš„æµç¨‹ï¼Œåšä¸ªæ—¥è®°ä¾›ä»¥åå‚è€ƒã€‚<br>&emsp;æœ¬ç¯‡å¤§éƒ¨åˆ†å‘½ä»¤ä»…é€‚åˆ<font color="#ff5722">Centos7.x</font>çš„ç³»ç»Ÿä½¿ç”¨ã€‚<br>&emsp;<font color="#ff5722">lnmp</font>æ˜¯æŒ‡<font color="#ff5722">Liunxã€Nginxã€Mysqlå’ŒPhp</font>ã€‚</p><p>&emsp;ç›®å½•ï¼š<br>&emsp;ï¼ˆ1ï¼‰å®‰è£…<font color="#ff5722">Nginx1.4</font>ã€‚<br>&emsp;ï¼ˆ2ï¼‰å®‰è£…<font color="#ff5722">php7.2</font>ã€‚<br>&emsp;ï¼ˆ3ï¼‰å®‰è£…<font color="#ff5722">Mariadb10.2</font>ã€‚<br>&emsp;ï¼ˆ4ï¼‰æ€»ç»“ã€‚<br><a id="more"></a></p><p><b>äºŒã€å®‰è£…Nginx</b></p><p>&emsp;ï¼ˆ1ï¼‰é˜²ç«å¢™è®¾ç½®ï¼Œå…è®¸httpã€httpsé€šä¿¡ã€å¼€å¯80ã€443ã€8080ç­‰ç«¯å£ï¼ˆå·²å¼€å¯çš„å¿½ç•¥æ­¤æ­¥éª¤ï¼‰ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// å…è®¸httpé€šä¿¡</span><br><span class="line">firewall-cmd --zone=public --add-service=http --permanent</span><br><span class="line">// å…è®¸httpsé€šä¿¡</span><br><span class="line">firewall-cmd --zone=public --add-service=https --permanent</span><br><span class="line">// æ‰“å¼€80ç«¯å£</span><br><span class="line">firewall-cmd --zone-public â€“add-port=80/tcp --permanent </span><br><span class="line">// æ‰“å¼€443ç«¯å£</span><br><span class="line">firewall-cmd --zone-public â€“add-port=443/tcp --permanent </span><br><span class="line">// æ‰“å¼€8080ç«¯å£</span><br><span class="line">firewall-cmd --zone-public â€“add-port=8080/tcp --permanent </span><br><span class="line">// é‡æ–°åŠ è½½é…ç½®</span><br><span class="line">firewall-cmd --reload </span><br></pre></td></tr></table></figure><br>&emsp;ï¼ˆ2ï¼‰ä¸‹è½½ä¾èµ–<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum intall pcre pcre-devel yum install pcre pcre-devel yum install zlib zlib-devel yum install openssl; openssl-devel yum install openssl;openssl-devel yum install openssl openssl-devel</span><br></pre></td></tr></table></figure><br>&emsp;ï¼ˆ3ï¼‰é…ç½®å®˜æ–¹yumæº&amp;å®‰è£…Nginx<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</span><br><span class="line"></span><br><span class="line">yum install nginx</span><br><span class="line"></span><br><span class="line"># é»˜è®¤ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf.d</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨&amp;åœæ­¢</span><br><span class="line">systemctl start/stop nginx.service</span><br><span class="line"># æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¯åŠ¨</span><br><span class="line">ps aux|grep nginx</span><br><span class="line"># è®¾ç½®æœåŠ¡å¼€æœºè‡ªå¯</span><br><span class="line">systemctl enable nginx</span><br></pre></td></tr></table></figure></p><p><font color="#ff5722">æ³¨æ„ï¼š</font>å®‰è£…æˆåŠŸåæ— æ³•è®¿é—®ï¼Œè¯·æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼Œæˆ–åœ¨æœåŠ¡å•†åå°é…ç½®å®‰å…¨ç»„ç­–ç•¥ç­‰ã€‚</p><p><b>äºŒã€å®‰è£…php</b></p><p>&emsp;ï¼ˆ1ï¼‰é…ç½®yumæº<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><br><span class="line">rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span><br></pre></td></tr></table></figure><br>&emsp;ï¼ˆ2ï¼‰å®‰è£…php7.2åŠå¸¸ç”¨çš„æ‰©å±•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install php72w php72w-cli php72w-common php72w-devel php72w-embedded php72w-fpm php72w-gd php72w-mbstring php72w-mysqlnd php72w-opcache php72w-pdo php72w-xml</span><br></pre></td></tr></table></figure><br>&emsp;ï¼ˆ3ï¼‰å¯åŠ¨php-fpm<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop/start php-fpm</span><br><span class="line"># è®¾ç½®å¼€æœºå¯åŠ¨</span><br><span class="line">systemctl enable php-fpm</span><br></pre></td></tr></table></figure><br>&emsp;ï¼ˆ4ï¼‰é…ç½®nginxæ”¯æŒphp<br><figure class="highlight plain"><figcaption><span>bash</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/nginx/conf.d/default.conf</span><br><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line">    root   /usr/share/nginx/html; //è¿™æ˜¯é‡Œåº”ç”¨ç›®å½•å’Œä¸‹é¢çš„rootå¯¹åº”ï¼Œå¯è‡ªå®šä¹‰</span><br><span class="line">    index  index.html index.htm index.php;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location ~ \.php$ &#123;</span><br><span class="line">    root           /usr/share/nginx/html;</span><br><span class="line">    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">    fastcgi_index  index.php;</span><br><span class="line">    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">    fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">    include        fastcgi_params;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><b>ä¸‰ã€å®‰è£…mariadb10.2</b></p><p>&emsp;ï¼ˆ1ï¼‰é…ç½®yumæº<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># è¿›å…¥</span><br><span class="line">cd /usr/local/src</span><br><span class="line"># ä¸‹è½½rpmåŒ…</span><br><span class="line">wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"># å®‰è£…rpm</span><br><span class="line">rpm -ivh mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line"># å®‰è£… mysql-server</span><br><span class="line">yum install -y mysql-server</span><br><span class="line"># å¯åŠ¨ </span><br><span class="line">systemctl start mysqld</span><br><span class="line"># è®¾ç½®å¼€æœºè‡ªå¯</span><br><span class="line">systemctl enable mysqld</span><br></pre></td></tr></table></figure></p><p>&emsp;ï¼ˆ2ï¼‰ç™»å…¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># ç”±äºMySQLä»5.7å¼€å§‹ä¸å…è®¸é¦–æ¬¡å®‰è£…åï¼Œä½¿ç”¨ç©ºå¯†ç è¿›è¡Œç™»å½•ï¼Œç³»ç»Ÿä¼šéšæœºç”Ÿæˆä¸€ä¸ªå¯†ç ä»¥ä¾›ç®¡ç†å‘˜é¦–æ¬¡ç™»å½•ä½¿ç”¨ï¼Œè¿™ä¸ªå¯†ç è®°å½•åœ¨/var/log/mysqld.logæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ­¤å¯†ç ï¼š</span><br><span class="line">cat /var/log/mysqld.log|grep &apos;A temporary password&apos;</span><br><span class="line"># ç™»å½•</span><br><span class="line">mysql -u root -p</span><br><span class="line"># å¦‚æŠ¥é”™ You must reset your password using ALTER USER statement before executing this statement</span><br><span class="line">ä¿®æ”¹å¯†ç </span><br><span class="line">use mysql;</span><br><span class="line">SET PASSWORD = PASSWORD(&apos;daichongweb&apos;); </span><br><span class="line">æˆ– </span><br><span class="line">ALTER USER USER() IDENTIFIED BY &apos;daichongweb&apos;;</span><br><span class="line"></span><br><span class="line"># å¦‚æŠ¥é”™Your password does not satisfy the current policy requirements</span><br><span class="line">set global validate_password_policy=0; //ä¿®æ”¹å¯†ç éªŒè¯ä¸ºé•¿åº¦éªŒè¯</span><br></pre></td></tr></table></figure></p><p><b>å››ã€æ€»ç»“</b></p><p>&emsp;æ€»ä½“æ¥è¯´ä½¿ç”¨yumå®‰è£…æ¯”æºç ç¼–è¯‘å®‰è£…ç®€å•å¤šäº†ã€‚<br>&emsp;å†å¤šçš„ç†è®ºä¸å¦‚çœŸæ­£çš„å®è·µã€‚<br>&emsp;ä»å‡ºç°é—®é¢˜ï¼Œåˆ°åˆ†æé—®é¢˜ï¼Œå†åˆ°è§£å†³é—®é¢˜ï¼Œä½ ä¼šä»ä¸­å­¦ä¹ åˆ°å¾ˆå¤šçš„çŸ¥è¯†ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å°±ç®—èŠ±é’±ä¹Ÿè¦ä¹°äº‘æœåŠ¡å™¨çš„åŸå› ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpæ€§èƒ½ä¼˜åŒ–-å¾ªç¯ä¼˜åŒ–</title>
      <link href="/php%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E5%BE%AA%E7%8E%AF%E4%BC%98%E5%8C%96/"/>
      <url>/php%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E5%BE%AA%E7%8E%AF%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p><b>ä¸€ã€å‰è¨€</b></p><p>&emsp;å¯¹äºä»»ä½•è®¡ç®—æœºç¨‹åºï¼Œç¨‹åºçš„è¿è¡Œæ€§èƒ½å†³å®šäº†ä¸€ä¸ªç¨‹åºçš„å¥½åï¼Œå¤¸å¼ ä¸€ç‚¹è¯´ç¨‹åºæ€§èƒ½çš„å¥½åç›´æ¥å½±å“äº†ä¸€ä¸ªäº’è”ç½‘å…¬å¸çš„ç”Ÿå­˜ä¸å‘å±•çš„é—®é¢˜ã€‚æ‰€ä»¥å¯¹äºç¨‹åºå‘˜ï¼Œä¼˜åŒ–æ€§èƒ½çš„æŠ€èƒ½æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå°±å› ä¸ºä¸ä¼šä¼˜åŒ–æ€§èƒ½ï¼Œå¯èƒ½å°±ä¼šæ¯”å…¶ä»–äººå·®å¥½å‡ ä¸ªç­‰çº§ã€‚</p><p>&emsp;åœ¨PHPç•Œï¼Œå¤§éƒ¨åˆ†äº’è”ç½‘å…¬å¸çš„å·¥ä½œå†…å®¹å°±æ˜¯æœ€å¸¸è§çš„CURDã€‚ä½ ä¼šå‘ç°è‡ªå·±å’Œä¸€äº›åº”å±Šæ¯•ä¸šç”Ÿç›¸æ¯”å®Œå…¨æ²¡æœ‰ç«äº‰ä¼˜åŠ¿ï¼Œç”šè‡³ä¸€äº›å…¬å¸çš„å²—ä½è¦æ±‚ä¹Ÿåªæ˜¯ä¼šCURDå°±è¡Œäº†ã€‚å°±åƒæˆ‘æœ€è¿‘æ‰¾å·¥ä½œï¼Œä¸æ­¢ä¸€æ¬¡çš„é‡åˆ°é¢è¯•å®˜é—®ï¼šâ€œæˆ‘ä½ è§‰å¾—ä½ çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿâ€ï¼Œæˆ‘æ¯æ¬¡éƒ½æ˜¯å“‘å£æ— è¨€ã€‚<br><a id="more"></a><br>&emsp;å¤§å®¶éƒ½æ‡‚ä¸ºäº†é¿å…è¿™æ ·çš„å‡ºç°ï¼Œå­¦äº†å¾ˆå¤šç§è¯­è¨€ã€‚é€ æˆç°åœ¨PHPå²—ä½çš„è¦æ±‚ä»åªä¼šPHPè¯­è¨€åˆ°<font color="#ff5722">PHP+MYSQL+LIUNX+HTNL+CSS+JS</font>,ç”šè‡³æˆ‘å¯¹é¢è¯•å®˜è¯´ï¼šâ€œæˆ‘çš„ä¼˜åŠ¿æ˜¯æ¯”å…¶ä»–äººä¼šçš„è¯­è¨€å¤šï¼â€çš„æ—¶å€™ï¼Œä»–ä¼šå›ä½ ä¸€å¥ï¼šâ€œè¿™ä¸æ˜¯å¤§å®¶éƒ½ä¼šçš„å—ï¼Ÿâ€ã€‚</p><p>&emsp;æ›´ææ€–çš„æ˜¯ï¼Œç°åœ¨çš„PHæ‹›è˜è¦æ±‚ä¸Šéƒ½TMå¼€å§‹å†™è¦æ±‚ç†Ÿæ‚‰<font color="#ff5722">JAVAã€Pythonã€Goã€Golang</font>ï¼Œä½ TMèƒ½å†è¿‡åˆ†ç‚¹å—ï¼Ÿ</p><p><b>äºŒã€è¨€å½’æ­£ä¼ </b></p><p>&emsp;åœ¨PHPä¸­æœ€å¸¸è§çš„å°±æ˜¯foreachï¼Œå¤„ç†æ•°æ®äº¤é™…çš„æ—¶å€™ä¸€èˆ¬ç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„éƒ½æ˜¯åµŒå¥—ã€‚</p><p>&emsp;åœ¨è¿™æˆ‘åªèƒ½è¯´å°½é‡å°‘ç”¨æˆ–è€…ä¸ä½¿ç”¨è¿™æ ·çš„å†™æ³•ã€‚</p><p>&emsp;ä¸‹é¢ä»‹ç»3ç§å¯ä»¥ä»£æ›¿å¾ªç¯åµŒå¥—å†™æ³•ä¾‹å­ï¼Œå¹¶åˆ†ææ‰§è¡Œçš„æ•ˆç‡å’Œæ€§èƒ½é—®é¢˜ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">ini_set(&apos;memory_limit&apos;,&apos;3072M&apos;);</span><br><span class="line"></span><br><span class="line">$arr = [];</span><br><span class="line">$arr1 = [];</span><br><span class="line"></span><br><span class="line">for($i=1;$i&lt;=1000000;$i++)&#123;</span><br><span class="line">$arr[$i] = [</span><br><span class="line">&apos;id&apos; =&gt; ($i+1)*2,</span><br><span class="line">&apos;name&apos; =&gt; &apos;æˆ´å´‡_&apos;.$i</span><br><span class="line">];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for($j=1;$j&lt;=1000000;$j++)&#123;</span><br><span class="line">$arr1[$j] = [</span><br><span class="line">&apos;uid&apos; =&gt;($j+1)*2,</span><br><span class="line">&apos;age&apos; =&gt; $j</span><br><span class="line">];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$t1 = microtime(true);</span><br><span class="line"></span><br><span class="line">$mode = mode1($arr,$arr1);</span><br><span class="line"></span><br><span class="line">echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">$t2 = microtime(true);</span><br><span class="line">echo $mode . &apos;è€—æ—¶: &apos;.round($t2-$t1,3).&apos; ç§’&lt;br /&gt;&apos;;</span><br><span class="line">echo &apos;å†…å­˜æ¶ˆè€—: &apos; . memory_get_usage() / 1024 / 1024 . &apos; MB&lt;br /&gt;&apos;;</span><br><span class="line"></span><br><span class="line">// å¾ªç¯åµŒå¥—</span><br><span class="line">function mode($arr,$arr1)&#123;</span><br><span class="line"></span><br><span class="line">foreach ($arr as $k =&gt; $v) &#123;</span><br><span class="line">foreach ($arr1 as $key =&gt; $value) &#123;</span><br><span class="line">if($v[&apos;id&apos;] == $value[&apos;uid&apos;])&#123;</span><br><span class="line">$arr[$k][&apos;age&apos;] = $value[&apos;age&apos;];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return &apos;æ–¹æ³•ä¸€-&gt;å¾ªç¯åµŒå¥—æ³•-&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¾ªç¯æ‹†åˆ†</span><br><span class="line">function mode1($arr,$arr1)&#123;</span><br><span class="line">$arr1 = array_index($arr1,&apos;uid&apos;);</span><br><span class="line"></span><br><span class="line">foreach ($arr as &amp;$value) &#123;</span><br><span class="line">if(isset($arr1[$value[&apos;id&apos;]]))&#123;</span><br><span class="line">$value[&apos;age&apos;] = $arr1[$value[&apos;id&apos;]][&apos;age&apos;];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return &apos;æ–¹æ³•äºŒ-&gt;å¾ªç¯æ‹†åˆ†-&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// array_walk é—­åŒ…</span><br><span class="line">function mode2($arr,$arr1)&#123;</span><br><span class="line"></span><br><span class="line">$arr1 = array_index($arr1,&apos;uid&apos;);</span><br><span class="line"></span><br><span class="line">array_walk($arr, function(&amp;$value,$key) use ($arr1) &#123;</span><br><span class="line">if(isset($arr1[$value[&apos;id&apos;]]))&#123;</span><br><span class="line">$value[&apos;age&apos;] = $arr1[$value[&apos;id&apos;]][&apos;age&apos;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">return &apos;æ–¹æ³•äºŒ-&gt;array_walk é—­åŒ…-&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// array_map</span><br><span class="line"></span><br><span class="line">function mode3($arr,$arr1)&#123;</span><br><span class="line"></span><br><span class="line">$arr1 = array_index($arr1,&apos;uid&apos;);</span><br><span class="line"></span><br><span class="line">$arr = array_map(function(&amp;$value) use ($arr1) &#123;</span><br><span class="line">if(isset($arr1[$value[&apos;id&apos;]]))&#123;</span><br><span class="line">$value[&apos;age&apos;] = $arr1[$value[&apos;id&apos;]][&apos;age&apos;];</span><br><span class="line">&#125;</span><br><span class="line">return $value;</span><br><span class="line">&#125;, $arr);</span><br><span class="line"></span><br><span class="line">return &apos;æ–¹æ³•ä¸‰-&gt;array_map-&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æŠŠå¤šç»´æ•°ç»„ä¸­çš„æŸä¸ªé”®å€¼è®¾ç½®ä¸ºé”®å</span><br><span class="line">function array_index(array $array, $name)</span><br><span class="line">&#123;</span><br><span class="line">    $indexedArray = array();</span><br><span class="line">    if (empty($array)) &#123;</span><br><span class="line">        return $indexedArray;</span><br><span class="line">    &#125;</span><br><span class="line">    foreach ($array as $item) &#123;</span><br><span class="line">        if (isset($item[$name])) &#123;</span><br><span class="line">            $indexedArray[$item[$name]] = $item;</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return $indexedArray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;ç»è¿‡è¯•éªŒçš„åˆ°ç»“æœï¼š</p><p>&emsp;&emsp;(1)æ–¹æ³•ä¸€ï¼š10000*10000ï¼ˆä¸‡çº§ï¼‰ æ‰§è¡Œæ—¶é—´ <font color="#ff5722">3.377 ç§’</font></p><p>&emsp;&emsp;(2)æ–¹æ³•äºŒï¼š1000000*1000000ï¼ˆç™¾ä¸‡çº§ï¼‰ æ‰§è¡Œæ—¶é—´ï¼š <font color="#ff5722">0.741 ç§’ 0.642 ç§’ 0.673 ç§’ 0.609 ç§’ 0.618 ç§’</font></p><p>&emsp;&emsp;(3)æ–¹æ³•ä¸‰ï¼š1000000*1000000ï¼ˆç™¾ä¸‡çº§ï¼‰ æ‰§è¡Œæ—¶é—´ï¼š <font color="#ff5722">0.745 ç§’ 0.75 ç§’ 0.664 ç§’ 0.672 ç§’ 0.684 ç§’</font></p><p>&emsp;&emsp;(4)æ–¹æ³•å››ï¼š1000000*1000000ï¼ˆç™¾ä¸‡çº§ï¼‰ æ‰§è¡Œæ—¶é—´ï¼š <font color="#ff5722">0.781 ç§’ 0.803 ç§’ 0.661 ç§’ 0.661 ç§’ 0.658 ç§’</font></p><p><b>ä¸‰ã€æ€»ç»“</b></p><p>&emsp;åœ¨å¼€å‘ä¸­ä¸€å®šè¦è€ƒè™‘æ•°æ®é‡å¤§çš„æƒ…å†µä¸‹ä¼šå‡ºç°çš„é—®é¢˜ï¼Œå°½é‡ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•ä»£æ›¿å¾ªç¯åµŒå¥—ã€‚å¦å¤–è¿˜è¦æ³¨æ„ä»£ç é£æ ¼å’Œè§„èŒƒç­‰é—®é¢˜ã€‚</p><p>&emsp;å¸Œæœ›å¤§å®¶åœ¨çœ‹äº†ä¹‹åèƒ½æœ‰æ‰€æ”¶è·ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå¤„ç†è§†é¢‘</title>
      <link href="/php%E5%A4%84%E7%90%86%E8%A7%86%E9%A2%91/"/>
      <url>/php%E5%A4%84%E7%90%86%E8%A7%86%E9%A2%91/</url>
      
        <content type="html"><![CDATA[<p><b>ä¸€ã€é¦–å…ˆä»‹ç»ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½çš„ä½¿ç”¨åœºæ™¯</b></p><p>&emsp;å¦‚<a href="https://www.youku.com/" target="_blank" rel="noopener">ä¼˜é…·</a>è§†é¢‘ç½‘ç«™ï¼ŒæŸäº›è§†é¢‘çš„å°é¢å›¾å°±ä½¿ç”¨çš„è¿™æ ·çš„åŠŸèƒ½ã€‚</p><p>&emsp;å¤§æ¦‚æœ‰4ç§ï¼š</p><p>&emsp;&emsp;(1)è‡ªæœ‰å°é¢å›¾ï¼ˆè¿™ç±»å¯èƒ½æ˜¯è‡ªå·±æ‰‹åŠ¨ä¸Šä¼ çš„å°é¢å›¾ï¼Œå¦‚ä¸€äº›å®£ä¼ å›¾ï¼‰ã€‚<br>&emsp;&emsp;(2)æˆªå–è§†é¢‘ç¬¬ä¸€å¸§ï¼ˆå¯ä»¥ç†è§£ä¸º0.001ç§’ï¼‰æ—¶çš„è§†é¢‘å†…å®¹ä½œä¸ºå°é¢å›¾ã€‚<br>&emsp;&emsp;(3)æˆªå–è§†é¢‘æŸä¸€æ—¶åˆ»çš„å†…å®¹ä½œä¸ºå°é¢å›¾ï¼Œå¦‚æˆªå–è§†é¢‘çš„ç¬¬1åˆ†é’Ÿã€‚<br>&emsp;&emsp;(4)æˆªå–è§†é¢‘æŸä¸€æ®µçš„å†…å®¹ï¼ˆgifï¼‰ä½œä¸ºå°é¢å›¾ï¼Œå¦‚æˆªå–è§†é¢‘çš„ç¬¬1åˆ†20ç§’åˆ°1åˆ†30ç§’ã€‚</p><font color="#ff5722">PS:</font>åªæ˜¯å•çº¯çš„æ‹¿æ¥åšä¾‹å­ï¼Œå¹¶ä¸æ˜¯æŒ‡ä¼˜é…·å°±æ˜¯ä½¿ç”¨è¿™æ ·çš„æŠ€æœ¯ã€‚<br><a id="more"></a><br><b>äºŒã€å°†ä¼šä½¿ç”¨åˆ°çš„æŠ€æœ¯</b><br><br>&emsp;(1)<a href="http://ffmpeg.org/" target="_blank" rel="noopener">FFmpeg</a>ï¼šFFmpegæ˜¯ä¸€å¥—å¯ä»¥ç”¨æ¥è®°å½•ã€è½¬æ¢æ•°å­—éŸ³é¢‘ã€è§†é¢‘ï¼Œå¹¶èƒ½å°†å…¶è½¬åŒ–ä¸ºæµçš„å¼€æºè®¡ç®—æœºç¨‹åºã€‚é‡‡ç”¨LGPLæˆ–GPLè®¸å¯è¯ã€‚å®ƒæä¾›äº†å½•åˆ¶ã€è½¬æ¢ä»¥åŠæµåŒ–éŸ³è§†é¢‘çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚å®ƒåŒ…å«äº†éå¸¸å…ˆè¿›çš„éŸ³é¢‘/è§†é¢‘ç¼–è§£ç åº“libavcodecï¼Œä¸ºäº†ä¿è¯é«˜å¯ç§»æ¤æ€§å’Œç¼–è§£ç è´¨é‡ï¼Œlibavcodecé‡Œå¾ˆå¤šcodeéƒ½æ˜¯ä»å¤´å¼€å‘çš„ã€‚<em>â€”ç™¾åº¦ç™¾ç§‘</em>&emsp; <font color="#ff5722">æ³¨æ„:â€˜éœ€è¦å®‰è£…â€™ï¼Œä¸åŒçš„ç³»ç»Ÿå®‰è£…ã€ä½¿ç”¨çš„æ–¹æ³•ä¸åŒã€‚</font><p>&emsp;(2)<a href="https://www.php.net/" target="_blank" rel="noopener">PHP</a>çš„<a href="https://www.php.net/manual/zh/book.exec.php" target="_blank" rel="noopener">Exec</a>æˆ–<a href="https://www.php.net/manual/zh/function.system.php" target="_blank" rel="noopener">System</a>ç­‰å‡½æ•°ï¼ˆå½“ç„¶ä»»ä½•èƒ½æ‰§è¡Œå¤–éƒ¨ç¨‹åºçš„è¯­è¨€éƒ½èƒ½å®ç°ï¼‰ã€‚</p><p><b>ä¸‰ã€Demo</b></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// å®‰è£…è·¯å¾„</span><br><span class="line">$ffmpeg = &quot;C:\\Users\user\\Desktop\\ffmpeg\\bin\\ffmpeg.exe&quot;;</span><br><span class="line">// å¾…å¤„ç†è§†é¢‘çš„åœ°å€</span><br><span class="line">$video_route = &quot;D:\\phpstudy_pro\\WWW\a.mp4&quot;;</span><br><span class="line">//å­˜å‚¨åœ°å€</span><br><span class="line">$store_path = &quot;./2.jpg&quot;;</span><br><span class="line"></span><br><span class="line">// æŠŠè§†é¢‘çš„å‰30å¸§æˆªå–ä¸ºgif</span><br><span class="line">system($ffmpeg . &quot; -i &quot;.$video_route.&quot; -vframes 30 -y -f gif 1.gif&quot;); </span><br><span class="line">// æŠŠè§†é¢‘çš„ç¬¬ä¸€å¸§æˆªå–ä¸ºå›¾ç‰‡ -r 1 è¡¨ç¤ºä¸ºå›¾å®½åº¦ã€é«˜åº¦è‡ªé€‚åº”</span><br><span class="line">system($ffmpeg . &quot; -i &quot;.$video_route.&quot; -y -f image2 -t 0.001 -r 1 1.png&quot;); </span><br><span class="line">// æŠŠè§†é¢‘çš„ç¬¬8.01ç§’å¤„æˆªå–ä¸ºå›¾ç‰‡</span><br><span class="line">system($ffmpeg . &quot; -i &quot;.$video_route.&quot; -y -f image2 -ss 08.010 -t 0.001 -s 1920x1080 &quot; .$store_path. &quot;); </span><br></pre></td></tr></table></figure><p><b>ä¸‰ã€æ›´å¤š</b></p><p>&emsp;<a href="https://www.php.net/" target="_blank" rel="noopener">PHP</a>+<a href="http://ffmpeg.org/" target="_blank" rel="noopener">FFmpeg</a>ä»…èƒ½å®ç°è¿™æ ·åŠŸèƒ½å—ï¼Ÿå½“ç„¶ä¸æ˜¯ï¼è¿˜æœ‰æ›´å¤šçš„åŠŸèƒ½ç­‰å¾…æ¢ç´¢â€¦<br>&emsp;å¦‚:<br>&emsp;&emsp;(1)è§†é¢‘è½¬ç ã€‚<br>&emsp;&emsp;(2)è§†é¢‘åŠ å¯†ã€‚<br>&emsp;&emsp;(3)è§†é¢‘å‰ªåˆ‡ã€‚<br>&emsp;&emsp;(4)è§†é¢‘åˆæˆã€‚<br>&emsp;&emsp;(5)å¤šå¼ å›¾ç‰‡åˆæˆä¸€ä¸ªè§†é¢‘ã€‚<br>&emsp;&emsp;(6)å­—å¹•ã€‚<br>&emsp;&emsp;(7)éŸ³é¢‘å¤„ç†ã€‚<br>&emsp;&emsp;ç­‰ç­‰ç­‰â€¦.</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php-Sphinxæœç´¢å¼•æ“</title>
      <link href="/php-Sphinx%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/"/>
      <url>/php-Sphinx%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/</url>
      
        <content type="html"><![CDATA[<p><b>ä¸€ã€Sphinxæ˜¯ä»€ä¹ˆï¼Ÿ</b></p><p>&emsp;æ˜¯ä¸€ä¸ªåŸºäºSQLçš„å…¨æ–‡æ£€ç´¢å¼•æ“ï¼Œå¯ä»¥ç»“åˆMySQL,PostgreSQLåšå…¨æ–‡æœç´¢ï¼Œå®ƒå¯ä»¥æä¾›æ¯”æ•°æ®åº“æœ¬èº«æ›´ä¸“ä¸šçš„æœç´¢åŠŸèƒ½ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºæ›´å®¹æ˜“å®ç°ä¸“ä¸šåŒ–çš„å…¨æ–‡æ£€ç´¢ã€‚Sphinxç‰¹åˆ«ä¸ºä¸€äº›è„šæœ¬è¯­è¨€è®¾è®¡æœç´¢APIæ¥å£ï¼Œå¦‚Javaï¼ŒPHPï¼ŒPythonï¼ŒPerlï¼ŒRubyç­‰ï¼ŒåŒæ—¶ä¸ºMySQLä¹Ÿè®¾è®¡äº†ä¸€ä¸ªå­˜å‚¨å¼•æ“æ’ä»¶ã€‚ <em>â€”ç™¾åº¦ç™¾ç§‘</em>    </p><p>&emsp;Sphinx å•ä¸€ç´¢å¼•æœ€å¤§å¯åŒ…å«1äº¿æ¡è®°å½•ï¼Œåœ¨1åƒä¸‡æ¡è®°å½•æƒ…å†µä¸‹çš„æŸ¥è¯¢é€Ÿåº¦ä¸º0.xç§’ï¼ˆæ¯«ç§’çº§ï¼‰ã€‚Sphinxåˆ›å»ºç´¢å¼•çš„é€Ÿåº¦ä¸ºï¼šåˆ›å»º100ä¸‡æ¡è®°å½•çš„ç´¢å¼•åªéœ€ 3ï½4åˆ†é’Ÿï¼Œåˆ›å»º1000ä¸‡æ¡è®°å½•çš„ç´¢å¼•å¯ä»¥åœ¨50åˆ†é’Ÿå†…å®Œæˆï¼Œè€ŒåªåŒ…å«æœ€æ–°10ä¸‡æ¡è®°å½•çš„å¢é‡ç´¢å¼•ï¼Œé‡å»ºä¸€æ¬¡åªéœ€å‡ åç§’ã€‚<em>â€”ç™¾åº¦ç™¾ç§‘</em><br><a id="more"></a></p><p><b>äºŒã€Sphinxçš„ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</b></p><p>&emsp;é«˜é€Ÿç´¢å¼• ï¼ˆåœ¨æ–°æ¬¾CPUä¸Šï¼Œè¿‘10 MB/ç§’ï¼‰; é«˜é€Ÿæœç´¢ (2-4Gçš„æ–‡æœ¬é‡ä¸­å¹³å‡æŸ¥è¯¢é€Ÿåº¦ä¸åˆ°0.1ç§’); é«˜å¯ç”¨æ€§ ï¼ˆå•CPUä¸Šæœ€å¤§å¯æ”¯æŒ100 GBçš„æ–‡æœ¬ï¼Œ100Mæ–‡æ¡£ï¼‰; æä¾›è‰¯å¥½çš„ç›¸å…³æ€§æ’å æ”¯æŒåˆ†å¸ƒå¼æœç´¢ï¼› æä¾›æ–‡æ¡£æ‘˜è¦ç”Ÿæˆï¼› æä¾›ä»MySQLå†…éƒ¨çš„æ’ä»¶å¼å­˜å‚¨å¼•æ“ä¸Šæœç´¢ æ”¯æŒå¸ƒå°”ï¼ŒçŸ­è¯­ï¼Œ å’Œè¿‘ä¹‰è¯æŸ¥è¯¢ï¼› æ”¯æŒæ¯ä¸ªæ–‡æ¡£å¤šä¸ªå…¨æ–‡æ£€ç´¢åŸŸï¼ˆé»˜è®¤æœ€å¤§32ä¸ªï¼‰; æ”¯æŒæ¯ä¸ªæ–‡æ¡£å¤šå±æ€§ï¼› æ”¯æŒæ–­è¯ï¼› æ”¯æŒå•å­—èŠ‚ç¼–ç ä¸UTF-8ç¼–ç ï¼›</p><p><b>ä¸‰ã€Sphinxå®‰è£…ä¸é…ç½®</b> <em>â€“windowsç¯å¢ƒ</em></p><p>&emsp;1.ä¸‡ç‰©ä¸ç¦»å…¶å®—ï¼Œç¬¬ä¸€æ­¥è‚¯å®šæ˜¯å®‰è£…å•¦ï¼<a href="http://sphinxsearch.com/downloads/current/" target="_blank" rel="noopener">ä¸‹è½½åœ°å€</a> <em>â€”å…·ä½“çš„å®‰è£…æ­¥éª¤å°±ä¸ä¸€ä¸€ä»‹ç»äº†</em></p><p>&emsp;2.è§£å‹ä¹‹åä¼šçœ‹åˆ° <font color="#ff5722">apiã€binã€docã€etcã€miscã€src </font>å…­ä¸ªæ–‡ä»¶ã€‚ <em>â€“windowsç¯å¢ƒå¯èƒ½å’Œå…¶ä»–ç¯å¢ƒä¸åŒ</em></p><p>&emsp;3.åœ¨åŒçº§ç›®å½•ä¸‹æ–°å»º<font color="#ff5722">dataã€log</font>ä¸¤ä¸ªæ–‡ä»¶ã€‚ <em>â€“data:æ•°æ®æ–‡ä»¶ã€log:æ£€ç´¢çš„æ—¥å¿—æ–‡ä»¶</em></p><p>&emsp;4.å¤åˆ¶<font color="#ff5722">etc</font>ç›®å½•ä¸‹çš„<font color="#ff5722">sphinx-min.conf.dist</font>åˆ°<font color="#ff5722">bin</font>ç›®å½•ä¿®æ”¹æ–‡ä»¶åä¸º<font color="#ff5722">sphinx.conf</font>ã€‚ä¿®æ”¹é…ç½®ä¸º:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">source school # school åå­—æ˜¯éšæ„èµ·çš„</span><br><span class="line">&#123;</span><br><span class="line">type= mysql</span><br><span class="line"></span><br><span class="line">sql_host= localhost</span><br><span class="line">sql_user= root</span><br><span class="line">sql_pass= root</span><br><span class="line">sql_db= test</span><br><span class="line">sql_port= 3306</span><br><span class="line"># è®¾ç½®æ•°æ®åº“å­—ç¬¦é›†</span><br><span class="line">sql_query_pre   = SET NAMES utf8 </span><br><span class="line"># é…ç½®æ•°æ®æº--ä¹Ÿå°±æ˜¯æ•°æ®è¡¨çš„æ•°æ®</span><br><span class="line">sql_query=  SELECT id, school, address FROM school </span><br><span class="line"># é…ç½®è¿”å›å­—æ®µ--å¿…é¡»æ˜¯æ•°æ®è¡¨ä¸­å­˜åœ¨çš„å­—æ®µï¼Œä¸èƒ½è®¾ç½®è¿”å›ä¸»é”®ï¼Œå¦åˆ™ä¼šæŠ¥é”™</span><br><span class="line"># è¿™é‡Œçš„å­—æ®µè¿˜è¦å’Œä¸‹é¢indexé‡Œé…ç½®çš„ rt_fieldç›¸å¯¹åº”</span><br><span class="line">sql_field_string        = school </span><br><span class="line">    sql_field_string        = address </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">index school</span><br><span class="line">&#123;</span><br><span class="line">source            = school # æ•°æ®æº--ä¹Ÿå°±æ˜¯ä¸Šè¾¹çš„åå­—</span><br><span class="line">    path              = E:\sphinx\data\school # æ•°æ®å­˜æ”¾çš„åœ°å€--é…ç½®ä¸ºåˆšæ–°å»ºçš„dataä¸‹</span><br><span class="line">    mlock             = 0 # ç¼“å­˜å†…å­˜é”å®š</span><br><span class="line">    morphology        = none # æ•°æ®å¤„ç†æ–¹æ³•</span><br><span class="line">    min_word_len      = 1 # æœ€å°ç´¢å¼•å­—é•¿</span><br><span class="line">    html_strip        = 0 # æ˜¯å¦å»é™¤htmlæ ‡ç­¾</span><br><span class="line">    ngram_len         = 1 # æ”¯æŒä¸­æ–‡</span><br><span class="line">    ngram_chars       = U+3000..U+2FA1F # æ”¯æŒä¸­æ–‡</span><br><span class="line"></span><br><span class="line">    # å­—æ®µé…ç½®</span><br><span class="line">    rt_attr_uint    = id </span><br><span class="line">    rt_field        = school</span><br><span class="line">    rt_field        = address</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">indexer</span><br><span class="line">&#123;</span><br><span class="line">mem_limit= 128M</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># ä¸‹é¢éƒ½æ˜¯é»˜è®¤çš„ ä¿®æ”¹ä¸€ä¸‹logåœ°å€å°±å¥½äº†</span><br><span class="line">searchd</span><br><span class="line">&#123;</span><br><span class="line">listen= 9312</span><br><span class="line">listen= 9306:mysql41</span><br><span class="line">log= E:\sphinx\log\searchd.log</span><br><span class="line">query_log= E:\sphinx\log\query.log</span><br><span class="line">read_timeout= 5</span><br><span class="line">max_children= 30</span><br><span class="line">pid_file= E:\sphinx\log\searchd.pid</span><br><span class="line">seamless_rotate= 1</span><br><span class="line">preopen_indexes= 1</span><br><span class="line">unlink_old= 1</span><br><span class="line">workers= threads # for RT to work</span><br><span class="line">binlog_path= E:\sphinx\data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><b>å››ã€Sphinxåœ¨é¡¹ç›®ä¸­å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿ</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">require &quot;E:\sphinx\api\sphinxapi.php&quot;;</span><br><span class="line"></span><br><span class="line">$page = isset($_GET[&apos;p&apos;]) ? intval($_GET[&apos;p&apos;]) : 1;</span><br><span class="line">if ($page &lt;= 0) &#123;</span><br><span class="line">    $page = 1;</span><br><span class="line">&#125;</span><br><span class="line">$pagesize = 20;</span><br><span class="line"></span><br><span class="line">$sphinxClass = new \SphinxClient();</span><br><span class="line">$sphinxClass-&gt;setServer(&quot;localhost&quot;, 9312);</span><br><span class="line">$sphinxClass-&gt;setMaxQueryTime(3);</span><br><span class="line">$sphinxClass-&gt;SetArrayResult(true);</span><br><span class="line">$sphinxClass-&gt;SetLimits(($page - 1) * $pagesize, $pagesize, 3000); // æœç´¢åˆ†é¡µ</span><br><span class="line">// @school è¡¨ç¤ºåªåŒ¹é…æ•°æ®è¡¨ä¸­schoolçš„å­—æ®µ ,ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºä½¿ç”¨çš„ç´¢å¼•æ–¹æ³• å¯¹åº”sphinxä¸­çš„index school</span><br><span class="line">$result = $sphinxClass-&gt;query(&apos;@school æˆ´å´‡&apos;, &apos;school&apos;);</span><br><span class="line">echo &apos;&lt;pre&gt;&apos;;</span><br><span class="line">print_r($result);</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼Œåœ¨é¡¹ç›®ä¸­ä½¿ç”¨sphinxæ˜¯éå¸¸ç®€å•çš„åªéœ€è¦å¼•å…¥è¿™ä¸ªç±»å°±okäº†ã€‚</p><p><b>äº”ã€æµ‹è¯•</b></p><p>&emsp;æ•°æ®é‡200014æ¡æ•°æ®ã€‚</p><p>&emsp;ä½¿ç”¨mysqlæ¨¡ç³ŠæŸ¥è¯¢å¹³å‡è€—æ—¶ <font color="#ff5722">0.130s</font></p><p>&emsp;ä½¿ç”¨sphinxæœç´¢å¼•æ“å¹³å‡è€—æ—¶ <font color="#ff5722">0.030s</font></p><p>&emsp;ç”±æ­¤å¯è§å·®è·æ˜¯å¾ˆå¤§çš„ï¼Œå¦‚ä½•æ•°æ®é‡æ›´å¤§çš„æƒ…å†µä¸‹å·®è·ä¼šæ›´å¤§ã€‚</p><p><b>å…­ã€Sphinxçš„ä¼˜ç‚¹åŠç¼ºç‚¹</b></p><p>&emsp;ä¼˜ç‚¹:<br>&emsp;&emsp;(1)Sphinxç´¢å¼•æ–‡ä»¶æ¯æ¬¡æ›´æ–°éƒ½ä¼šæŠŠæ•°æ®å…¨éƒ¨å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ç”¨æˆ·ä½¿ç”¨æœç´¢çš„æ—¶å€™å¹¶ä¸ä¼šç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œé™ä½äº†æ•°æ®åº“çš„å‹åŠ›ã€‚<br>&emsp;&emsp;(2)åœ¨å‡ åä¸‡çº§æ•°æ®æŸ¥è¯¢æ—¶ï¼ŒSphinxç´¢å¼•é€Ÿåº¦è¦æ¯”æ•°æ®åº“ç´¢å¼•é€Ÿåº¦å¿«ä¸Šå¥½å‡ å€ï¼Œé€Ÿåº¦å¿«ã€‚</p><p>&emsp;ç¼ºç‚¹:<br>&emsp;&emsp;(1)æ•°æ®çš„ç´¢å¼•æ–‡ä»¶ä¼šå­˜å‚¨åœ¨æœ¬åœ°ï¼Œæ•°æ®é‡å¤§çš„æ—¶å€™å¯¹å†…å­˜ä¹Ÿæœ‰ä¸€å®šå½±å“ã€‚<br>&emsp;&emsp;(2)æ•°æ®åº“çš„æ•°æ®å˜åŒ–ï¼Œæ˜¯æ— æ³•åŒæ­¥åˆ°Sphinxç´¢å¼•æ–‡ä»¶é‡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡æ•°æ®åº“æ›´æ–°éƒ½è¦æ‰‹åŠ¨æ›´æ–°ç´¢å¼•æ–‡ä»¶ã€‚<br>&emsp;&emsp;(3)åœ¨æ²¡æœ‰ä½¿ç”¨ä¸­æ–‡åˆ†è¯çš„æŠ€æœ¯ä¸Šï¼ŒSphinxæœç´¢çš„ç»“æœæ˜¯ä¸å‡†ç¡®çš„ï¼Œä¾‹å¦‚ï¼šæ•°æ®åº“ä¸­æœ‰â€˜æˆ´å´‡1ï¼Œæˆ´å´‡2ï¼Œæˆ´å´‡3ï¼Œæˆ´å´‡â€™ï¼Œä½¿ç”¨likeæŸ¥è¯¢â€˜æˆ´å´‡â€™ä¼šæœ‰å››ä¸ªç»“æœï¼Œä½†ä½¿ç”¨SphinxæŸ¥è¯¢åªä¼šå‡ºç°ä¸€ä¸ªã€‚</p><p><b>æ€»ç»“</b></p><p>&emsp;Sphinxä»å®˜ç½‘ä¸Šå¯ä»¥çœ‹å‡ºå·²ç»å°†è¿‘ä¸€å¹´æ²¡æœ‰æ›´æ–°è¿‡äº†ï¼Œç”šè‡³è¿˜æœ‰ä¸€äº›bugæ²¡æœ‰ä¿®å¤ï¼Œä½†æ•´ä½“æ¥è¯´Sphinxåœ¨ä½¿ç”¨æ–¹é¢è¿˜æ˜¯éå¸¸ç®€å•å¯é çš„ã€‚</p><p>&emsp;<font color="#ff5722">PS:ä¸‹ä¸€ç¯‡å°†ä¼šä»‹ç»Sphinxä¸­æ–‡åˆ†è¯å¦‚ä½•ä½¿ç”¨ï¼</font></p>]]></content>
      
      
      
        <tags>
            
            <tag> phpæ‰©å±•ç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlè§†å›¾çš„ä½¿ç”¨æ–¹æ³•</title>
      <link href="/mysql%E8%A7%86%E5%9B%BE%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>/mysql%E8%A7%86%E5%9B%BE%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>&emsp;ä¸Šç¯‡ç®€å•çš„ä»‹ç»äº†è§†å›¾çš„æ¦‚å¿µï¼Œé‚£ä¹ˆè¿™ç¯‡å°†å‘Šè¯‰å¤§å®¶å¦‚ä½•åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤è§†å›¾ï¼Œä¹Ÿå°±æ˜¯è§†å›¾çš„åŸºæœ¬æ“ä½œäº†ï¼</p><p><b>ä¸€ã€åœ¨å•è¡¨ä¸Šåˆ›å»ºè§†å›¾</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºè¡¨ user</span><br><span class="line">create table user (id int,name varchar(10),age tinyint(3));</span><br><span class="line"># æ’å…¥æ•°æ®</span><br><span class="line">insert into user values(1,&apos;å¼ ä¸‰&apos;,20),(2,&apos;æå››&apos;,20);</span><br><span class="line"># åˆ›å»ºè§†å›¾-å¹¶è®¡ç®—ä»–ä»¬ä¸¤å¹´ä¹‹åå¤šå°‘å²</span><br><span class="line">create view view_user as select id,name,age+2 as age from user; </span><br><span class="line"># ç¬¬äºŒç§å†™æ³•</span><br><span class="line">create view view_user_1(user_id,user_name,user_age) as select id,name,age from user;</span><br></pre></td></tr></table></figure><br><a id="more"></a><br>å¾—åˆ°ç»“æœ:<table><th>id</th><th>name</th><th>age</th><tr><td>1</td><td>å¼ ä¸‰</td><td>22</td></tr><tr><td>2</td><td>æå››</td><td>22</td></tr><tr><td>3</td><td>ç‹äºŒ</td><td>22</td></tr></table></p><table><th>user_id</th><th>user_name</th><th>user_age</th><tr><td>1</td><td>å¼ ä¸‰</td><td>22</td></tr><tr><td>2</td><td>æå››</td><td>22</td></tr><tr><td>3</td><td>ç‹äºŒ</td><td>22</td></tr></table><br>ä»è¿™ä¸¤ç§å†™æ³•å¯ä»¥çœ‹å‡ºï¼Œåœ¨è§†å›¾ä¸Šæ˜¯å¯ä»¥ä½¿ç”¨è®¡ç®—çš„ï¼Œè™½ç„¶ä¸¤ä¸ªè§†å›¾ä¸­å­—æ®µåä¸åŒï¼Œä½†æ•°æ®ç¡®å®ç›¸åŒçš„ã€‚å› æ­¤åœ¨ä½¿ç”¨è§†å›¾çš„æ—¶å€™ï¼Œç”¨æˆ·æ ¹æœ¬æ¥è§¦ä¸åˆ°å®é™…è¡¨ä¸­çš„ç»“æ„å’Œæ•°æ®ï¼Œä»è€Œä¿è¯äº†æ•°æ®åº“çš„å®‰å…¨ã€‚<br><br><b>äºŒã€åœ¨å¤šè¡¨ä¸Šåˆ›å»ºè§†å›¾</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºè¡¨ userã€school</span><br><span class="line">create table user (id int, name varchar(10), age tinyint(3), school_id int);</span><br><span class="line">create table school (id int, name varchar(10));</span><br><span class="line"># æ’å…¥æ•°æ® </span><br><span class="line">insert into user values(1,&apos;å¼ ä¸‰&apos;,20,1),(2,&apos;æå››&apos;,20,2);</span><br><span class="line">insert into school values(1,&apos;æ¸…å&apos;),(2,&apos;åŒ—å¤§&apos;);</span><br><span class="line"># åˆ›å»ºè§†å›¾</span><br><span class="line">create view view_user_school(user_id,user_name,user_school) as select user.id,user.name school.name from user,school where user.school_id = school.id;</span><br></pre></td></tr></table></figure><br>é€šè¿‡è§†å›¾çœ‹åˆ°çš„ç»“æœï¼š<table><th>user_id</th><th>user_name</th><th>user_school</th><tr><td>1</td><td>å¼ ä¸‰</td><td>æ¸…å</td></tr><tr><td>2</td><td>æå››</td><td>åŒ—å¤§</td></tr></table><p><b>ä¸‰ã€æŸ¥çœ‹è§†å›¾</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc è§†å›¾å;</span><br></pre></td></tr></table></figure><br>é€šè¿‡è¿™ä¸ªå‘½ä»¤å¯ä»¥çœ‹å‡ºè§†å›¾çš„å­—æ®µå®šä¹‰ã€å­—æ®µçš„æ•°æ®ç±»å‹ã€æ˜¯å¦ä¸ºç©ºã€æ˜¯å¦ä¸ºä¸»é”®/å¤–é”®ã€é»˜è®¤å€¼å’Œé¢å¤–ä¿¡æ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select table status like &apos;è§†å›¾å&apos;;</span><br></pre></td></tr></table></figure><br>é€šè¿‡è¿™ä¸ªå‘½ä»¤å¯çœ‹å‡ºå­˜å‚¨å¼•æ“ã€åˆ›å»ºæ—¶é—´ã€Commentã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show create view &apos;è§†å›¾å&apos;;</span><br></pre></td></tr></table></figure><br>é€šè¿‡è¿™ä¸ªå‘½ä»¤å¯ä»¥çœ‹å‡ºè§†å›¾çš„åç§°ã€åˆ›å»ºè§†å›¾çš„è¯­å¥ç­‰ä¿¡æ¯ã€‚</p><p><b>å››ã€ä¿®æ”¹è§†å›¾</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create or replace view view_user as select id,user,name,age from user;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert view view_user as select id,user,name,age from user;</span><br></pre></td></tr></table></figure><p><b>äº”ã€æ›´æ–°è§†å›¾</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update view_user set age=100 where id=1;</span><br><span class="line">delete from view_user where id=1;</span><br></pre></td></tr></table></figure><br>å½“è§†å›¾æ›´æ–°çš„æ—¶å€™ç›¸å¯¹åº”çš„åŸºç¡€è¡¨ä¹Ÿä¼šè¢«æ›´æ–°ï¼Œä½†å¦‚æœæ˜¯å¤šè¡¨åˆ›å»ºã€ä½¿ç”¨äº†è®¡ç®—æˆ–è€…æ˜¯èšåˆå‡½æ•°éƒ½æ˜¯æ— æ³•ä¿®æ”¹/åˆ é™¤æˆåŠŸçš„ï¼Œå¹¶ä¸”ä¼šæŠ¥é”™ã€‚</p><p><b>å…­ã€åˆ é™¤è§†å›¾</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop view if exists view_user;</span><br></pre></td></tr></table></figure></p><p><b>æ€»ç»“ï¼š</b></p><p>&emsp;1.ä¸¤è€…çš„åŒºåˆ«</p><p>&emsp;&emsp;(1) è§†å›¾æ˜¯å·²ç»ç¼–è¯‘å¥½çš„sqlè¯­å¥ï¼Œæ˜¯åŸºäºsqlè¯­å¥çš„ç»“æœé›†å½¢æˆçš„å¯è§†åŒ–è¡¨ï¼Œè€Œè¡¨ä¸æ˜¯ã€‚<br>&emsp;&emsp;(2) è§†å›¾æ²¡æœ‰å®é™…çš„ç‰©ç†è®°å½•ï¼Œè€Œè¡¨æœ‰ã€‚<br>&emsp;&emsp;(3) è¡¨æ˜¯å†…å®¹ï¼Œè§†å›¾æ˜¯çª—å£ã€‚<br>&emsp;&emsp;(4) è¡¨å ç”¨ç‰©ç†ç©ºé—´è€Œè§†å›¾ä¸å ç”¨ã€‚<br>&emsp;&emsp;(5) è§†å›¾æ˜¯æŸ¥çœ‹æ•°æ®è¡¨çš„ä¸€ç§æ–¹æ³•ï¼Œä»å®‰å…¨è§’åº¦ä¸Šæ¥è¯´è§†å›¾å¯ä»¥é˜²æ­¢ç”¨æˆ·æ¥è§¦åˆ°æ•°æ®è¡¨ï¼Œä½¿ç”¨æˆ·ä¸çŸ¥é“è¡¨ç»“æ„ã€‚<br>&emsp;&emsp;(6) è¡¨å±äºå…¨å±€æ¨¡å¼ä¸­çš„è¡¨ï¼Œæ˜¯å®è¡¨ï¼Œè§†å›¾æ˜¯å±€éƒ¨æ¨¡å¼çš„è¡¨ï¼Œæ˜¯è™šè¡¨ã€‚<br>&emsp;&emsp;(7) è§†å›¾çš„ç®€å†å’Œåˆ é™¤åªä¼šå½±å“åˆ°è§†å›¾çš„æœ¬èº«ï¼Œä¸å½±å“å¯¹åº”è¡¨çš„åŸºæœ¬æ•°æ®ã€‚ </p><p>&emsp;2.ä¸¤è€…çš„å…³ç³»</p><p>&emsp;&emsp;(1) è§†å›¾æ˜¯å»ºç«‹åœ¨åŸºæœ¬è¡¨çº¸ä¸Šçš„è¡¨ï¼Œå®ƒçš„ç»“æ„éƒ½æ¥æºäºåŸºæœ¬è¡¨ã€‚æ— åŸºæœ¬è¡¨è§†å›¾å°†æ— æ³•å»ºç«‹ï¼Œè§†å›¾æ˜¯åŸºæœ¬è¡¨çš„æŠ½è±¡å’Œåœ¨é€»è¾‘æ„ä¹‰ä¸Šå»ºç«‹çš„æ–°å…³ç³»ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlè§†å›¾ä»‹ç»</title>
      <link href="/mysql%E8%A7%86%E5%9B%BE%E4%BB%8B%E7%BB%8D/"/>
      <url>/mysql%E8%A7%86%E5%9B%BE%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<p><b>ä¸€ã€è§†å›¾çš„å«ä¹‰</b></p><p>&emsp;1.è§†å›¾æ˜¯ä»ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨ä¸­å¯¼å‡ºçš„ï¼Œè§†å›¾çš„è¡Œä¸ºä¸è¡¨éå¸¸çš„ç›¸ä¼¼ï¼Œä½†è§†å›¾æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„è¡¨ã€‚åœ¨è§†å›¾ä¸­å¯ä»¥ä½¿ç”¨<font color="#7070D8">Select</font>è¯­å¥è¿›è¡ŒæŸ¥è¯¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<font color="#7070D8">Insert</font>ã€<font color="#7070D8">Update</font>ã€<font color="#7070D8">Delete</font>ï¼Œè§†å›¾è¿˜å¯ä»¥ä»å·²ç»å­˜åœ¨çš„è§†å›¾çš„åŸºç¡€ä¸Šå®šä¹‰ï¼ˆä¹Ÿå°±æ˜¯è§†å›¾ä¸Šå†åšè§†å›¾ï¼‰ã€‚<br><a id="more"></a><br>&emsp;2.è§†å›¾å®šä¹‰å¥½ä¹‹åä¼šå­˜åœ¨æ•°æ®åº“ä¸­ï¼Œä»è§†å›¾çœ‹åˆ°çš„æ•°æ®å¹¶ä¸æ˜¯è§†å›¾çœŸæ­£å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œé€šè¿‡è§†å›¾çœ‹åˆ°çš„æ•°æ®åªæ˜¯å­˜æ”¾åœ¨åŸºæœ¬è¡¨ä¸­çš„æ•°æ®ã€‚</p><p>&emsp;<font color="#7070D8">3.å¯¹è§†å›¾çš„æ“ä½œå’Œå¯¹è¡¨çš„æ“ä½œæ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥è¿›è¡ŒCURDã€‚å½“ä¿®æ”¹é€šè¿‡è§†å›¾çœ‹åˆ°çš„æ•°æ®æ—¶ï¼Œç›¸å¯¹äºçš„åŸºæœ¬è¡¨çš„æ•°æ®ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–;åŒæ—¶ï¼Œè‹¥åŸºæœ¬è¡¨çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œè§†å›¾çœ‹åˆ°çš„æ•°æ®ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</font></p><p><b>äºŒã€å¦‚ä½•ç†è§£è§†å›¾ä¸åŸºæœ¬è¡¨çš„å…³ç³»å‘¢ï¼Ÿ</b></p><p>&emsp;æœ‰ä¸€å¼ ç”¨æˆ·è¡¨ï¼š<table><th>ID</th><th>å§“å</th><th>å¹´é¾„</th><th>å­¦æ ¡</th><tr><td>1</td><td>å¼ ä¸‰</td><td>20</td><td>æ¸…å</td></tr><tr><td>2</td><td>æå››</td><td>20</td><td>åŒ—å¤§</td></tr><tr><td>3</td><td>ç‹äºŒ</td><td>20</td><td>åŒ—å¤§</td></tr></table></p><p>&emsp;åˆ›å»ºä¸€ä¸ªåŸºäºç”¨æˆ·è¡¨çš„è§†å›¾ï¼Œè§†å›¾é‡Œçš„å­—æ®µåªæœ‰å§“åå’Œå¹´é¾„ï¼Œé‚£ä¹ˆä»–ä»¬çš„å…³ç³»å°±åƒåœ¨è¿™ä¸ªç”¨æˆ·è¡¨ä¸Šç›–äº†ä¸€ä¸ªæœ¨æ¿ï¼Œæœ¨æ¿ä¸Šç•™äº†ä¸ªçª—å£ï¼Œä»è¿™ä¸ªçª—å£çœ‹è¿›å»åªèƒ½çœ‹è§å§“åå’Œå¹´é¾„ï¼Œè¿™ä¾¿æ˜¯è§†å›¾çš„ä½œç”¨å’Œä»–ä»¬çš„å…³ç³»ã€‚</p><p><b>ä¸‰ã€è§†å›¾çš„ä½œç”¨</b></p><p>&emsp;ä¸ç›´æ¥ä»æ•°æ®è¡¨ä¸­è¯»å–æ•°æ®ç›¸æ¯”ï¼Œè§†å›¾å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><p>&emsp;&emsp;(1)ã€ç®€å•åŒ–</p><p>&emsp;&emsp;&emsp;&emsp;ï¼šä»è§†å›¾çœ‹åˆ°çš„æ•°æ®ä½ å¯ä»¥è‡ªå®šä¹‰ï¼Œä¹Ÿå°±æ˜¯è¯´çœ‹åˆ°çš„éƒ½æ˜¯éœ€è¦çš„æ•°æ®ã€‚é‚£äº›è¢«ç»å¸¸ä½¿ç”¨æŸ¥è¯¢çš„è¡¨å¯ä»¥åˆ›å»ºä¸€å¼ è§†å›¾ï¼Œä»è€Œä½¿ä½¿ä»¥åçš„æ“ä½œä¸éœ€è¦éƒ½å‡è®¾å…¨éƒ¨çš„æ¡ä»¶ã€‚</p><p>&emsp;&emsp;(2)ã€å®‰å…¨æ€§</p><p>&emsp;&emsp;&emsp;&emsp;ï¼šå‡å¦‚æ•°æ®è¡¨çš„æŸäº›å­—æ®µæ˜¯éšç§çš„ï¼Œä¸æƒ³è¢«å…¶ä»–äººçœ‹åˆ°ã€‚è¿™æ—¶ä½ å°±å¯ä»¥åˆ›å»ºä¸€å¼ è§†å›¾æŠŠéšç§çš„å­—æ®µè¿‡æ»¤æ‰ã€‚</p><p>&emsp;&emsp;(3)ã€é€»è¾‘æ•°æ®ç‹¬ç«‹æ€§</p><p>&emsp;&emsp;&emsp;&emsp;ï¼šè§†å›¾å¯å¸®åŠ©ç”¨æˆ·å±è”½çœŸå®çš„è¡¨ç»“æ„å˜åŒ–å¸¦æ¥çš„å½±å“ã€‚</p><p>PS:ä¸‹ç¯‡è®²ä»‹ç»è§†å›¾å¦‚ä½•åˆ›å»ºã€ä½¿ç”¨ç­‰ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>charlesè¿‡æ»¤æ•°æ®åŒ…</title>
      <link href="/charles%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE%E5%8C%85/"/>
      <url>/charles%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<p>1.1 è®¾ç½®è¿‡æ»¤ï¼šæ‰¾åˆ°ã€Proxyã€‘-ã€Recording Settingã€‘<br><img src="/charlesè¿‡æ»¤æ•°æ®åŒ…/img/record.png"><br><a id="more"></a><br>ç‚¹å‡»Addæ·»åŠ è¿‡æ»¤è§„åˆ™ï¼š</p><p>ï¼ˆ1ï¼‰Protocol é€‰æ‹©è¿‡æ»¤çš„åè®®</p><p>ï¼ˆ2ï¼‰Host å¡«å†™IPæˆ–ç½‘å€</p><p>ï¼ˆ3ï¼‰Port å¡«å†™ç«¯å£ *ä¸ºå…¨éƒ¨ç«¯å£</p><img src="/charlesè¿‡æ»¤æ•°æ®åŒ…/img/record1.png">]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…</title>
      <link href="/charles%E6%8A%93ios%E6%89%8B%E6%9C%BA%E6%95%B0%E6%8D%AE%E5%8C%85/"/>
      <url>/charles%E6%8A%93ios%E6%89%8B%E6%9C%BA%E6%95%B0%E6%8D%AE%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<p>Charleså…¶å®æ˜¯ä¸€æ¬¾ä»£ç†æœåŠ¡å™¨ï¼Œé€šè¿‡è¿‡å°†è‡ªå·±è®¾ç½®æˆç³»ç»Ÿï¼ˆç”µè„‘æˆ–è€…æµè§ˆå™¨ï¼‰çš„ç½‘ç»œè®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œç„¶åæˆªå–è¯·æ±‚å’Œè¯·æ±‚ç»“æœè¾¾åˆ°åˆ†ææŠ“åŒ…çš„ç›®çš„ã€‚è¯¥è½¯ä»¶æ˜¯ç”¨Javaå†™çš„ï¼Œèƒ½å¤Ÿåœ¨Windowsï¼ŒMacï¼ŒLinuxä¸Šä½¿ç”¨.<br><a id="more"></a><br>Charlesçš„ä¸»è¦åŠŸèƒ½ï¼š</p><p>ï¼ˆ1ï¼‰æˆªå–Http å’Œ Https ç½‘ç»œå°åŒ…ã€‚</p><p>ï¼ˆ2ï¼‰æ”¯æŒé‡å‘ç½‘ç»œè¯·æ±‚ï¼Œæ–¹ä¾¿åç«¯è°ƒè¯•ã€‚</p><p>ï¼ˆ3ï¼‰æ”¯æŒä¿®æ”¹ç½‘ç»œè¯·æ±‚å‚æ•°ã€‚</p><p>ï¼ˆ4ï¼‰æ”¯æŒç½‘ç»œè¯·æ±‚çš„æˆªè·å¹¶åŠ¨æ€ä¿®æ”¹ã€‚</p><p>ï¼ˆ5ï¼‰æ”¯æŒæ¨¡æ‹Ÿæ…¢é€Ÿç½‘ç»œã€‚</p><p>1.1 ä¸‹è½½å®‰è£…Charlesï¼š <a href="https://www.charlesproxy.com/download/" target="_blank" rel="noopener">ç‚¹å‡»ä¸‹è½½</a></p><p>1.2 è®¾ç½®ä»£ç†æ¨¡å¼ï¼šè®¾ç½®ç«¯å£ä¸º8888ï¼Œå‹¾é€‰ä¸ŠEnable transparency HTTP  proxying<br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles1.png"><br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles2.png"></p><p>1.3 è®¾ç½®æœ¬æœºä¸ºä»£ç†ï¼šå‹¾é€‰ä¸ºMac local æœ¬åœ°ä»£ç†<br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles3.png"></p><p>1.4 è®¾ç½®è¿‡æ»¤åè®®ï¼šè®¾ç½®æŠ“å–åè®®ç±»å‹ <em>.</em> ä¸ºå…¨éƒ¨hostçš„æ‰€ä»¥åè®®ç«¯å£<br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles4.png"></p><p>åˆ°æ­¤ä¸ºæ­¢å…¶å®å·²ç»å¯ä»¥æŠ“å–åˆ°æ‰‹æœºçš„æ•°æ®åŒ…äº†ï¼Œåªæ˜¯æ— æ³•æŠ“å–httpsåè®®çš„æ•°æ®åŒ…ã€‚</p><p>2.1 å®‰è£…è¯ä¹¦ï¼šæŠ“httpsæ•°æ®åŒ…ï¼Œç‚¹å‡»ä¹‹åä¼šå¼¹å‡ºç”µè„‘è¯ä¹¦çš„åˆ—è¡¨<br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles5.png"></p><p>2.2 è®¾ç½®ä¿¡ä»»ï¼šæ‰¾åˆ°åˆšä¸‹è½½çš„Charlesè¯ä¹¦ï¼ŒåŒå‡»æ‰“å¼€ï¼Œè®¾ç½®å§‹ç»ˆä¿¡ä»»<br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles6.png"></p><p>3.3 è·å–è¯ä¹¦ä¸‹è½½åœ°å€<br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles7.png"><br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles8.png"></p><p>3.4 ä¸‹è½½è¯ä¹¦ï¼šç”¨è‹¹æœæµè§ˆå™¨è®¿é—®chls.pro/sslä¸‹è½½è¯ä¹¦<br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles9.png"></p><p>3.5 å®‰è£…è¯ä¹¦ï¼šåœ¨ã€è®¾ç½®ã€‘-ã€é€šç”¨ã€‘-ã€æè¿°æ–‡ä»¶ã€‘ä¸­æ‰¾åˆ°åˆšåˆšä¸‹è½½çš„è¯ä¹¦ï¼ŒåŒå‡»å¹¶å®‰è£…<br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles10.png"><br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles11.png"></p><p>3.6 è®¾ç½®ä¿¡ä»»ï¼šåœ¨ã€è®¾ç½®ã€‘-ã€é€šç”¨ã€‘-ã€å…³äºæœ¬æœºã€‘-ã€è¯ä¹¦ä¿¡ä»»è®¾ç½®ã€‘ä¸­æ‰¾åˆ°å®‰è£…çš„è¯ä¹¦ï¼Œç‚¹å‡»è®¾ç½®ä¸ºä¿¡ä»»<br><img src="/charlesæŠ“iosæ‰‹æœºæ•°æ®åŒ…/img/charles12.png"></p><p>ä¹‹åå°±å’Œç”µè„‘è¿æ¥åŒä¸€ä¸ªwifi,é…ç½®ä»£ç†ä¸ºç”µè„‘ç«¯çš„æœ¬æœºipï¼Œç«¯å£ä¸ºè®¾ç½®çš„8888ï¼Œè¿æ¥ä¹‹åç”µè„‘ç«¯ä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼Œç‚¹å‡»Allowå°±okäº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitè¦†ç›–æœ¬åœ°æœªæäº¤çš„ä»£ç </title>
      <link href="/git%E8%A6%86%E7%9B%96%E6%9C%AC%E5%9C%B0%E6%9C%AA%E6%8F%90%E4%BA%A4%E7%9A%84%E4%BB%A3%E7%A0%81/"/>
      <url>/git%E8%A6%86%E7%9B%96%E6%9C%AC%E5%9C%B0%E6%9C%AA%E6%8F%90%E4%BA%A4%E7%9A%84%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<p>&emsp;åœ¨å¤šäººåä½œå¼€å‘ä¸­ï¼Œä½¿ç”¨gitæˆ–svnç®¡ç†ä»£ç æœ€å¸¸è§çš„é—®é¢˜å°±æ˜¯ä»£ç å†²çªï¼</p><p>&emsp;ä½œä¸ºé«˜æ•ˆå¼€å‘å›¢é˜Ÿä¸­çš„ä¸€å‘˜åº”å½“å…·æœ‰å¤„ç†è¿™äº›é—®é¢˜çš„èƒ½åŠ›ã€‚</p><p>&emsp;å‡è®¾ç°æœ‰ä¸€ä¸ªé¡¹ç›®ï¼Œæœ‰å¤šä¸ªå¼€å‘æˆå‘˜ï¼Œæˆå‘˜Aå’Œæˆå‘˜Bå…±åŒç®¡ç†åŒä¸€ä¸ªåˆ†æ”¯çš„ä»£ç ã€‚æˆå‘˜Aåœ¨æœ¬åœ°ä¿®æ”¹äº†ä»£ç å¹¶æäº¤åˆ°daichongwebåˆ†æ”¯ï¼Œæˆå‘˜Bä¹Ÿä¿®æ”¹äº†ä»£ç ï¼Œå½“æˆå‘˜Béœ€è¦ç”¨åˆ°æˆå‘˜Aæäº¤ä»£ç ä¸­çš„éƒ¨åˆ†åŠŸèƒ½ï¼Œéœ€è¦æ‹‰å–daichongwebåˆ†æ”¯çš„ä»£ç ï¼Œè¿™æ—¶ä¼šå‡ºç°ä¸€ä¸ªé”™è¯¯ã€‚<br><a id="more"></a><br><img src="/gitè¦†ç›–æœ¬åœ°æœªæäº¤çš„ä»£ç /img/1.png"><br>&emsp;å¯ä»¥çœ‹å‡ºgitä¸å…è®¸æ‹‰å–ä»£ç ï¼Œå› ä¸ºæˆå‘˜Aä¹ŸåŒæ ·ä¿®æ”¹äº†ä»£ç ã€‚é‚£ä¹ˆèƒ½æäº¤å—ï¼Ÿç­”æ¡ˆæ˜¯ä¸èƒ½ï¼æäº¤ä¼šå‡ºç°ä»£ç å†²çªçš„é”™è¯¯ï¼</p><p>&emsp;è¿™æ—¶åº”è¯¥æƒ³åˆ°çš„æ˜¯å¦‚ä½•æŠŠæœ¬åœ°ä»£ç ä¿å­˜èµ·æ¥ï¼Œå½“ç„¶gitæä¾›äº†å‘½ä»¤ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git stash</span><br></pre></td></tr></table></figure><br><img src="/gitè¦†ç›–æœ¬åœ°æœªæäº¤çš„ä»£ç /img/2.png"><br>&emsp;ä½¿ç”¨ <font color="#ff5722">git stash</font> å¯å°†å·²ä¿®æ”¹çš„ä»£ç ä¿å­˜èµ·æ¥ï¼Œç„¶ååœ¨ä½¿ç”¨<font color="#ff5722">git pull</font> æ‹‰å–ä»£ç å°±ä¸ä¼šå‡ºç°é”™è¯¯ã€‚</p><p>&emsp;ç„¶åæ‰§è¡Œ<font color="#ff5722">git stash list</font>æŸ¥çœ‹æš‚å­˜ä»£ç ï¼Œå†ä½¿ç”¨<font color="#ff5722">git stash pop stash@{0}</font>æŠŠä»£ç popå‡ºæ¥ï¼Œè¿™æ—¶ä¼šæç¤ºå†²çªï¼ŒæŠŠå†²çªè§£å†³å°±å¥½äº†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git stash list </span><br><span class="line">git stash pop stash@&#123;0&#125;</span><br></pre></td></tr></table></figure><br><img src="/gitè¦†ç›–æœ¬åœ°æœªæäº¤çš„ä»£ç /img/3.png"></p><blockquote><p>æ€»ç»“</p></blockquote><p>ä»£ç å†²çªè¦åœ¨æœ¬åœ°å¤„ç†ï¼Œä¸è¦ç›´æ¥æäº¤ã€‚<br>è§£å†³åŒä¸€åˆ†æ”¯å†²çªçš„æ­¥éª¤ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git stash</span><br><span class="line">git pull</span><br><span class="line">git stash list </span><br><span class="line">git stash pop stash@&#123;0&#125;</span><br><span class="line">è§£å†³å†²çª</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€åŸåˆ›ã€‘phpgdåº“å¤„ç†å›¾ç‰‡ç”Ÿæˆæµ·æŠ¥å›¾</title>
      <link href="/phpgd%E5%BA%93%E5%A4%84%E7%90%86%E5%9B%BE%E7%89%87%E7%94%9F%E6%88%90%E6%B5%B7%E6%8A%A5%E5%9B%BE/"/>
      <url>/phpgd%E5%BA%93%E5%A4%84%E7%90%86%E5%9B%BE%E7%89%87%E7%94%9F%E6%88%90%E6%B5%B7%E6%8A%A5%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸€.å¼•è¨€</p></blockquote><p>&emsp;å¥½ä¹…æ²¡å†™åšå®¢äº†ï¼Œä¸çŸ¥é“è¯¥å†™äº›ä»€ä¹ˆã€‚<br>&emsp;æ­£å‘æ„å‘¢ï¼Œçªç„¶å‘ç°äº†ä¸€ä¸ªå¥½ç©çš„ä¸œè¥¿ã€‚<br>&emsp;æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯phpçš„ä¸€ä¸ªæ‰©å±•GDåº“ã€‚</p><p>&emsp;ä¸ºä»€ä¹ˆè¯´ä»–å¥½ç©ï¼Ÿå› ä¸ºGDåº“å°±åƒä¸€ä¸ªå›¾ç‰‡å¤„ç†å™¨ï¼Œå®ƒå¯ä»¥ç»„åˆå›¾ç‰‡ã€å‰ªè¾‘å›¾ç‰‡ç­‰ç­‰â€¦.</p><p>&emsp;åæ¥ç»è¿‡æ•´ç†å’Œå®è·µå‘ç°ï¼Œè¿™ä¸ªä¸œè¥¿æ¯”è¾ƒé€‚åˆåšäº§å“æ¨å¹¿å›¾æ¥ç”¨ï¼Œæ›´åŠ é€‚åˆåœ¨å…¬ä¼—å·æˆ–å°ç¨‹åºé‡Œè·ŸäºŒç»´ç ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚<br><a id="more"></a><br><blockquote><p>äºŒ.ç®€å•ä»‹ç»</p></blockquote><br>&emsp;1).å¦‚ä½•ä¸‹è½½ç±»åº“&amp;&amp;æµ‹è¯•demoï¼Œå¤§å®¶å¯ä»¥ä»<font color="#ff5722">github</font>ä¸Šæ‹‰å–ï¼Œåœ°å€ï¼š<a href="https://github.com/DaiChongyu/phpgd-CreatePoster" target="_blank" rel="noopener">ç±»åº“&&demo</a><br>&emsp;2).å¦‚ä½•ä½¿ç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">use \CreatePoster\CreateHelper;</span><br><span class="line">require &apos;./gd.php&apos;;</span><br><span class="line">CreateHelper::start();</span><br></pre></td></tr></table></figure><br>&emsp;3).æ³¨æ„äº‹é¡¹ï¼š<br>&emsp;&emsp;1.å†™å…¥å­—ä½“è¦å¼•å…¥å­—ä½“æ–‡ä»¶ï¼Œæ–‡ä»¶è·¯å¾„ä¸€èˆ¬ä¸ºç»å¯¹è·¯å¾„ã€‚<br>&emsp;&emsp;2.ä¸‹è½½åœ°å€å¯ä»¥åœ¨loadå‡½æ•°ä¸­é…ç½®ã€‚<br>&emsp;&emsp;3.ä¸»å›¾æœ€å¥½æ˜¯pngæ ¼å¼ï¼Œè¿™æ ·æ¸…æ™°åº¦ä¼šå¾ˆé«˜ã€‚<br>&emsp;&emsp;4.ä½¿ç”¨CreateImageåˆ›å»ºç”»æ¿æ—¶ï¼Œå¦‚æœä¼ å…¥çš„å›¾ç‰‡è¾ƒå°ï¼Œå¦‚éœ€æ”¾å¤§è¯·ä½¿ç”¨ç¬¬4å’Œç¬¬5ä¸ªå‚æ•°ã€‚</p><p><div style="display: flex;justify-content: space-around;"><br>    <div style="display: inline-block;"><img src="/phpgdåº“å¤„ç†å›¾ç‰‡ç”Ÿæˆæµ·æŠ¥å›¾/img/error.png" width="300"></div><div style="display: inline-block;"><img src="/phpgdåº“å¤„ç†å›¾ç‰‡ç”Ÿæˆæµ·æŠ¥å›¾/img/success1.png" width="300"></div><br></div><br>&emsp;&emsp;5.ä½¿ç”¨CreateImageåˆ›å»ºç”»æ¿æ—¶ï¼Œæ³¨æ„imagecolortransparentä½¿ç”¨ï¼Œä»–ä¼šæŠŠç”»æ¿å˜ä¸ºé€æ˜ã€‚</p><p><div style="display: flex;justify-content: space-around;"><br>    <div style="display: inline-block;"><img src="/phpgdåº“å¤„ç†å›¾ç‰‡ç”Ÿæˆæµ·æŠ¥å›¾/img/error1.png" width="300"></div><div style="display: inline-block;"><img src="/phpgdåº“å¤„ç†å›¾ç‰‡ç”Ÿæˆæµ·æŠ¥å›¾/img/success.png" width="300"></div><br></div></p><p><font color="#ff5722">PS:å…¶ä»–çš„ç”¨é€”å°±çœ‹å¤§å®¶çš„åˆ›æ„ã€æƒ³æ³•äº†ã€‚<b>æˆ‘ä»¬ä¸åšä»£ç æ¬è¿å·¥ï¼Œæˆ‘ä»¬è¦åšä»£ç è‰ºæœ¯å®¶ã€‚</b>åç»­æ­¤ç±»ä¼šç»å¸¸çš„æ›´æ–°å’Œä¼˜åŒ–â€¦.</font><br><blockquote><p>å››.ä»£ç æµè§ˆ</p></blockquote><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace CreatePoster;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> *  ç”Ÿæˆæµ·æŠ¥å›¾</span><br><span class="line"> *  @author daichongweb</span><br><span class="line"> *  @url daichongweb.cn,daichongweb.com</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">class CreateHelper</span><br><span class="line">&#123;</span><br><span class="line">    public static function start()</span><br><span class="line">    &#123;</span><br><span class="line">        echo (&apos;&lt;h2&gt;æ¬¢è¿ä½¿ç”¨ï¼š)&lt;/h2&gt;&apos;);</span><br><span class="line">        echo &apos;&lt;hr /&gt;&apos;;</span><br><span class="line">        echo &apos;æµ·æŠ¥å›¾åˆ¶ä½œæ­¥éª¤:&apos;;</span><br><span class="line">        echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">        echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">        echo &apos;&amp;emsp;&amp;emsp;1.åˆ›å»ºç”»æ¿(æ™®é€šç”»æ¿ç”¨CreatePalette;å›¾åƒç”»æ¿ç”¨CreateImage)&apos;;</span><br><span class="line">        echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">        echo &apos;&amp;emsp;&amp;emsp;2.åˆå¹¶å›¾ç‰‡(ImagesMerge)&apos;;</span><br><span class="line">        echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">        echo &apos;&amp;emsp;&amp;emsp;3.æ’å…¥æ–‡å­—(CreateChars)&apos;;</span><br><span class="line">        echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">        echo &apos;&amp;emsp;&amp;emsp;4.æ’å…¥åˆ’çº¿(CreateLine)&apos;;</span><br><span class="line">        echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">        echo &apos;&amp;emsp;&amp;emsp;5.ä¸‹è½½æˆ–æŸ¥çœ‹&apos;;</span><br><span class="line">        echo &apos;&lt;br /&gt;&apos;;</span><br><span class="line">        echo (&apos;&lt;h2&gt;æ³¨æ„äº‹é¡¹:&lt;/h2&gt;&apos;);</span><br><span class="line">        echo &apos;&lt;hr /&gt;&apos;;</span><br><span class="line">        echo &quot;&lt;font color=&apos;red&apos;&gt;æ³¨æ„äº‹é¡¹ï¼šä¸»å›¾å°½é‡æ”¹ä¸ºpngæ ¼å¼ï¼Œè¿™æ ·çš„è¯å›¾ç‰‡ä¼šå¾ˆæ¸…æ™°ï¼Œåœ¨æµè§ˆå™¨ä¸­ç›´æ¥æŸ¥çœ‹æ•ˆæœä¸æ˜¯å¾ˆå¥½ï¼Œä¸‹è½½ä¸‹æ¥å°±ä¼šå¾ˆæ¸…æ™°çš„ã€‚&lt;/font&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [CreatePalette æ–°å»ºä¸€ä¸ªç”»æ¿]</span><br><span class="line">     * @param    array      $config     æ•°æ®é…ç½®</span><br><span class="line">     * @param    int        $x_size     ç”»æ¿çš„å®½åº¦</span><br><span class="line">     * @param    int        $y_size     ç”»æ¿çš„é«˜åº¦</span><br><span class="line">     * @param    int        $red        çº¢è‰²</span><br><span class="line">     * @param    int        $green      ç»¿è‰²</span><br><span class="line">     * @param    int        $blue       è“è‰²</span><br><span class="line">     */</span><br><span class="line">    public static function CreatePalette($config)</span><br><span class="line">    &#123;</span><br><span class="line">        $Palette = imagecreate($config[&apos;x_size&apos;], $config[&apos;y_size&apos;]);</span><br><span class="line">        imagecolorallocate($Palette, $config[&apos;red&apos;], $config[&apos;green&apos;], $config[&apos;blue&apos;]);</span><br><span class="line">        return $Palette;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [OrthogonBr ç”»ä¸€ä¸ªçŸ©å½¢è¾¹æ¡†]</span><br><span class="line">     * @param    resource   $mainBg     ç”»å¸ƒèµ„æº</span><br><span class="line">     * @param    array      $config     æ•°æ®é…ç½®</span><br><span class="line">     * @param    int        $x1         xåæ ‡</span><br><span class="line">     * @param    int        $y1         yåæ ‡</span><br><span class="line">     *</span><br><span class="line">     * @param    int       $red         çº¢è‰²</span><br><span class="line">     * @param    int       $green       ç»¿è‰²</span><br><span class="line">     * @param    int       $blue        è“è‰²</span><br><span class="line">     */</span><br><span class="line">    public static function OrthogonBr($mainBg, $config)</span><br><span class="line">    &#123;</span><br><span class="line">        $color = imagecolorallocate($mainBg, $config[&apos;red&apos;], $config[&apos;green&apos;], $config[&apos;blue&apos;]);</span><br><span class="line">        imagerectangle($mainBg, $config[&apos;x1&apos;], $config[&apos;y1&apos;], $config[&apos;x2&apos;], $config[&apos;y2&apos;], $color);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [OrthogonBg ç”»ä¸€ä¸ªçŸ©å½¢å®ä½“]</span><br><span class="line">     * @param    resource   $mainBg     ç”»å¸ƒèµ„æº</span><br><span class="line">     * @param    array      $config     æ•°æ®é…ç½®</span><br><span class="line">     * @param    int        $x1         xåæ ‡</span><br><span class="line">     * @param    int        $y1         yåæ ‡</span><br><span class="line">     *</span><br><span class="line">     * @param    int        $red        çº¢è‰²</span><br><span class="line">     * @param    int        $green      ç»¿è‰²</span><br><span class="line">     * @param    int        $blue       è“è‰²</span><br><span class="line">     */</span><br><span class="line">    public static function OrthogonBg($mainBg, $config)</span><br><span class="line">    &#123;</span><br><span class="line">        $color = imagecolorallocate($mainBg, $config[&apos;red&apos;], $config[&apos;green&apos;], $config[&apos;blue&apos;]);</span><br><span class="line">        imagefilledrectangle($mainBg, $config[&apos;x1&apos;], $config[&apos;y1&apos;], $config[&apos;x2&apos;], $config[&apos;y2&apos;], $color);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [CircleBr ç”»ä¸€ä¸ªæ¤­åœ†è¾¹æ¡†]</span><br><span class="line">     * @param    resource   $mainBg     ç”»å¸ƒèµ„æº</span><br><span class="line">     * @param    array      $config     æ•°æ®é…ç½®</span><br><span class="line">     * @param    int        $left       è·ç¦»å·¦è¾¹çš„è·ç¦»</span><br><span class="line">     * @param    int        $top        è·ç¦»ä¸Šè¾¹çš„è·ç¦»</span><br><span class="line">     * @param    int        $width      å®½åº¦</span><br><span class="line">     * @param    int        $height     é«˜åº¦</span><br><span class="line">     * @param    int        $red        çº¢è‰²</span><br><span class="line">     * @param    int        $green      ç»¿è‰²</span><br><span class="line">     * @param    int        $blue       è“è‰²</span><br><span class="line">     */</span><br><span class="line">    public static function CircleBr($mainBg, $config)</span><br><span class="line">    &#123;</span><br><span class="line">        $color = imagecolorallocate($mainBg, $config[&apos;red&apos;], $config[&apos;green&apos;], $config[&apos;blue&apos;]);</span><br><span class="line">        imageellipse($mainBg, $config[&apos;left&apos;], $config[&apos;top&apos;], $config[&apos;width&apos;], $config[&apos;height&apos;], $color);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [CircleBg ç”»ä¸€ä¸ªå®ä½“æ¤­åœ†]</span><br><span class="line">     * @param    resource   $mainBg     ç”»å¸ƒèµ„æº</span><br><span class="line">     * @param    array      $config     æ•°æ®é…ç½®</span><br><span class="line">     * @param    int        $left       è·ç¦»å·¦è¾¹çš„è·ç¦»</span><br><span class="line">     * @param    int        $top        è·ç¦»ä¸Šè¾¹çš„è·ç¦»</span><br><span class="line">     * @param    int        $width      å®½åº¦</span><br><span class="line">     * @param    int        $red        çº¢è‰²</span><br><span class="line">     * @param    int        $green      ç»¿è‰²</span><br><span class="line">     * @param    int        $blue       è“è‰²</span><br><span class="line">     */</span><br><span class="line">    public static function CircleBg($mainBg, $config)</span><br><span class="line">    &#123;</span><br><span class="line">        $color = imagecolorallocate($mainBg, $config[&apos;red&apos;], $config[&apos;green&apos;], $config[&apos;blue&apos;]);</span><br><span class="line">        imagefilledellipse($mainBg, $config[&apos;left&apos;], $config[&apos;top&apos;], $config[&apos;width&apos;], $config[&apos;height&apos;], $color);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [StarBr ç”»ä¸€ä¸ªäº”è§’æ˜Ÿè¾¹æ¡†]</span><br><span class="line">     * @param    resource   $mainBg     ç”»å¸ƒèµ„æº</span><br><span class="line">     * @param    array      $config     æ•°æ®é…ç½®</span><br><span class="line">     * @param    int        $r          åŠå¾„</span><br><span class="line">     * @param    int        $left       è·ç¦»å·¦è¾¹çš„è·ç¦»</span><br><span class="line">     * @param    int        $top        è·ç¦»ä¸Šè¾¹çš„è·ç¦»</span><br><span class="line">     */</span><br><span class="line">    public static function StarBr($mainBg, $config)</span><br><span class="line">    &#123;</span><br><span class="line">        $r = $config[&apos;r&apos;];</span><br><span class="line">        $degree36 = deg2rad(36);</span><br><span class="line">        $l = 2 * $r * sin($degree36);</span><br><span class="line">        $a = $l * cos($degree36);</span><br><span class="line">        $b = $l * sin($degree36);</span><br><span class="line">        $c = $l / 2;</span><br><span class="line">        $d = $r * cos($degree36);</span><br><span class="line"></span><br><span class="line">        $px1 = $config[&apos;left&apos;];</span><br><span class="line">        $py1 = $config[&apos;top&apos;];</span><br><span class="line"></span><br><span class="line">        $px2 = $px1 + $a;</span><br><span class="line">        $py2 = $py1 + $b;</span><br><span class="line">        $px3 = $px1 + $c;</span><br><span class="line">        $py3 = $py1 + $r + $d;</span><br><span class="line">        $px4 = $px1 - $c;</span><br><span class="line">        $py4 = $py1 + $r + $d;</span><br><span class="line">        $px5 = $px1 - $a;</span><br><span class="line">        $py5 = $py1 + $b;</span><br><span class="line"></span><br><span class="line">        $color = imagecolorallocate($mainBg, $config[&apos;red&apos;], $config[&apos;green&apos;], $config[&apos;blue&apos;]);</span><br><span class="line"></span><br><span class="line">        imageline($mainBg, $px2, $py2, $px5, $py5, $color);</span><br><span class="line">        imageline($mainBg, $px1, $py1, $px3, $py3, $color);</span><br><span class="line">        imageline($mainBg, $px1, $py1, $px4, $py4, $color);</span><br><span class="line">        imageline($mainBg, $px2, $py2, $px4, $py4, $color);</span><br><span class="line">        imageline($mainBg, $px3, $py3, $px5, $py5, $color);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [CreateImage æ–°å»ºä¸€ä¸ªå›¾åƒç”»æ¿]</span><br><span class="line">     * @param    url        $palette    å›¾åƒçš„åœ°å€</span><br><span class="line">     * @param    string     $dst_w      ç›®æ ‡å›¾ç‰‡çš„å®½åº¦</span><br><span class="line">     * @param    string     $dst_h      ç›®æ ‡å›¾ç‰‡çš„é«˜åº¦</span><br><span class="line">     * @param    string     $bgWidth    ç”»æ¿çš„å®½åº¦</span><br><span class="line">     * @param    string     $bgHeight   ç”»æ¿çš„é«˜åº¦    è¿™ä¸¤é¡¹å†³å®šäº†å›¾ç‰‡å¦‚æœå°äº†æ˜¯å¦ä¼šè¢«æ‹‰ä¼¸</span><br><span class="line">     */</span><br><span class="line">    public static function CreateImage($palette, $dst_w = &apos;&apos;, $dst_h = &apos;&apos;, $bgWidth = &apos;&apos;, $bgHeight = &apos;&apos;)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $info = getimagesize($palette);</span><br><span class="line"></span><br><span class="line">        $backgroundFun = &apos;imagecreatefrom&apos; . image_type_to_extension($info[2], false);</span><br><span class="line">        $background = $backgroundFun($palette);</span><br><span class="line"></span><br><span class="line">        $backgroundWidth = imagesx($background);</span><br><span class="line">        $backgroundHeight = imagesy($background);</span><br><span class="line"></span><br><span class="line">        $imageRes = imageCreatetruecolor($bgWidth ? $bgWidth : $backgroundWidth, $bgHeight ? $bgHeight : $backgroundHeight);</span><br><span class="line">        $color = imagecolorallocate($imageRes, 255, 255, 255);</span><br><span class="line">        // æ­£å¼ä½¿ç”¨ è¿™ä¸ªå®šè¦æ³¨é‡Š</span><br><span class="line">        // imagecolortransparent($imageRes, $color);</span><br><span class="line">        imagefill($imageRes, 0, 0, $color);</span><br><span class="line"></span><br><span class="line">        imagecopyresized($imageRes, $background, 0, 0, 0, 0, $dst_w ? $dst_w : imagesx($background), $dst_h ? $dst_h : imagesy($background), imagesx($background), imagesy($background));</span><br><span class="line"></span><br><span class="line">        return $imageRes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [CreateChars åœ¨ç”»æ¿ä¸­æ’å…¥æ–‡å­—]</span><br><span class="line">     * @param    resource   $image      å›¾ç‰‡æº</span><br><span class="line">     * @param    array      $config     é…ç½®ä¿¡æ¯</span><br><span class="line">     * @param    int        $red        çº¢è‰²</span><br><span class="line">     * @param    int        $green      ç»¿è‰²</span><br><span class="line">     * @param    int        $blue       è“è‰²</span><br><span class="line">     * @param    int        $num        æ¬¡æ•°è¶Šå¤šæ–‡å­—è¶Šç²—</span><br><span class="line">     * @param    int        $size       æ–‡å­—å¤§å°</span><br><span class="line">     * @param    int        $angle      æ—‹è½¬çš„è§’åº¦ é»˜è®¤ä¸æ—‹è½¬ä¸º0</span><br><span class="line">     * @param    int        $x          æ–‡å­—çš„åæ ‡x</span><br><span class="line">     * @param    int        $y          æ–‡å­—çš„åæ ‡y</span><br><span class="line">     * @param    int        $font       å­—ä½“æ–‡ä»¶ è¿™é‡Œä¸€èˆ¬ä¸ºç»å¯¹è·¯å¾„</span><br><span class="line">     * @param    int        $text       æ–‡å­—å†…å®¹</span><br><span class="line">     *</span><br><span class="line">     */</span><br><span class="line">    public static function CreateChars($image, $config)</span><br><span class="line">    &#123;</span><br><span class="line">        //è®¾ç½®æ–‡å­—é¢œè‰²</span><br><span class="line">        $color = imagecolorexactalpha($image, $config[&apos;red&apos;], $config[&apos;green&apos;], $config[&apos;blue&apos;], $config[&apos;alpha&apos;]);</span><br><span class="line">        //å¾ªç¯å¤šæ¬¡ä¸ºäº†åŠ ç²—å­—ä½“</span><br><span class="line">        for ($i = 1; $i &lt;= $config[&apos;num&apos;]; $i++) &#123;</span><br><span class="line"></span><br><span class="line">            imagettftext($image, $config[&apos;size&apos;], $config[&apos;angle&apos;], $config[&apos;x&apos;], $config[&apos;y&apos;], $color, $config[&apos;font&apos;], $config[&apos;text&apos;]);</span><br><span class="line">        &#125;</span><br><span class="line">        return $image;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [CreateLine ç”»ä¸€æ¡å®çº¿]</span><br><span class="line">     * @param    resource   $image      å›¾ç‰‡æº</span><br><span class="line">     * @param    array      $config     æ•°æ®é…ç½®</span><br><span class="line">     * @param    int        $red        çº¢è‰²</span><br><span class="line">     * @param    int        $green      ç»¿è‰²</span><br><span class="line">     * @param    int        $blue       è“è‰²</span><br><span class="line">     * @param    int        $alpha      é€æ˜åº¦ 0ä¸é€æ˜</span><br><span class="line">     * @param    int        $x1 x2      åæ ‡x</span><br><span class="line">     * @param    int        $y1 y2      åæ ‡y</span><br><span class="line">     */</span><br><span class="line">    public static function CreateLine($image, $config)</span><br><span class="line">    &#123;</span><br><span class="line">        //è®¾ç½®çº¿æ¡é¢œè‰²</span><br><span class="line">        $color = imagecolorexactalpha($image, $config[&apos;red&apos;], $config[&apos;green&apos;], $config[&apos;blue&apos;], $config[&apos;alpha&apos;]);</span><br><span class="line">        //åˆ’çº¿</span><br><span class="line">        imageline($image, $config[&apos;x1&apos;], $config[&apos;y1&apos;], $config[&apos;x2&apos;], $config[&apos;y2&apos;], $color);</span><br><span class="line">        return $image;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * [functionName å›¾ç‰‡åˆå¹¶]</span><br><span class="line">     * å°† src_im å›¾åƒä¸­åæ ‡ä» src_xï¼Œsrc_y å¼€å§‹ï¼Œå®½åº¦ä¸º src_wï¼Œé«˜åº¦ä¸º src_h çš„ä¸€éƒ¨åˆ†æ‹·è´åˆ° dst_im å›¾åƒä¸­åæ ‡ä¸º dst_x å’Œ dst_y çš„ä½ç½®ä¸Šã€‚ä¸¤å›¾åƒå°†æ ¹æ® pct</span><br><span class="line">     * æ¥å†³å®šåˆå¹¶ç¨‹åº¦ï¼Œå…¶å€¼èŒƒå›´ä» 0 åˆ° 100ã€‚å½“ pct = 0 æ—¶ï¼Œå®é™…ä¸Šä»€ä¹ˆä¹Ÿæ²¡åšï¼Œå½“ä¸º 100 æ—¶å¯¹äºè°ƒè‰²æ¿å›¾åƒæœ¬å‡½æ•°å’Œ imagecopy() å®Œå…¨ä¸€æ ·ï¼Œå®ƒå¯¹çœŸå½©è‰²å›¾åƒå®ç°äº† alpha *</span><br><span class="line">     * é€æ˜ã€‚</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static function ImagesMerge($mainBg, $second, $config)</span><br><span class="line">    &#123;</span><br><span class="line">        imagecopymerge($mainBg, $second, $config[&apos;dst_x&apos;], $config[&apos;dst_y&apos;], $config[&apos;src_x&apos;], $config[&apos;src_y&apos;], $config[&apos;src_w&apos;], $config[&apos;src_h&apos;], $config[&apos;pct&apos;]);</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * [AutoWrap æ–‡å­—æ¢è¡Œ]</span><br><span class="line">     * @param    int        $fontsize   å­—ä½“å¤§å°</span><br><span class="line">     * @param    int        $angle      è§’åº¦å¤§å°</span><br><span class="line">     * @param    int        $fontface   å­—ä½“æ–‡ä»¶</span><br><span class="line">     * @param    string     $string     æ–‡å­—å†…å®¹</span><br><span class="line">     * @param    width      $width      æœ€å¤§å®½åº¦ ä¹Ÿå°±æ˜¯è¾¾åˆ°è¿™ä¸ªå®½åº¦ä¹‹åä¼šæ¢è¡Œ</span><br><span class="line">     */</span><br><span class="line">    public static function AutoWrap($fontsize, $angle, $fontface, $string, $width)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $content = &quot;&quot;;</span><br><span class="line">        // å°†å­—ç¬¦ä¸²æ‹†åˆ†æˆä¸€ä¸ªä¸ªå•å­— ä¿å­˜åˆ°æ•°ç»„ letter ä¸­</span><br><span class="line">        for ($i = 0; $i &lt; mb_strlen($string); $i++) &#123;</span><br><span class="line">            $letter[] = mb_substr($string, $i, 1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        foreach ($letter as $l) &#123;</span><br><span class="line">            $teststr = $content . &quot;&quot; . $l;</span><br><span class="line">            $testbox = imagettfbbox($fontsize, $angle, $fontface, $teststr);</span><br><span class="line">            // åˆ¤æ–­æ‹¼æ¥åçš„å­—ç¬¦ä¸²æ˜¯å¦è¶…è¿‡é¢„è®¾çš„å®½åº¦</span><br><span class="line">            if (($testbox[2] &gt; $width) &amp;&amp; ($content !== &quot;&quot;)) &#123;</span><br><span class="line">                $content .= &quot;\n&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">            $content .= $l;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $content = mb_convert_encoding($content, &quot;html-entities&quot;, &quot;utf-8&quot;);</span><br><span class="line"></span><br><span class="line">        return $content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [getInfo è·å–å›¾ç‰‡ä¿¡æ¯]</span><br><span class="line">     * @param    url        $name       å›¾ç‰‡åœ°å€</span><br><span class="line">     * @return   array</span><br><span class="line">     */</span><br><span class="line">    public static function getInfo($name)</span><br><span class="line">    &#123;</span><br><span class="line">        $info = getimagesize($name);</span><br><span class="line"></span><br><span class="line">        $width = $info[0];</span><br><span class="line">        $height = $info[1];</span><br><span class="line">        $mime = $info[&apos;mime&apos;];</span><br><span class="line">        switch ($mime) &#123;</span><br><span class="line">            case &apos;image/jpeg&apos;:</span><br><span class="line">                $res = imagecreatefromjpeg($name);</span><br><span class="line">                break;</span><br><span class="line">            case &apos;image/gif&apos;:</span><br><span class="line">                $res = imagecreatefromgif($name);</span><br><span class="line">                break;</span><br><span class="line">            case &apos;image/png&apos;:</span><br><span class="line">                $res = imagecreatefrompng($name);</span><br><span class="line">                break;</span><br><span class="line">            case &apos;image/wbmp&apos;:</span><br><span class="line">                $res = imagecreatefromwbmp($name);</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">        return array(&apos;width&apos; =&gt; $width, &apos;height&apos; =&gt; $height, &apos;res&apos; =&gt; $res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [look åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºå›¾ç‰‡]</span><br><span class="line">     * @param    resource   $imageRes   å›¾ç‰‡æº</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static function look($imageRes)</span><br><span class="line">    &#123;</span><br><span class="line">        header(&quot;Content-type:image/png&quot;);</span><br><span class="line">        imagejpeg($imageRes);</span><br><span class="line">        imagedestroy($imageRes);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * [load ä¸‹è½½å›¾ç‰‡]</span><br><span class="line">     * @param    resource   $img  å›¾ç‰‡æº</span><br><span class="line">     * @param    url        $name ä¸»å›¾åœ°å€</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static function load($img, $name)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        $info = self::getInfo($name);</span><br><span class="line"></span><br><span class="line">        $ext = pathinfo($name, PATHINFO_EXTENSION);</span><br><span class="line">        $file_path = &apos;./&apos; . date(&apos;Y-m-d&apos;);</span><br><span class="line"></span><br><span class="line">        if (!file_exists($file_path)) &#123;</span><br><span class="line">            mkdir($file_path, 0777, true);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $rand_name = $file_path . &apos;/&apos; . md5(mt_rand() . time()) . &quot;.&quot; . $ext;</span><br><span class="line"></span><br><span class="line">        switch ($ext) &#123;</span><br><span class="line">            case &apos;jpg&apos;:</span><br><span class="line">            case &apos;jpeg&apos;:</span><br><span class="line">            case &apos;jpe&apos;:</span><br><span class="line">                imagejpeg($img, $rand_name);</span><br><span class="line">                break;</span><br><span class="line">            case &apos;png&apos;:</span><br><span class="line">                imagepng($img, $rand_name);</span><br><span class="line">                break;</span><br><span class="line">            case &apos;gif&apos;:</span><br><span class="line">                imagegif($img, $rand_name);</span><br><span class="line">                break;</span><br><span class="line">            case &apos;bmp&apos;:</span><br><span class="line">            case &apos;wbmp&apos;:</span><br><span class="line">                imagewbmp($img, $rand_name);</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">        //é”€æ¯èµ„æº</span><br><span class="line">        imagedestroy($info[&apos;res&apos;]);</span><br><span class="line">        imagedestroy($img);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨htpasswdä¸ºwebç½‘ç«™å¢åŠ å®‰å…¨æ€§</title>
      <link href="/%E4%BD%BF%E7%94%A8htpasswd%E4%B8%BAweb%E7%BD%91%E7%AB%99%E5%A2%9E%E5%8A%A0%E5%AE%89%E5%85%A8%E6%80%A7/"/>
      <url>/%E4%BD%BF%E7%94%A8htpasswd%E4%B8%BAweb%E7%BD%91%E7%AB%99%E5%A2%9E%E5%8A%A0%E5%AE%89%E5%85%A8%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸€.å¼•è¨€</p></blockquote><font color="#ff5722">ä»€ä¹ˆæ˜¯ htpasswd ?</font><br>&emsp;(1)htpasswdæ˜¯å¼€æº http æœåŠ¡å™¨apache httpdçš„ä¸€ä¸ªå‘½ä»¤å·¥å…·ï¼Œç”¨äºç”Ÿæˆ http åŸºæœ¬è®¤è¯çš„å¯†ç æ–‡ä»¶ã€‚<br>&emsp;(2)nginxåº•å±‚æä¾›äº† <a href="http://www.nginx.cn/doc/standard/httpauthbasic.html" target="_blank" rel="noopener">HttpAuthBasic</a>æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æ”¯æŒæœ€åŸºæœ¬çš„httpè®¤è¯ï¼Œè¿™æ˜¯httpåè®®æ”¯æŒçš„ã€‚å½“ä½ è®¿é—®ç½‘ç«™æ—¶å€™ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†è¦æ±‚ä½ è¾“å…¥è´¦å·å¯†ç ,åªè¦è¾“å…¥æ­£ç¡®æ‰èƒ½è®¿é—®å¯¹åº”çš„ç½‘ç«™ã€‚<br><font color="#ff5722">å¦‚æœè®¤è¯å¤±è´¥ä¼šæ€ä¹ˆæ · ?</font><br><a id="more"></a><br><img src="/ä½¿ç”¨htpasswdä¸ºwebç½‘ç«™å¢åŠ å®‰å…¨æ€§/img/htpasswd.png"><br><font color="#ff5722">è¿™æ ·åšçš„ç›®çš„æ˜¯ä»€ä¹ˆ ?</font><br>&emsp;(1)ä¸ºäº†ç¦æ­¢è®¿é—®ç‰¹æ®Šçš„ç½‘é¡µ(è¿™é‡Œæš‚æ—¶è¿˜æ²¡äº†è§£åˆ°ç‰¹æ®Šçš„ç”¨æ³•â€¦ä¹‹åå†è¡¥å……)<br>&emsp;(2)æ˜¯çš„,æˆ‘ç”¨è¿™ä¸ªçš„åŸå› æ˜¯ä¸ºwalleé¡¹ç›®å®‰å…¨è€ƒè™‘çš„,å› ä¸ºwalleå®˜æ–¹æ¨èä¸ºäº†å®‰å…¨å°½é‡æ”¾åœ¨å†…ç½‘(è¿™é‡Œåº”è¯¥æ˜¯ä¸ºäº†é˜²æ­¢æš´åŠ›ç ´è§£),ä¹‹å‰çš„çš„åšæ–‡ä¹Ÿæœ‰è®²åˆ°å¯ä»¥ä½¿ç”¨åŒå‘è®¤è¯,ä½†æ˜¯å¯¹åˆå­¦è€…è€Œè¨€æ˜¯å¾ˆä¸å‹å¥½ã€æœ‰ç‚¹éº»çƒ¦çš„,é‚£ä¹ˆè¿™ä¸ªhtpasswdå°±éå¸¸ä¹‹ç®€å•äº†ï¼Œå°±æ˜¯æ•¢æ•¢å•å•ã€‚å“ï¼åä¸‹åä¸‹è¿™æ˜¯åŸºæ“ã€‚<br><blockquote><p>äºŒ.å®‰è£…&amp;&amp;é…ç½®</p></blockquote><br>&emsp;ç¬¬ä¸€æ­¥:æ£€æµ‹æ˜¯å¦å·²ç»å®‰è£…äº† httpd<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#httpd -v</span><br><span class="line">Server version: Apache/2.4.6 (CentOS)</span><br><span class="line">Server built:   Apr 24 2019 13:45:48</span><br><span class="line"></span><br><span class="line">#æ²¡å®‰è£…çš„æ‰§è¡Œ</span><br><span class="line">#yum -y install httpd </span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬äºŒæ­¥:åˆ›å»ºç”¨æˆ·<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#è¿™é‡Œå¿…é¡»æ˜¯nginxçš„å®‰è£…ç›®å½•.passwdåé¢æ˜¯ è´¦å· å¯†ç </span><br><span class="line"></span><br><span class="line">#htpasswd -bc /etc/nginx/.passwd daichongweb daichongweb</span><br><span class="line">#ç”ŸæˆæˆåŠŸ:Adding password for user daichongweb</span><br><span class="line"></span><br><span class="line">#æ³¨æ„:ä¸åŒçš„æœºå­å¯èƒ½nginxä¸‹çš„æ–‡ä»¶ä¸åŒæœ‰çš„äººæ˜¯.htpasswd</span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬ä¸‰æ­¥:nginxé…ç½®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location  /  &#123;</span><br><span class="line">auth_basic            &quot;è¿™é‡Œéšæ„èµ·ä¸ªåå­—&quot;;</span><br><span class="line">auth_basic_user_file  /etc/nginx/.passwd;#è¿™é‡Œæ˜¯nginxå®‰è£…ç›®å½•ä¸‹çš„å¯†ç æ–‡ä»¶</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬å››æ­¥:æ£€æµ‹é…ç½®&amp;&amp;é‡å¯æœåŠ¡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#nginx -t</span><br><span class="line"></span><br><span class="line">#nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</span><br><span class="line">#nginx: configuration file /etc/nginx/nginx.conf test is successful</span><br><span class="line"></span><br><span class="line">#é‡å¯</span><br><span class="line">#nginx -s reload</span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬äº”æ­¥:è®¿é—®åŸŸåæµ‹è¯•<br><img src="/ä½¿ç”¨htpasswdä¸ºwebç½‘ç«™å¢åŠ å®‰å…¨æ€§/img/htpasswd1.png"><br><blockquote><p>ä¸‰.å…¶ä»–æ“ä½œ</p></blockquote><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#åˆ é™¤ç”¨æˆ·</span><br><span class="line">#htpasswd -D /etc/nginx/.passwd daichongweb</span><br><span class="line"></span><br><span class="line">#ä¿®æ”¹å¯†ç </span><br><span class="line">#htpasswd -d /etc/nginx/.passwd daichongweb123</span><br><span class="line"></span><br><span class="line">#å…¶ä»–å‘½ä»¤</span><br><span class="line">-cï¼šåˆ›å»ºä¸€ä¸ªåŠ å¯†æ–‡ä»¶</span><br><span class="line">-nï¼šä¸æ›´æ–°åŠ å¯†æ–‡ä»¶ï¼Œåªå°†åŠ å¯†åçš„ç”¨æˆ·åå¯†ç æ˜¾ç¤ºåœ¨å±å¹•ä¸Š</span><br><span class="line">-mï¼šé»˜è®¤é‡‡ç”¨MD5ç®—æ³•å¯¹å¯†ç è¿›è¡ŒåŠ å¯†</span><br><span class="line">-dï¼šé‡‡ç”¨CRYPTç®—æ³•å¯¹å¯†ç è¿›è¡ŒåŠ å¯†</span><br><span class="line">-pï¼šä¸å¯¹å¯†ç è¿›è¡Œè¿›è¡ŒåŠ å¯†ï¼Œå³æ˜æ–‡å¯†ç </span><br><span class="line">-sï¼šé‡‡ç”¨SHAç®—æ³•å¯¹å¯†ç è¿›è¡ŒåŠ å¯†</span><br><span class="line">-bï¼šåœ¨å‘½ä»¤è¡Œä¸­ä¸€å¹¶è¾“å…¥ç”¨æˆ·åå’Œå¯†ç è€Œä¸æ˜¯æ ¹æ®æç¤ºè¾“å…¥å¯†ç </span><br><span class="line">-Dï¼šåˆ é™¤æŒ‡å®šçš„ç”¨æˆ·</span><br></pre></td></tr></table></figure><br><font color="#ff5722">æœ¬ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ„Ÿè°¢å¤§å®¶çš„æ”¯æŒï¼</font>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€åŸåˆ›ã€‘ç”¨jqueryåšçˆ¬è™«</title>
      <link href="/%E7%94%A8jquery%E5%81%9A%E7%88%AC%E8%99%AB/"/>
      <url>/%E7%94%A8jquery%E5%81%9A%E7%88%AC%E8%99%AB/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å¼•è¨€</p></blockquote><p>&emsp;ä¹‹å‰å…¬å¸æœ‰éœ€æ±‚è¦åšä¸€ä¸ªé‡‡é›†ä¿¡æ¯çš„å·¥å…·,åŒ…æ‹¬è·å–å•†å“ä¿¡æ¯å¯¼å…¥æ•°æ®åº“,æ¯”ä»·ä»€ä¹ˆçš„åŠŸèƒ½,æ²¡åŠæ³•åªèƒ½å°è¯•è¿™åšä¸€ä¸‹ã€‚<br>&emsp;è€ƒè™‘åˆ°æ˜¯åšå®šå‘çˆ¬å–,æˆ‘å°±é€‰æ‹©äº†jquery,å› ä¸ºjqueryç›¸æ¯”å…¶ä»–è¯­è¨€åšçˆ¬è™«æ˜¯ç®€å•è½»æ¾å¾ˆå¤šã€‚<br><blockquote><p>ä¸åŒè¯­è¨€è‡ªç„¶ä¼šæœ‰ä¸åŒç”¨å¤„ã€‚ç¦»å¼€ç¯å¢ƒè°ˆå“ªä¸ªå¥½ï¼Œå“ªä¸ªä¸å¥½éƒ½æ˜¯è€æµæ°“ã€‚<br>1ï¼Œå¦‚æœæ˜¯è‡ªå·±åšç€ç©çš„è¯ï¼Œå®šå‘çˆ¬å‡ ä¸ªé¡µé¢ï¼Œæ•ˆç‡ä¸æ˜¯æ ¸å¿ƒè¦æ±‚çš„è¯ï¼Œé—®é¢˜ä¸ä¼šå¤§ï¼Œä»€ä¹ˆè¯­è¨€éƒ½è¡Œçš„ï¼Œæ€§èƒ½å·®å¼‚ä¸ä¼šå¤§ã€‚å½“ç„¶ï¼Œå¦‚æœç¢°åˆ°ååˆ†å¤æ‚çš„é¡µé¢ï¼Œæ­£åˆ™å†™çš„å¾ˆå¤æ‚çš„è¯ï¼Œçˆ¬è™«çš„å¯ç»´æŠ¤æ€§å°±ä¼šä¸‹é™ã€‚<br><a id="more"></a><br>2ï¼Œå¦‚æœæ˜¯åšå®šå‘çˆ¬å–ï¼Œè€Œç›®æ ‡åˆè¦è§£æåŠ¨æ€jsã€‚<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œç”¨æ™®é€šçš„è¯·æ±‚é¡µé¢ï¼Œç„¶åå¾—åˆ°å†…å®¹çš„æ–¹æ³•è‚¯å®šä¸è¡Œäº†ï¼Œå°±è¦ä¸€ä¸ªç±»ä¼¼firfoxï¼Œchromeçš„jså¼•æ“æ¥å¯¹jsä»£ç åšåŠ¨æ€è§£æã€‚è¿™ä¸ªæ—¶å€™æ¨ècasperJS+phantomjsæˆ–slimerJS+phantomjs</p><p></p><p><br>3ï¼Œå¦‚æœæ˜¯å¤§è§„æ¨¡çš„ç½‘ç«™çˆ¬å–ã€‚<br>è¿™ä¸ªæ—¶å€™å°±è¦è€ƒè™‘åˆ°ï¼Œæ•ˆç‡ï¼Œæ‰©å±•æ€§ï¼Œå¯ç»´æŠ¤æ€§ï¼Œç­‰ç­‰äº†ã€‚<br>å¤§è§„æ¨¡çš„çˆ¬å–æ¶‰åŠçš„æ–¹é¢å¾ˆå¤šï¼Œæ¯”å¦‚åˆ†å¸ƒå¼çˆ¬å–ï¼Œåˆ¤é‡æœºåˆ¶ï¼Œä»»åŠ¡è°ƒåº¦ã€‚è¿™äº›é—®é¢˜æ·±å…¥ä¸‹å»å“ªä¸€ä¸ªç®€å•äº†ï¼Ÿ<br>è¯­è¨€é€‰å–è¿™ä¸ªæ—¶å€™å¾ˆé‡è¦ã€‚<br>NodeJsï¼šåšçˆ¬è™«æ•ˆç‡å¾ˆé«˜ã€‚é«˜å¹¶å‘ï¼Œå¤šçº¿ç¨‹ç¼–ç¨‹å˜æˆäº†ç®€å•çš„éå†å’Œcallbackï¼Œå†…å­˜cpuå ç”¨å°ï¼Œè¦å¤„ç†å¥½callbackã€‚</p><p>PHPï¼šå„ç§æ¡†æ¶åˆ°å¤„æœ‰ï¼Œéšä¾¿æ‹‰ä¸ªæ¥ç”¨éƒ½è¡Œã€‚ä½†æ˜¯ï¼ŒPHPçš„æ•ˆç‡çœŸçš„æœ‰é—®é¢˜â€¦ä¸å¤šè¯´<br>Python:æˆ‘ç”¨pythonå†™çš„æ¯”è¾ƒå¤šï¼Œå¯¹å„ç§é—®é¢˜éƒ½æœ‰æ¯”è¾ƒå¥½çš„æ”¯æŒã€‚scrapyæ¡†æ¶å¾ˆå¥½ç”¨ï¼Œä¼˜ç‚¹å¤šã€‚<br>æˆ‘è§‰å¾—jsä¹Ÿä¸æ˜¯å¾ˆé€‚åˆå†™â€¦æ•ˆç‡é—®é¢˜ã€‚æ²¡å†™è¿‡ï¼Œä¼°è®¡ä¼šæœ‰éº»çƒ¦ä¸€å †ã€‚<br>æ®æˆ‘çŸ¥é“çš„ï¼Œå¤§å…¬å¸ä¹Ÿæœ‰ç”¨c++çš„ï¼Œæ€»ä¹‹å¤§å¤šæ•°éƒ½æ˜¯åœ¨å¼€æºæ¡†æ¶ä¸Šæ”¹é€ ã€‚çœŸé‡æ–°é€ ä¸ªè½®å­çš„ä¸å¤šå§ã€‚<br>ä¸å€¼ã€‚</p><footer><strong>æ¥è‡ªsegmentfault</strong><cite>ä¸€ä½å¤§ä½¬</cite></footer></blockquote><br><blockquote><p>jqueryå®ç°</p></blockquote><br><figure class="highlight plain"><figcaption><span>æŠ“å–ä»£ç </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">javascript: (function() &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        var Arr = &#123;</span><br><span class="line">            &apos;name&apos;: getTitle(),</span><br><span class="line">            &apos;img&apos;: getImgs(),</span><br><span class="line">            &apos;price&apos;: getPirce(),</span><br><span class="line">            &apos;sku&apos;: getSku(),</span><br><span class="line">            &apos;desc&apos;: getDesc(),</span><br><span class="line">        &#125;;</span><br><span class="line">        //è·å–å›¾ç‰‡</span><br><span class="line">        function getImgs() &#123;</span><br><span class="line">            var imgArr = [];</span><br><span class="line">            $(&quot;#dt-tab ul li&quot;).each(function(k, v) &#123;</span><br><span class="line">                var imgJson = JSON.parse($(v).attr(&apos;data-imgs&apos;));</span><br><span class="line">                if (imgJson) &#123;</span><br><span class="line">                    imgArr.push(imgJson.preview);</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;);</span><br><span class="line">            return imgArr;</span><br><span class="line">        &#125;;</span><br><span class="line">        //è·å–åç§°</span><br><span class="line">        function getTitle() &#123;</span><br><span class="line">            var _this = $(&apos;#mod-detail-title .d-title&apos;);</span><br><span class="line">            return _this.html();</span><br><span class="line">        &#125;;</span><br><span class="line">        //è·å–ä»·æ ¼</span><br><span class="line">        function getPirce() &#123;</span><br><span class="line">            var _this = $(&quot;#mod-detail-price .price .ladder-3-1&quot;);</span><br><span class="line">            var priceJson = JSON.parse(_this.attr(&apos;data-range&apos;));</span><br><span class="line">            return priceJson.price;</span><br><span class="line">        &#125;;</span><br><span class="line">        //è·å–skuå±æ€§</span><br><span class="line">        function getSku() &#123;</span><br><span class="line">            var skuArr = [];</span><br><span class="line">            var _this = $(&quot;.obj-sku .table-sku tr&quot;);</span><br><span class="line">            if (_this) &#123;</span><br><span class="line">                var step = 0;</span><br><span class="line">                _this.each(function(k, v) &#123;</span><br><span class="line">                    step++;</span><br><span class="line">                    skuArr.push(&#123;</span><br><span class="line">                        &apos;sku_name&apos;: $(v).find(&apos;.name span&apos;).html(),</span><br><span class="line">                        &apos;price&apos;: $(v).find(&apos;.price span .value&apos;).html(),</span><br><span class="line">                        &apos;img&apos;: getSkuImg(step),</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;;</span><br><span class="line">            return skuArr;</span><br><span class="line">        &#125;;</span><br><span class="line">        //è·å–å•†å“è¯¦æƒ…</span><br><span class="line">        function getDesc() &#123;</span><br><span class="line">            var descArr = [];</span><br><span class="line">            var _this = $(&quot;#mod-detail-description img&quot;);</span><br><span class="line">            if (_this) &#123;</span><br><span class="line">                _this.each(function(k, v) &#123;</span><br><span class="line">                    var url = $(v).attr(&apos;src&apos;);</span><br><span class="line">                    var patt = new RegExp(&quot;[a-zA-z]+://[^\s]*&quot;);</span><br><span class="line">                    if(patt.test(url))&#123;</span><br><span class="line">                        descArr.push(url);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;;</span><br><span class="line">            return descArr;</span><br><span class="line">        &#125;;</span><br><span class="line">        //è·å–skuå›¾ç‰‡</span><br><span class="line">        function getSkuImg(step) &#123;</span><br><span class="line">            if ($(&quot;#dt-tab ul li&quot;) &amp;&amp; $(&quot;.obj-sku .table-sku tr&quot;)) &#123;</span><br><span class="line">                return $(&quot;#dt-tab ul li:eq(&quot; + step + &quot;) .box-img img&quot;).attr(&apos;src&apos;);</span><br><span class="line">            &#125;;</span><br><span class="line">            return &apos;&apos;;</span><br><span class="line">        &#125;;</span><br><span class="line">        if(confirm(&apos;è·å–æˆåŠŸï¼Œç¡®è®¤è¦é‡‡é›†å—ï¼Ÿ&apos;)==true)&#123;</span><br><span class="line">            console.log(Arr);</span><br><span class="line">            return false;</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                type:&quot;post&quot;,</span><br><span class="line">                url:&apos;www.daichongweb.com&apos;,</span><br><span class="line">                data:&#123;</span><br><span class="line">                    post:Arr</span><br><span class="line">                &#125;,</span><br><span class="line">                dataType:&apos;json&apos;,</span><br><span class="line">                success:function(res)&#123;</span><br><span class="line">                    if(res.code==0)&#123;</span><br><span class="line">                        alert(&apos;é‡‡é›†æˆåŠŸï¼&apos;);</span><br><span class="line">                    &#125;else&#123;</span><br><span class="line">                        alert(res.message);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,error:function(res)&#123;</span><br><span class="line">                    alert(&apos;é‡‡é›†å¤±è´¥ï¼&apos;);</span><br><span class="line">                &#125;,beforeSend:function(res)&#123;</span><br><span class="line">                    $(&apos;body&apos;).append(&apos;&lt;div id=&quot;daichongweb&quot; style=&quot;position:fixed;top:0;left:0;background: rgba(0, 0, 0, .5);text-align: center;line-height: 20;font-size: 30px;color: white;width:100vw;height:100vh;z-index:1000000000;&quot;&gt;é‡‡é›†ä¸­ï¼&lt;/div&gt;&apos;);</span><br><span class="line">                &#125;,complete:function(res)&#123;</span><br><span class="line">                    $(&quot;#daichongweb&quot;).remove();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (err) &#123;</span><br><span class="line">        alert(err);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><br><a href="https://detail.1688.com/offer/532767414753.html?spm=a312h.2018_new_sem.dh_002.9.4182da6cBnSleC&tracelog=p4p&clickid=b71344bc8a2845a89bec27e826ef5244&sessionid=ca394d2c134b91816dc881204b47063c" target="_blank" rel="noopener">å®šå‘å•†å“é“¾æ¥->1688.com</a>&emsp;å½“ç„¶äº†,è¿™ä¸ªé‡‡é›†ä»£ç ä¸åªæ˜¯é’ˆå¯¹è¿™ä¸€ä¸ªå•†å“,å®ƒå¯ä»¥æŠ“å–å’Œä»–é¡µé¢ç»“æ„ä¸€æ ·çš„æ‰€æœ‰å•†å“ã€‚</p><p><font color="#ff5722">PS:è¿™é‡Œçš„æŠ“å–å¯æ ¹æ®è‡ªå·±çš„å®é™…ä¸šåŠ¡æ¥æ”¹å˜,æ¯”å¦‚éœ€è¦è®©é¡µé¢ä¸­çš„è½®æ’­å›¾åˆ‡æ¢è¿™ä¸ªæ‰èƒ½è·å–,é‚£å°±åœ¨æŠ“å–ä¹‹å‰å†™ä¸ªåˆ‡æ¢çš„è„šæœ¬;åˆ‡æ¢ä¸€å¼ æŠ“å–ä¸€å¼ ;</font><br><blockquote><p>æ€ä¹ˆæ‰èƒ½åœ¨è°·æ­Œä¸­è¿è¡Œè¿™ä¸ªè„šæœ¬</p></blockquote><br>&emsp;æ–¹æ³•ä¸€ï¼šç›´æ¥æ”¾åœ¨æ§åˆ¶å°(è¿™é‡Œå¹¶ä¸æ¨èä½¿ç”¨,å› ä¸ºå…¬å¸çš„äººä¸å¯èƒ½éƒ½æ‡‚ä»£ç ,è€Œä¸”æ“ä½œéº»çƒ¦)ã€‚<br>&emsp;æ–¹æ³•äºŒï¼šåœ¨æµè§ˆå™¨ä¸­æ·»åŠ ä¹¦ç­¾,æŠŠä»£ç å¤åˆ¶åˆ°ç½‘å€æ é‡Œ,è¦é‡‡é›†çš„æ—¶å€™ç‚¹å‡»ä¸€ä¸‹å°±okäº†ï¼<br><img src="/ç”¨jqueryåšçˆ¬è™«/img/jquery.png"></p><p><font color="#ff5722">PS:æ•´ä½“è¿ç”¨æƒ…å†µçœ‹,ä¸ªäººè§‰å¾—jqueryåšé‡‡é›†è¿˜æ˜¯æŒºä¸é”™çš„ã€‚å½“ç„¶ç›¸æ¯”phpã€pythonçš„è¯æ˜¾å¾—æœ‰ç‚¹ä½ç«¯çš„æ„Ÿè§‰,é‚£ä¹Ÿæ²¡åŠæ³•è°è®©phpã€pythonæ˜¯åŠ¨æ€è·å–çš„å‘¢?</font><br>ä¹‹åä¼šç”¨phpæˆ–pythonåšä¸ªä¸€ä¸ªåŠ¨æ€æŠ“å–çš„è„šæœ¬,å½“ç„¶ä¹ŸåŒ…æ‹¬æ¯”ä»·ä¹‹ç±»çš„è¿ç”¨â€¦..<br><blockquote><p>åç«¯å¤„ç†æ•°æ®(å¯å¿½ç•¥)</p></blockquote><br><figure class="highlight php"><figcaption><span>phpå¤„ç†</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">'./oss/autoload.php'</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">OSS</span>\<span class="title">OssClient</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">OSS</span>\<span class="title">Core</span>\<span class="title">OssException</span>;</span><br><span class="line"></span><br><span class="line">header(<span class="string">'Content-Type: text/html;charset=utf-8'</span>);</span><br><span class="line">header(<span class="string">'Access-Control-Allow-Origin:*'</span>); <span class="comment">// *ä»£è¡¨å…è®¸ä»»ä½•ç½‘å€è¯·æ±‚</span></span><br><span class="line">header(<span class="string">'Access-Control-Allow-Methods:POST,GET,OPTIONS,DELETE'</span>); <span class="comment">// å…è®¸è¯·æ±‚çš„ç±»å‹</span></span><br><span class="line">header(<span class="string">'Access-Control-Allow-Credentials: true'</span>); <span class="comment">// è®¾ç½®æ˜¯å¦å…è®¸å‘é€ cookies</span></span><br><span class="line">header(<span class="string">'Access-Control-Allow-Headers: Content-Type,Content-Length,Accept-Encoding,X-Requested-with, Origin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST)&#123;</span><br><span class="line"></span><br><span class="line">$post = $_POST[<span class="string">'post'</span>];</span><br><span class="line"><span class="keyword">if</span>($post)&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤„ç†å¤§å›¾</span></span><br><span class="line">$imgArr = $post[<span class="string">'img'</span>];</span><br><span class="line"><span class="keyword">if</span>($imgArr)&#123;</span><br><span class="line"><span class="keyword">foreach</span> ($imgArr <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">$name = saveImgToLocal($v);</span><br><span class="line">$ossPath = <span class="string">'collect/'</span>.date(<span class="string">'Ym'</span>).<span class="string">'/'</span>.$name;</span><br><span class="line">uploadImgOss($ossPath,<span class="string">'./img/'</span>.$name);</span><br><span class="line">$imgArr[$k] = $ossPath;</span><br><span class="line">&#125;</span><br><span class="line">$post[<span class="string">'img'</span>] = $imgArr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(array_key_exists(<span class="string">'sku'</span>, $post))&#123;</span><br><span class="line"><span class="comment">//å¤„ç†å°å›¾</span></span><br><span class="line">$sku = $post[<span class="string">'sku'</span>];</span><br><span class="line"><span class="keyword">if</span>($sku)&#123;</span><br><span class="line"><span class="keyword">foreach</span> ($sku <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">$name = saveImgToLocal($v[<span class="string">'img'</span>]);</span><br><span class="line">$ossPath = <span class="string">'collect/'</span>.date(<span class="string">'Ym'</span>).<span class="string">'/'</span>.$name;</span><br><span class="line">uploadImgOss($ossPath,<span class="string">'./img/'</span>.$name);</span><br><span class="line">$sku[$k][<span class="string">'img'</span>] = $ossPath;</span><br><span class="line">&#125;</span><br><span class="line">$post[<span class="string">'sku'</span>] = $sku;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(array_key_exists(<span class="string">'desc'</span>, $post))&#123;</span><br><span class="line"><span class="comment">//å¤„ç†è¯¦æƒ…å›¾</span></span><br><span class="line">$desc = $post[<span class="string">'desc'</span>];</span><br><span class="line"><span class="keyword">if</span>($desc)&#123;</span><br><span class="line"><span class="keyword">foreach</span> ($desc <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">$name = saveImgToLocal($v);</span><br><span class="line">$ossPath = <span class="string">'collect/'</span>.date(<span class="string">'Ym'</span>).<span class="string">'/'</span>.$name;</span><br><span class="line">uploadImgOss($ossPath,<span class="string">'./img/'</span>.$name);</span><br><span class="line">$desc[$k] = $ossPath;</span><br><span class="line">&#125;</span><br><span class="line">$post[<span class="string">'desc'</span>] = $desc;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">$Db = mysqli_connect(<span class="string">"127.0.0.1"</span>,<span class="string">"root"</span>,<span class="string">"daichongweb"</span>,<span class="string">"shop"</span>);</span><br><span class="line"><span class="keyword">if</span> (mysqli_connect_errno($Db)) </span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"è¿æ¥ MySQL å¤±è´¥: "</span> . mysqli_connect_error(); </span><br><span class="line">&#125;</span><br><span class="line">insertDb($Db,$post);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">saveImgToLocal</span><span class="params">($telefile,$path=<span class="string">'./img/'</span>)</span></span>&#123;</span><br><span class="line">$ch = curl_init();</span><br><span class="line">    curl_setopt($ch, CURLOPT_URL, $telefile);</span><br><span class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, <span class="number">120</span>);</span><br><span class="line">    $file = curl_exec($ch);</span><br><span class="line">    curl_close($ch);</span><br><span class="line"></span><br><span class="line">    $filename = pathinfo($telefile, PATHINFO_BASENAME);</span><br><span class="line">    $resource = fopen($path . $filename, <span class="string">'a'</span>);</span><br><span class="line">    fwrite($resource, $file);</span><br><span class="line">    fclose($resource);</span><br><span class="line">    <span class="keyword">return</span> $filename;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¸Šä¼ å›¾ç‰‡çš„oss</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uploadImgOss</span><span class="params">($object,$filePath)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">$accessKeyId = <span class="string">"é˜¿é‡ŒossKeyID"</span>;</span><br><span class="line">$accessKeySecret = é˜¿é‡ŒossKeySecret;</span><br><span class="line">$endpoint = <span class="string">"é¡¹ç›®åœ°å€"</span>;</span><br><span class="line">$bucket = <span class="string">"é¡¹ç›®åç§°"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    $ossClient = <span class="keyword">new</span> OssClient($accessKeyId, $accessKeySecret, $endpoint);</span><br><span class="line">   $ossClient-&gt;uploadFile($bucket, $object, $filePath);</span><br><span class="line">&#125; <span class="keyword">catch</span>(OssException $e) &#123;</span><br><span class="line">   print_r($e-&gt;getMessage());</span><br><span class="line">   <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* è·å¾—éšæœºå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $len             éœ€è¦çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $special        æ˜¯å¦éœ€è¦ç‰¹æ®Šç¬¦å·</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> string       è¿”å›éšæœºå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandomStr</span><span class="params">($len, $special = false)</span></span>&#123;</span><br><span class="line">$chars = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>, <span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"i"</span>, <span class="string">"j"</span>, <span class="string">"k"</span>,</span><br><span class="line">    <span class="string">"l"</span>, <span class="string">"m"</span>, <span class="string">"n"</span>, <span class="string">"o"</span>, <span class="string">"p"</span>, <span class="string">"q"</span>, <span class="string">"r"</span>, <span class="string">"s"</span>, <span class="string">"t"</span>, <span class="string">"u"</span>, <span class="string">"v"</span>,</span><br><span class="line">    <span class="string">"w"</span>, <span class="string">"x"</span>, <span class="string">"y"</span>, <span class="string">"z"</span>, <span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"G"</span>,</span><br><span class="line">    <span class="string">"H"</span>, <span class="string">"I"</span>, <span class="string">"J"</span>, <span class="string">"K"</span>, <span class="string">"L"</span>, <span class="string">"M"</span>, <span class="string">"N"</span>, <span class="string">"O"</span>, <span class="string">"P"</span>, <span class="string">"Q"</span>, <span class="string">"R"</span>,</span><br><span class="line">    <span class="string">"S"</span>, <span class="string">"T"</span>, <span class="string">"U"</span>, <span class="string">"V"</span>, <span class="string">"W"</span>, <span class="string">"X"</span>, <span class="string">"Y"</span>, <span class="string">"Z"</span>, <span class="string">"0"</span>, <span class="string">"1"</span>, <span class="string">"2"</span>,</span><br><span class="line">    <span class="string">"3"</span>, <span class="string">"4"</span>, <span class="string">"5"</span>, <span class="string">"6"</span>, <span class="string">"7"</span>, <span class="string">"8"</span>, <span class="string">"9"</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>($special)&#123;</span><br><span class="line">    $chars = array_merge($chars, <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">"!"</span>, <span class="string">"@"</span>, <span class="string">"#"</span>, <span class="string">"$"</span>, <span class="string">"?"</span>, <span class="string">"|"</span>, <span class="string">"&#123;"</span>, <span class="string">"/"</span>, <span class="string">":"</span>, <span class="string">";"</span>,</span><br><span class="line">        <span class="string">"%"</span>, <span class="string">"^"</span>, <span class="string">"&amp;"</span>, <span class="string">"*"</span>, <span class="string">"("</span>, <span class="string">")"</span>, <span class="string">"-"</span>, <span class="string">"_"</span>, <span class="string">"["</span>, <span class="string">"]"</span>,</span><br><span class="line">        <span class="string">"&#125;"</span>, <span class="string">"&lt;"</span>, <span class="string">"&gt;"</span>, <span class="string">"~"</span>, <span class="string">"+"</span>, <span class="string">"="</span>, <span class="string">","</span>, <span class="string">"."</span></span><br><span class="line">    ));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$charsLen = count($chars) - <span class="number">1</span>;</span><br><span class="line">shuffle($chars);                            <span class="comment">//æ‰“ä¹±æ•°ç»„é¡ºåº</span></span><br><span class="line">$str = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;$len; $i++)&#123;</span><br><span class="line">     $str .= $chars[mt_rand(<span class="number">0</span>, $charsLen)];    <span class="comment">//éšæœºå–å‡ºä¸€ä½</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠŠæ•°æ®æ’å…¥æ•°æ®åº“</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insertDb</span><span class="params">($Db,$data)</span></span>&#123;</span><br><span class="line"><span class="comment">//å•†å“ä¸»è¡¨</span></span><br><span class="line">$pd_product_field = [</span><br><span class="line"><span class="string">'product_art_no'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'product_number'</span> =&gt; getRandomStr(<span class="number">32</span>),</span><br><span class="line"><span class="string">'pd_name'</span> =&gt; $data[<span class="string">'name'</span>],</span><br><span class="line"><span class="string">'pd_subtitle'</span> =&gt;<span class="string">''</span>,</span><br><span class="line"><span class="string">'pd_descs'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'pd_category_id'</span> =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'pd_seller_id'</span> =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'pd_brand_id'</span> =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'express_tpl_id'</span> =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'meun_id'</span> =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'pd_unit'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'pd_weight'</span> =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'pd_weight_unit'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'pd_volume'</span> =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'pd_volume_unit'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'min_price'</span> =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'market_price'</span> =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'cost_price'</span>=&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'detail_descr'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'pd_key_word'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'pd_remark'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'pd_picture_prefix'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'pd_detail_info'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'detail_title'</span> =&gt; <span class="string">''</span>,</span><br><span class="line"><span class="string">'created_at'</span> =&gt; date(<span class="string">'Y-m-d H:i:s'</span>),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">$pd_detail_info = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($data[<span class="string">'desc'</span>] <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">$pd_detail_info .= <span class="string">'&lt;img src="'</span>.$v.<span class="string">'"&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$pd_product_field[<span class="string">'pd_detail_info'</span>] = addslashes(bin2hex(gzcompress($pd_detail_info)));</span><br><span class="line">$pd_product_field[<span class="string">'pd_image_url'</span>] = implode(<span class="string">','</span>,$data[<span class="string">'img'</span>]);</span><br><span class="line">$pd_product_field[<span class="string">'pd_translation_pic'</span>] = implode(<span class="string">','</span>,$data[<span class="string">'img'</span>]);</span><br><span class="line">$pd_product_keys = <span class="string">''</span>;</span><br><span class="line">$pd_product_values = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($pd_product_field <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">$pd_product_keys .= $key.<span class="string">','</span>;</span><br><span class="line">$pd_product_values .= <span class="string">"'"</span>.$value.<span class="string">"'"</span>.<span class="string">','</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$pd_product_keys = trim($pd_product_keys,<span class="string">','</span>);</span><br><span class="line">$pd_product_values = trim($pd_product_values,<span class="string">','</span>);</span><br><span class="line">$inser_pd_product = <span class="string">"insert into pd_product($pd_product_keys) value($pd_product_values)"</span>;</span><br><span class="line"></span><br><span class="line">mysqli_autocommit($Db,<span class="keyword">false</span>);<span class="comment">//å¼€å¯äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">$product_number = $pd_product_field[<span class="string">'product_number'</span>];</span><br><span class="line">$pd_product_reslut = mysqli_query($Db,$inser_pd_product);</span><br><span class="line">$product_id = mysqli_insert_id($Db);</span><br><span class="line">$pd_sku_result = <span class="number">0</span>;</span><br><span class="line">$pd_sku_properties_reslut = <span class="number">0</span>;</span><br><span class="line">$sku_unique_code = getRandomStr(<span class="number">32</span>);</span><br><span class="line"><span class="keyword">if</span>(array_key_exists(<span class="string">'sku'</span>,$data) &amp;&amp; count($data[<span class="string">'sku'</span>])&gt;<span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($data[<span class="string">'sku'</span>] <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line"></span><br><span class="line">$property = $value[<span class="string">'sku_name'</span>];</span><br><span class="line">$pd_price = $value[<span class="string">'price'</span>];</span><br><span class="line">$sku_picture_url = $value[<span class="string">'img'</span>];</span><br><span class="line"></span><br><span class="line">$insert_pd_sku = <span class="string">"insert into pd_sku(sku_unique_code,product_number,property,sku_code,product_id) value('$sku_unique_code','$product_number','$property','',$product_id)"</span>;</span><br><span class="line">$pd_sku_result = mysqli_query($Db,$insert_pd_sku);</span><br><span class="line">$sku_id = mysqli_insert_id($Db);</span><br><span class="line"></span><br><span class="line">$insert_pd_sku_properties = <span class="string">"insert into pd_sku_properties(sku_id,sku_unique_code,product_id,product_number,sku_value,pd_price,sku_picture_url,sku_code) value($sku_id,'',$product_id,'$product_number','$property','$pd_price','$sku_picture_url','')"</span>;</span><br><span class="line">$pd_sku_properties_reslut = mysqli_query($Db,$insert_pd_sku_properties);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$pd_sku_result = <span class="number">1</span>;</span><br><span class="line">$pd_sku_properties_reslut = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($pd_product_reslut &amp;&amp; $pd_sku_result &amp;&amp; $pd_sku_properties_reslut)&#123;</span><br><span class="line">mysqli_commit($Db);<span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">$code = <span class="number">0</span>;</span><br><span class="line">$message = <span class="string">'æ’å…¥æˆåŠŸ'</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">mysqli_rollback($Db);<span class="comment">//å›æ»š</span></span><br><span class="line">$code = <span class="number">1</span>;</span><br><span class="line">$message = <span class="string">'æ’å…¥å¤±è´¥'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (\<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">mysqli_rollback($Db);<span class="comment">//å›æ»š</span></span><br><span class="line">$code = <span class="number">1</span>;</span><br><span class="line">$message = $e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ é™¤æœ¬åœ°ä¸‹è½½çš„å›¾ç‰‡</span></span><br><span class="line"><span class="keyword">foreach</span> ($data[<span class="string">'img'</span>] <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">$arr = explode(<span class="string">'/'</span>,$value);</span><br><span class="line">unlink(<span class="string">'./img/'</span>.array_pop($arr));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(array_key_exists(<span class="string">'desc'</span>, $data))&#123;</span><br><span class="line"><span class="keyword">foreach</span> ($data[<span class="string">'desc'</span>] <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">$arr = explode(<span class="string">'/'</span>,$value);</span><br><span class="line">unlink(<span class="string">'./img/'</span>.array_pop($arr));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(array_key_exists(<span class="string">'sku'</span>, $data))&#123;</span><br><span class="line"><span class="keyword">foreach</span> ($data[<span class="string">'sku'</span>] <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">$arr = explode(<span class="string">'/'</span>,$value[<span class="string">'img'</span>]);</span><br><span class="line">unlink(<span class="string">'./img/'</span>.array_pop($arr));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> json_encode([</span><br><span class="line"><span class="string">'code'</span> =&gt; $code,</span><br><span class="line"><span class="string">'message'</span> =&gt; $message</span><br><span class="line">]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> jquery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€åŸåˆ›ã€‘walleé…ç½®æˆ–éƒ¨ç½²å¯èƒ½ä¼šé‡åˆ°çš„å°é—®é¢˜</title>
      <link href="/walle%E9%85%8D%E7%BD%AE%E6%88%96%E9%83%A8%E7%BD%B2%E5%8F%AF%E8%83%BD%E4%BC%9A%E9%81%87%E5%88%B0%E7%9A%84%E5%B0%8F%E9%97%AE%E9%A2%98/"/>
      <url>/walle%E9%85%8D%E7%BD%AE%E6%88%96%E9%83%A8%E7%BD%B2%E5%8F%AF%E8%83%BD%E4%BC%9A%E9%81%87%E5%88%B0%E7%9A%84%E5%B0%8F%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸€.<b>å¼•è¨€</b></p></blockquote><p>&emsp;ä½œä¸ºä¸€ä¸ªåˆšæ¥è§¦walleä¸ä¹…çš„æ–°æ‰‹,åœ¨é…ç½®å’Œéƒ¨ç½²çš„è¿‡ç¨‹ä¸­éš¾å…ä¼šé‡åˆ°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ã€‚å½“ç„¶æ’é™¤ä¸€äº›æœ¬èº«å°±å¯¹Linuxä»€ä¹ˆçš„ç©çš„æ¯”è¾ƒå¥½çš„å¤§ç¥ã€‚<br>&emsp;æœ¬æ¥æƒ³å¤šå†™ç‚¹å­—å‡‘ä¸ªå­—æ•°â€¦åæ¥æƒ³æƒ³è¿˜æ˜¯ç®—äº†ã€‚<br><blockquote><p>äºŒ.<b>é…ç½®æ—¶</b></p></blockquote><br>&emsp;åœ¨<font color="#ff5722">é¡¹ç›®ç®¡ç†-æ–°å»ºé¡¹ç›®</font>é‡Œ,æ–°å¢é¡¹ç›®çš„æ—¶å€™å¯èƒ½ä¼šå‡ºç°çš„é—®é¢˜<br>&emsp;æ„æ€æ˜¯ç›®æ ‡æœºæœ€å°‘è¦æœ‰ä¸€ä¸ª<br><a id="more"></a><br><img src="/walleé…ç½®æˆ–éƒ¨ç½²å¯èƒ½ä¼šé‡åˆ°çš„å°é—®é¢˜/img/error.png"><br>&emsp;æ“ä½œæ­¥éª¤<br><img src="/walleé…ç½®æˆ–éƒ¨ç½²å¯èƒ½ä¼šé‡åˆ°çš„å°é—®é¢˜/img/error1.png"><br>&emsp;æ­£ç¡®ä½ç½®<br><img src="/walleé…ç½®æˆ–éƒ¨ç½²å¯èƒ½ä¼šé‡åˆ°çš„å°é—®é¢˜/img/error2.png"><br><blockquote><p>ä¸‰.<b>éƒ¨ç½²æ—¶</b></p></blockquote><br>&emsp;éƒ¨ç½²çš„æ—¶å€™å¯èƒ½å‡ºç°è¿™æ ·çš„é”™è¯¯,å› ä¸ºå•¥å‘¢ï¼Ÿå› ä¸ºä½ åœ¨ç›®æ ‡æœºä¸Šæ²¡æœ‰åˆ›å»ºæ ¹ç›®å½•<br><img src="/walleé…ç½®æˆ–éƒ¨ç½²å¯èƒ½ä¼šé‡åˆ°çš„å°é—®é¢˜/img/error4.png"><br>&emsp;å°±æ˜¯è¿™ä¸ª<font color="#ff5722">data</font>ç›®å½•,è™½ç„¶ä»–æç¤ºè¯´ä¼šè‡ªåŠ¨ç”Ÿæˆ,ä½†æ˜¯æ²¡ç”Ÿæˆâ€¦å€’æ˜¯é‚£ä¸ª<font color="#ff5722">datar</font>èƒ½è‡ªåŠ¨ç”Ÿæˆ<br><img src="/walleé…ç½®æˆ–éƒ¨ç½²å¯èƒ½ä¼šé‡åˆ°çš„å°é—®é¢˜/img/error3.png"><br><blockquote><p>å››.<b>è®¿é—®æ—¶</b></p></blockquote><br>&emsp;è®¿é—®çš„æ—¶å€™å‡ºç°è¿™ä¸ªé”™è¯¯,å°±è¦æ£€æŸ¥ä¸€ä¸‹çš„nginxé…ç½®æ˜¯å¦æ­£ç¡®<br><img src="/walleé…ç½®æˆ–éƒ¨ç½²å¯èƒ½ä¼šé‡åˆ°çš„å°é—®é¢˜/img/error6.png"><br>&emsp;çœ‹çœ‹æ˜¯å¦ç¼ºäº†<font color="#ff5722">ä¸‹å›¾æ‰€ç¤º</font>,æˆ–è€…æ˜¯ç«¯å£å ç”¨ã€åŸŸåé…ç½®ä¸ä¸€è‡´çš„æƒ…å†µ<br><img src="/walleé…ç½®æˆ–éƒ¨ç½²å¯èƒ½ä¼šé‡åˆ°çš„å°é—®é¢˜/img/error5.png"><br>&emsp;å¦‚æœæ˜¯é•¿æ—¶é—´é—²ç½®çš„æ—¶å€™ä¹Ÿä¼šå¼¹å‡ºä¸€ä¸ª<font color="#ff5722">åå°æœåŠ¡æœªå¯åŠ¨</font>,è¿™ä¸ªä¸ç”¨æ‹…å¿ƒæ²¡æœ‰ä»€ä¹ˆé—®é¢˜</p><p><font color="#ff5722">PS:å…¶ä»–æƒ…å†µåœ¨walleå®˜ç½‘ä¸Šæœ‰ä»‹ç»,å¦‚502/404ç­‰é”™è¯¯</font><br><blockquote><p>äº”.<b>å®‰å…¨æ–¹é¢</b></p></blockquote><br>&emsp;å®˜ç½‘å»ºè®®æŠŠwalleéƒ¨ç½²åœ¨å†…ç½‘,è¿™æ ·åº”è¯¥æ˜¯æ²¡æœ‰ä»€ä¹ˆå¤§é—®é¢˜ã€‚<br>&emsp;è¿™é‡Œçš„è¯æ¨èæä¸ªåŒå‘è®¤è¯,è¿™ä¸ªä¹Ÿæ˜¯æˆ‘ç ”ç©¶å¥½ä¹…çš„ã€‚<br><blockquote><p>å…­.<b>æœ€å</b></p></blockquote><br>è¯´èµ·æ¥ç”¨çš„é¢‘ç‡ä¸æ˜¯å¾ˆé«˜,æ›´å¤šçš„é—®é¢˜è¿˜æ˜¯éœ€è¦é•¿æ—¶é—´çš„ä½¿ç”¨æ‰èƒ½å‘ç°,å½“ç„¶äº†æœ¬ç¯‡æ–‡ç« ä¼šæŒç»­çš„æ›´æ–°(åœ¨å‘ç°bugçš„å‰æä¸‹..)ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> liunx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> walle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>walleæ­å»ºé¡¹ç›®éƒ¨ç½²ç³»ç»Ÿ</title>
      <link href="/walle%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E7%B3%BB%E7%BB%9F/"/>
      <url>/walle%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<blockquote><p>äºŒ.<b>å‰è¨€</b>-<font color="#ff5722">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨walleæ¥ç®¡ç†é¡¹ç›®</font></p></blockquote><blockquote><p>walle è®©ç”¨æˆ·ä»£ç å‘å¸ƒç»ˆäºå¯ä»¥ä¸åªèƒ½é€‰æ‹© jenkinsï¼æ”¯æŒå„ç§webä»£ç å‘å¸ƒï¼Œphpã€javaã€pythonã€goç­‰ä»£ç çš„å‘å¸ƒã€å›æ»šå¯ä»¥é€šè¿‡webæ¥ä¸€é”®å®Œæˆã€‚walle ä¸€ä¸ªå¯è‡ªç”±é…ç½®é¡¹ç›®ï¼Œæ›´äººæ€§åŒ–ï¼Œé«˜é¢œå€¼ï¼Œæ”¯æŒgitã€å¤šç”¨æˆ·ã€å¤šè¯­è¨€ã€å¤šé¡¹ç›®ã€å¤šç¯å¢ƒåŒæ—¶éƒ¨ç½²çš„å¼€æºä¸Šçº¿éƒ¨ç½²ç³»ç»Ÿ</p><footer><strong>å¼•è¨€</strong><cite><a href="http://www.walle-web.io/docs/" target="_blank" rel="noopener">æ¥è‡ªwalleå®˜ç½‘</a></cite></footer></blockquote><p>&emsp;<font color="#ff5722">1)</font>.ä¸ªäººè€Œè¨€,walleä¸ºæˆ‘æä¾›äº†ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„é¡¹ç›®ç®¡ç†å¹³å°,ä»é¡¹ç›®å¼€å‘åˆ°é¡¹ç›®æµ‹è¯•å†åˆ°é¡¹ç›®ä¸Šçº¿walleä¸ºæ•´ä¸ªæµç¨‹æä¾›äº†ä¸€å¥—å®Œç¾çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>&emsp;<font color="#ff5722">2)</font>.å¯¹å…¬å¸å›¢é˜Ÿè€Œè¨€,walleä¸ºç®¡ç†è€…æä¾›äº†ä¸€ä¸ªéå¸¸å¥½çš„é¡¹ç›®ç®¡ç†å·¥å…·ã€‚å¯¹é¡¹ç›®è´¨é‡ã€é¡¹ç›®çš„è¿›åº¦ã€ç¨‹åºçš„å®‰å…¨å’Œå¯é æ€§ç­‰ç­‰éƒ½æä¾›äº†ä¸€å®šçš„ä¿éšœã€‚<br><a id="more"></a><br><blockquote><p>ä¸‰.<b>æ­£æ–‡</b>-<font color="#ff5722">walleåˆ°åº•èƒ½åšä»€ä¹ˆ</font></p></blockquote><br><img src="/walleæ­å»ºé¡¹ç›®éƒ¨ç½²ç³»ç»Ÿ/img/walle.png"><br>&emsp;<font color="#ff5722">PS:</font>walleåšçš„å·¥ä½œå°±æ˜¯å½“ä½ æäº¤ä»£ç ä¸Šçº¿çš„æ—¶å€™,ä»–ä¼šä»å®¿ä¸»æœº(<font color="#ff5722">walleç³»ç»Ÿæ‰€åœ¨çš„æœºå™¨</font>)å‘ä½ é…ç½®çš„gitåœ°å€æ‹‰å–ä»£ç ã€æ‰“åŒ…ã€ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨(<font color="#ff5722">æ­£å¼ç¯å¢ƒæ‰€åœ¨çš„æœºå™¨</font>)ä¸Šå»ã€ç„¶åè§£å‹æˆå®Œæ•´çš„é¡¹ç›®ã€‚</p><font color="#ff5722">é—®:</font>walleä»…ä»…åªèƒ½åšè¿™äº›å·¥ä½œå—ï¼Ÿ<br><font color="#ff5722">ç­”:</font>1).å½“ç„¶ä¸æ˜¯å•¦!æ¯æ¬¡æäº¤ä¸Šçº¿å•(é¡¹ç›®ä»£ç ),walleéƒ½ä¼šä¿å­˜ä¸€ä»½åœ¨ç›®æ ‡æœºä¸Šã€‚å½“ä½ æ–°ä¸Šçº¿çš„ç¨‹åºå‘ç°äº†bug,è¿™æ˜¯ä½ å¯ä»¥é€‰æ‹©å›æ»šä»£ç (<font color="#ff5722">ai,è¿™ä¸ªå°±å’ŒInnoDBçš„äº‹åŠ¡æœ‰äº›ç›¸ä¼¼äº†</font>)ã€‚<br><br>&emsp;2).ç›¸æ¯”ä¼ ç»Ÿçš„ftpå’Œsftpéƒ¨ç½²é¡¹ç›®,walleå°±æ›´åŠ æ˜¾å¾—å®‰å…¨å’Œå¯é ã€‚<br><br>&emsp;3).ç›¸æ¯”jenkins,walleæ˜¯ç”±å›½äººå¼€å‘;ç•Œé¢ã€æ“ä½œæ›´åŠ å…·æœ‰äº²å’ŒåŠ›ã€‚<br><br>&emsp;4).åŒæ ·ä»–å…·æœ‰ç›¸æ¯”jenkinsç›¸åŒçš„ç‰¹æ€§pre_deployã€post_deployã€pre_releaseã€post_releaseç­‰é«˜çº§ä»»åŠ¡è¿™å¯¹äºå¤§éƒ¨åˆ†å¼€å‘æ¡†æ¶æ¥è¯´éƒ½æ˜¯éå¸¸æ£’çš„ä¸€ä¸ªåŠŸèƒ½ã€‚<br><br><font color="#ff5722">æ€»ç»“</font>:walleçš„ä¼˜ç‚¹å¹¶ä¸æ­¢è¿™äº›,æ›´å¤šçš„å†…å®¹éœ€è¦å¤§å®¶äº²è‡ªå»å‘ç°å’ŒæŒ–æ˜ã€‚<br><blockquote><p>å››.<b>æ­å»ºwalleéƒ¨ç½²ç³»ç»Ÿ-<a href="http://www.walle-web.io/docs/installation.html" target="_blank" rel="noopener">å®˜ç½‘æ–‡æ¡£</a><br></b></p></blockquote><br>&emsp;walleæœ¬èº«æ˜¯ç”±Pythonå¼€å‘,ä½†webéœ€è¦ä½¿ç”¨nginxæœåŠ¡;æ‰€ä»¥æ­å»ºlnmpç¯å¢ƒæ˜¯æ¯”ä¸å¯å°‘çš„ä¸€æ­¥ã€‚<br><br>&emsp;ç¬¬ä¸€æ­¥:å…‹éš†é¡¹ç›®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/meolu/walle-web.git</span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬äºŒæ­¥: é…ç½®nginx<br><figure class="highlight plain"><figcaption><span>nginxé…ç½®</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">upstream webservers &#123;</span><br><span class="line">    server 0.0.0.0:5000 weight=1; # è´Ÿè½½è®¾ç½®</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  ä½ çš„åŸŸåæˆ–ip; # åŸŸåè®¾ç½®</span><br><span class="line">    access_log   /usr/local/nginx/logs/walle.log main;</span><br><span class="line">    index index.html index.htm; # æ—¥å¿—ç›®å½•</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        try_files $uri $uri/ /index.html;</span><br><span class="line">        add_header access-control-allow-origin *;</span><br><span class="line">        root æŒ‡å®šåˆ°walleé¡¹ç›®ä¸‹feç›®å½•; # å‰ç«¯ä»£ç å·²é›†æˆåˆ°walle-webï¼Œå³walle-web/feçš„ç»å¯¹è·¯å¾„</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ^~ /api/ &#123;</span><br><span class="line">        add_header access-control-allow-origin *;</span><br><span class="line">        proxy_pass      http://webservers;</span><br><span class="line">        proxy_set_header X-Forwarded-Host $host:$server_port;</span><br><span class="line">        proxy_set_header  X-Real-IP  $remote_addr;</span><br><span class="line">        proxy_set_header    Origin        $host:$server_port;</span><br><span class="line">        proxy_set_header    Referer       $host:$server_port;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ^~ /socket.io/ &#123;</span><br><span class="line">        add_header access-control-allow-origin *;</span><br><span class="line">        proxy_pass      http://webservers;</span><br><span class="line">        proxy_set_header X-Forwarded-Host $host:$server_port;</span><br><span class="line">        proxy_set_header  X-Real-IP  $remote_addr;</span><br><span class="line">        proxy_set_header    Origin        $host:$server_port;</span><br><span class="line">        proxy_set_header    Referer       $host:$server_port;</span><br><span class="line">        proxy_set_header Host $http_host;</span><br><span class="line">        proxy_set_header X-NginX-Proxy true;</span><br><span class="line"></span><br><span class="line">        # WebScoket Support</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">        proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬ä¸‰æ­¥: æ·»åŠ hosts<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/hosts</span><br><span class="line"># æ–°å¢ä¸€è¡Œ</span><br><span class="line">127.0.0.1  ä½ çš„åŸŸå # ä¸nginxé…ç½®ä¸€è‡´</span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬å››æ­¥: å®‰è£…Python 2.7 + pipã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># åˆ‡æ¢åˆ°walle-webæ ¹ç›®å½•ä¸‹æ“ä½œ</span><br><span class="line">sh admin.sh init</span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬äº”æ­¥: ä¿®æ”¹walleé…ç½®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># åˆ‡æ¢åˆ°walle-webæ ¹ç›®å½•ä¸‹æ“ä½œ</span><br><span class="line">vi walle/config/settings_prod.py</span><br><span class="line"># @TODO æ˜¯ä¸ºè¦ä¿®æ”¹çš„éƒ¨åˆ†</span><br><span class="line"># æœåŠ¡å¯åŠ¨ @TODO</span><br><span class="line"># HOST ä¿®æ”¹ä¸ºä¸ nginx server_name ä¸€è‡´.</span><br><span class="line"># åç»­åœ¨web hooksä¸é€šçŸ¥ä¸­ç”¨åˆ°æ­¤åŸŸå.</span><br><span class="line">HOST = ä½ çš„åŸŸå</span><br><span class="line">PORT = 5000</span><br><span class="line"># https True, http False</span><br><span class="line">SSL = False</span><br><span class="line"></span><br><span class="line"># æ•°æ®åº“è®¾ç½® @TODO</span><br><span class="line">SQLALCHEMY_DATABASE_URI = &apos;mysql://user:password@localhost:3306/walle?charset=utf8&apos;</span><br><span class="line"></span><br><span class="line"># æœ¬åœ°ä»£ç æ£€å‡ºè·¯å¾„ï¼ˆç”¨æˆ·æŸ¥è¯¢åˆ†æ”¯, ç¼–è¯‘, æ‰“åŒ…ï¼‰ #TODO</span><br><span class="line">CODE_BASE = é¡¹ç›®è·¯å¾„,ä¹Ÿå°±æ˜¯å®¿ä¸»æœºçš„gitä»“åº“çš„è·¯å¾„</span><br><span class="line"></span><br><span class="line"># æ—¥å¿—å­˜å‚¨è·¯å¾„ @TODO</span><br><span class="line"># é»˜è®¤ä¸ºwalle-webé¡¹ç›®ä¸‹logs, å¯è‡ªå®šä¹‰è·¯å¾„, éœ€ä»¥ / ç»“å°¾</span><br><span class="line"># LOG_PATH = &apos;/var/logs/walle/&apos;</span><br><span class="line">LOG_PATH = os.path.join(Config.PROJECT_ROOT, &apos;logs&apos;)</span><br><span class="line">LOG_PATH_ERROR = os.path.join(LOG_PATH, &apos;error.log&apos;)</span><br><span class="line">LOG_PATH_INFO = os.path.join(LOG_PATH, &apos;info.log&apos;)</span><br><span class="line">LOG_FILE_MAX_BYTES = 100 * 1024 * 1024</span><br><span class="line"></span><br><span class="line"># é‚®ç®±é…ç½® @TODO</span><br><span class="line">MAIL_SERVER = &apos;smtp.exmail.qq.com&apos;</span><br><span class="line">MAIL_PORT = 465</span><br><span class="line">MAIL_USE_SSL = True</span><br><span class="line">MAIL_USE_TLS = False</span><br><span class="line">MAIL_DEFAULT_SENDER = &apos;service@walle-web.io&apos;</span><br><span class="line">MAIL_USERNAME = &apos;service@walle-web.io&apos;</span><br><span class="line">MAIL_PASSWORD = &apos;Ki9y&amp;3U82&apos;</span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬å…­æ­¥: åˆå§‹åŒ–é¡¹ç›®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºæ•°æ®åº“</span><br><span class="line">mysql  -hxx -uxx -p -e&apos;CREATE SCHEMA walle&apos;</span><br><span class="line"># Data Migration</span><br><span class="line">sh admin.sh migration</span><br></pre></td></tr></table></figure><br>&emsp;ç¬¬ä¸ƒæ­¥: å¯åŠ¨walleã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># å¯åŠ¨</span><br><span class="line">sh admin.sh start</span><br><span class="line"># é‡å¯</span><br><span class="line">sh admin.sh restart </span><br><span class="line"># å‡çº§</span><br><span class="line">sh admin.sh upgrade</span><br><span class="line"># Migration</span><br><span class="line">sh admin.sh migration</span><br></pre></td></tr></table></figure><br>æœ€åè®¿é—®ä½ çš„åŸŸåå°±å¯ä»¥è®¿é—®äº†ï¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¶…ç®¡ï¼šsuper@walle-web.io \ Walle123</span><br><span class="line">æ‰€æœ‰è€…ï¼šowner@walle-web.io \ Walle123</span><br><span class="line">è´Ÿè´£äººï¼šmaster@walle-web.io \ Walle123</span><br><span class="line">å¼€å‘è€…ï¼šdeveloper@walle-web.io \ Walle123</span><br><span class="line">è®¿å®¢ï¼šreporter@walle-web.io \ Walle123</span><br></pre></td></tr></table></figure><br><font color="#ff5722">PS:ä¸‹ç¯‡æ–‡ç« å°†ä¼šä»‹ç»å¦‚ä½•é…ç½®é¡¹ç›®ã€é¡¹ç›®é…ç½®ä¸­å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜åŠè§£å†³åŠæ³•ã€ä¸Šçº¿é¡¹ç›®è¦æ³¨æ„çš„äº‹é¡¹</font>]]></content>
      
      
      <categories>
          
          <category> liunx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> walle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€åŸåˆ›ã€‘hexo+github+codingæ­å»ºåšå®¢(ç»‘å®šå¤šåŸŸå)</title>
      <link href="/hexo-github-coding%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2-%E7%BB%91%E5%AE%9A%E5%A4%9A%E5%9F%9F%E5%90%8D/"/>
      <url>/hexo-github-coding%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2-%E7%BB%91%E5%AE%9A%E5%A4%9A%E5%9F%9F%E5%90%8D/</url>
      
        <content type="html"><![CDATA[<p>&emsp;ä¸€.æœ€è¿‘æœåŠ¡å™¨å¿«åˆ°æœŸäº†,ä¹Ÿçªç„¶æƒ³èµ·ä¹‹å‰æœ‰ä¸ªç½‘å‹é—®æˆ‘æ€ä¹ˆç”¨hexo+githubæ­å»ºä¸ªäººåšå®¢,å¥½å¤šå¤©æ²¡æœ‰å›ä»–,å¿ƒé‡Œä¹Ÿæ€»æ˜¯è¿‡æ„ä¸å»ã€‚ä¸è®ºä»–æœ‰æ²¡æœ‰è§£å†³è¿™ä¸ªé—®é¢˜,ç°åœ¨ä¹Ÿéœ€è¦è¡¥å‘ä¸€ç¯‡å…³äºhexo+github+codingæ­å»ºä¸ªäººåšå®¢çš„æ–‡ç« äº†ã€‚</p><p>&emsp;äºŒ.ä¹Ÿå¸Œæœ›é€šè¿‡è¿™ç¯‡åšå®¢,èƒ½è®©æ›´å¤šæ­£å¤„äºåˆæœŸé˜¶æ®µçš„åŒå­¦é¡ºåˆ©çš„æ­å»ºå±äºè‡ªå·±çš„åšå®¢;ä¹ŸåŒæ ·é€‚åˆæ²¡æœ‰ç¼–ç¨‹ç»éªŒçš„åŒå­¦æ¥äº²æ‰‹æ„Ÿè§‰ä¸€ä¸‹ç¼–ç¨‹çš„ä¹è¶£ï¼<br><a id="more"></a><br>&emsp;ä¸‰.ç›¸æ¯”ä½¿ç”¨ä¸ªäººæœåŠ¡å™¨æ­å»ºè€Œè¨€åˆ©ç”¨githubæˆ–codingæ­å»ºåšå®¢æ›´åŠ çœäº‹çœåŠ›åˆçœé’±,æœ€ä¾¿å®œçš„æœåŠ¡å™¨ä¸€å¹´ä¹Ÿéœ€è¦ä¸€åƒå·¦å³çš„ç§Ÿèµè´¹,è€Œä½¿ç”¨githubã€codingã€ç äº‘ç­‰æ­å»ºæ˜¯å®Œå…¨å…è´¹çš„,å¹¶ä¸”ä¸ç”¨éƒ¨ç½²æœåŠ¡å™¨ç¯å¢ƒ,ä¹Ÿä¸ç”¨æ‹…å¿ƒè¯ä¹¦çš„é—®é¢˜ã€‚<br><blockquote><p>ç¬¬ä¸€æ­¥:hexoæœ¬åœ°ç¯å¢ƒçš„æ­å»º</p></blockquote><br><a>ps:è¿™é‡Œå› ä¸ºhexoå®˜ç½‘æœ‰æ•™ç¨‹,æˆ‘å°±ä¸ä¸€ä¸€ä»‹ç»äº†,ç®€å•ä»‹ç»ä¸€ä¸‹æ­å»ºæµç¨‹</a></p><a>hexoæœ¬åœ°æ­å»ºæµç¨‹:</a><p>&emsp;&emsp;1).å®‰è£…git<br>&emsp;&emsp;2).å®‰è£…nodejs<br>&emsp;&emsp;3).å®‰è£…hexo</p><a>å‚æ•°é…ç½®</a><p>1).é¦–å…ˆæ˜¯æ ¹ç›®å½•ä¸‹<a>_config.yml</a>æ–‡ä»¶çš„é…ç½®ã€‚<br>&emsp;&emsp;1.é…ç½®å¯¼èˆªå’Œåšå®¢åŸºæœ¬ä¿¡æ¯ã€‚<br>&emsp;&emsp;2.é…ç½®éƒ¨ç½²åœ°å€<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#æ–‡ç« ç”Ÿæˆé…ç½®</span><br><span class="line">#permalink: :year/:month/:day/:title/ </span><br><span class="line">//æ–‡ç« è·¯å¾„ åŸæœ‰çš„è·¯å¾„ä¸ºâ€˜daihongweb.com/2019/04/22/hexo+github+codingæ­å»ºåšå®¢(ç»‘å®šå¤šåŸŸå)â€™</span><br><span class="line">permalink: :title/ </span><br><span class="line">//æ–‡ç« è·¯å¾„ æ”¹ä¸ºè·¯å¾„ä¸ºâ€˜daihongweb.com/hexo+github+codingæ­å»ºåšå®¢(ç»‘å®šå¤šåŸŸå)â€™ æœ‰åˆ©äºseoä¼˜åŒ–</span><br><span class="line">permalink_defaults:</span><br><span class="line">#ä»£ç éƒ¨ç½²é…ç½®</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo:</span><br><span class="line">      coding: codingä»“åº“åœ°å€,master,//masteræ˜¯ä»£ç åˆ†æ”¯</span><br><span class="line">      github: githubä»“åº“åœ°å€,master,</span><br></pre></td></tr></table></figure><br><a>ps:è¿™é‡Œå»ºè®®å¤§å®¶å†æœ¬åœ°æŠŠä¸€åˆ‡æå¥½ä¹‹åå†æ·»éƒ¨ç½²åœ°å€ï¼Œæˆ–è€…åœ¨æœ¬åœ°æµ‹è¯•çš„æ—¶å€™ä¸è¦ä½¿ç”¨ hexo d å‘½ä»¤</a><br><blockquote><p>ç¬¬äºŒæ­¥:æ­å»ºè¿œç¨‹ä»“åº“</p></blockquote><br>1).codingå»ºç«‹gitä»“åº“<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/add.png"><br>2).è·å–gitåœ°å€<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/address.png" class="ç»“æœ"><br><a>ps:è¿™é‡Œå»ºè®®å¤§å®¶ä½¿ç”¨https,ä½¿ç”¨sshéœ€è¦ç§˜é’¥ä»€ä¹ˆçš„æ¯”è¾ƒéº»çƒ¦</a><br>3).githubå»ºç«‹gitä»“åº“<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/github_add.png"><br>4).è·å–gitåœ°å€<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/github_address.png"><br><blockquote><p>ç¬¬ä¸‰æ­¥:éƒ¨ç½²é¡¹ç›®</p></blockquote><br><a>ps:éƒ¨ç½²çš„æ—¶å€™å¯èƒ½ä¼šå¼¹å‡ºè¦æ±‚ç™»å½•çš„è¾“å…¥æ¡†,è¿™ä¸ªç¬¬ä¸€æ¬¡éƒ¨ç½²çš„æ—¶å€™è¾“å…¥ä¸€æ¬¡,ä¹‹åå°±ä¸éœ€è¦å†è¾“å…¥äº†</a><br>1).é¡¹ç›®ä¸­æ‰§è¡Œ<br><figure class="highlight plain"><figcaption><span>éƒ¨ç½²é¡¹ç›®</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo c &amp;&amp; hexo g &amp;&amp; hexo g &amp;&amp; hexo s</span><br></pre></td></tr></table></figure><br><a>ps:å½“ä½ è®¿é—®åšå®¢çš„æ—¶å€™ä½ ä¼šå‘ç°æ–‡ç« å†…æ‰€æœ‰çš„å›¾ç‰‡éƒ½åŠ è½½ä¸å‡ºæ¥,è§£å†³åŠæ³•å¦‚ä¸‹</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#é¡¹ç›®æ ¹ç›®å½•ä¸‹_config.yml</span><br><span class="line">external_link: true</span><br><span class="line">post_asset_folder: true</span><br><span class="line">relative_link: true</span><br><span class="line">future: true</span><br></pre></td></tr></table></figure><br><a>ps:ä¿®æ”¹ä¹‹åæŠŠå›¾ç‰‡ç§»å…¥æ–‡ç« åç§°å¯¹åº”çš„æ–‡ä»¶å¤¹ä¸‹çš„imgæ–‡ä»¶å¤¹ä¸‹;ä¿®æ”¹æ–‡ç« ä¸­å¼•å…¥çš„è·¯å¾„;åœ¨é‡æ–°æ‰§è¡Œä¸Šè¾¹çš„å‘½ä»¤å°±okäº†</a><br><blockquote><p>ç¬¬å››æ­¥:å¼€å¯pagesæœåŠ¡</p></blockquote><br>1).codingå¼€å¯pagesæœåŠ¡<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/coding_start.png"><br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/coding_show.png"><br><a>ps:codingå¼€å¯ä¹‹åå®ƒä¼šè‡ªåŠ¨éƒ¨ç½²ä¸€æ¬¡,ç‚¹å‡»è‡ªåŠ¨åˆ†é…çš„åŸŸååœ°å€æŸ¥çœ‹æ˜¯å¦æœ‰é—®é¢˜</a></p><p>2).githubå¼€å§‹pagesæœåŠ¡<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/github_start.png"><br>åœ¨ä¸‹é¢å¯ä»¥æ‰¾åˆ°ï¼š<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/github_show.png"><br>æ˜¾ç¤ºæˆè¿™æ ·å°±è¯´æ˜éƒ¨ç½²æˆåŠŸäº†ï¼<br><blockquote><p>ç¬¬äº”æ­¥:ç»‘å®šä¸ªäººåŸŸåï¼Œå¹¶å®ç°å¤šåŸŸåç»‘å®š</p></blockquote><br>é¦–å…ˆä½ éœ€è¦è´­ä¹°ä¸€ä¸ªåŸŸåå¹¶ä¸”å·²å¤‡æ¡ˆã€‚<br>1).æ·»åŠ è§£æ<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/dns.png"><br><a>ps:æˆ‘è¿™é‡Œæ˜¯ç”¨çš„é˜¿é‡Œäº‘çš„,è®°å½•ç±»å‹ä¸ºCNAME,è®°å½•å€¼ä¸ºä½ githubæˆ–codingçš„åœ°å€;æ‰€æœ‰çš„æœåŠ¡å•†è§£æéƒ½æ˜¯ä¸€æ ·çš„ï¼</a><br>2).å¯¹åº”çš„githubç»‘å®šä¸ªäººåŸŸå<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/bind_github.png"><br><a>ps:ä¸‹é¢å‹¾é€‰çš„æ˜¯å¼€å§‹https,è®°å¾—å‹¾é€‰ä¸Š;ä¹‹åä¼šæç¤ºä½ å¼€å§‹å¤±è´¥ä»€ä¹ˆçš„,ä¸ç”¨æ‹…å¿ƒã€‚ç¨ç­‰1å°æ—¶å†å»åˆ·æ–°å°±å¥½äº†ï¼</a><br>3).codingç»‘å®šä¸ªäººåŸŸå<br><img src="/hexo-github-codingæ­å»ºåšå®¢-ç»‘å®šå¤šåŸŸå/img/bind_coding.png"><br><a>ps:ç»‘å®šä¹‹åç‚¹å‡»ç”³è¯·,æœ‰çš„æ—¶å€™ä¼šå‡ºç°é”™è¯¯,æš‚æ—¶è¿˜æ²¡æœ‰æ‰¾åˆ°è§£å†³çš„åŠæ³•;æ·»åŠ ç»‘å®šä¹‹åè®°å¾—ç‚¹å‡»ä¸Šè¾¹çš„éƒ¨ç½²ï¼</a></p><blockquote><p>æ€»ç»“:é—®é¢˜æ¥äº†,åˆ°åº•æ˜¯æ€ä¹ˆå®ç°ç»‘å®šå¤šä¸ªåŸŸåçš„ï¼Ÿå•Šå“ˆå“ˆ,å…¶å®å°±æ˜¯åˆ©ç”¨å¤šä¸ªpagesæœåŠ¡;ä¾‹å¦‚ç°æœ‰2ä¸ªåŸŸå,é‚£ä¹ˆä¸€ä¸ªåŸŸåç»‘å®šcoding,ä¸€ä¸ªåŸŸåç»‘å®šgithub;å¹¶ä¸”è¿˜å¯ä»¥å®ç°å›½å¤–çš„è®¿é—®åˆ†é…åˆ°githubä¸Š,å›½å†…çš„è®¿é—®åˆ†é…åˆ°codingä¸Šæ¥æå‡è®¿é—®é€Ÿåº¦ï¼</p><footer><strong>Daichongweb.blog</strong></footer></blockquote>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>composer æŠ¥é”™php_pdo_firebird.dllæ‰¾ä¸åˆ°æŒ‡å®šæ¨¡å—</title>
      <link href="/composer-%E6%8A%A5%E9%94%99php-pdo-firebird-dll%E6%89%BE%E4%B8%8D%E5%88%B0%E6%8C%87%E5%AE%9A%E6%A8%A1%E5%9D%97/"/>
      <url>/composer-%E6%8A%A5%E9%94%99php-pdo-firebird-dll%E6%89%BE%E4%B8%8D%E5%88%B0%E6%8C%87%E5%AE%9A%E6%A8%A1%E5%9D%97/</url>
      
        <content type="html"><![CDATA[<p>è‡ªä»æŠŠphpç‰ˆæœ¬åˆ‡æ¢åˆ°7.0åï¼Œä¸€æ—¦ä½¿ç”¨composerå°±ä¼šå‡ºç°php_pdo_firebird.dllæ‰¾ä¸åˆ°æŒ‡å®šæ¨¡å—çš„é”™è¯¯ï¼Œè€Œä¸”è¿˜ä¸æ­¢è¿™ä¸€ä¸ªã€‚ç™¾åº¦æŸ¥è¿‡å¾ˆå¤šèµ„æ–™æœ€åéƒ½æ˜¯æ²¡æœ‰è§£å†³ï¼Œæœ€åå—åˆ°ä¸€ç¯‡åšå®¢çš„å¯å‘ï¼Œå°è¯•åœ¨phpç¯å¢ƒé‡Œå¸è½½æ‰è¿™äº›æ‰©å±•ï¼Œæœ€åï¼Œï¼Œå±…ç„¶è§£å†³äº†ï¼Ÿï¼Ÿ<br><a id="more"></a><br>å®é™…çš„åŸå› æ˜¯å› ä¸ºåœ¨PHP7ä¸­å·²ç»ä¸å†æ”¯æŒä½¿ç”¨ext/mysqlè¿™ä¸ªæ‰©å±•äº†,æŠŠä¸æ”¯æŒçš„æ‰©å±•ç›´æ¥ç»™å¸è½½æ‰å°±okäº†ã€‚<br><blockquote><p>é”™è¯¯ä¿¡æ¯ï¼š</p></blockquote><br><img src="/composer-æŠ¥é”™php-pdo-firebird-dllæ‰¾ä¸åˆ°æŒ‡å®šæ¨¡å—/img/pdo.png" class="æŠ¥é”™"><br><blockquote><p>ä¿®æ”¹æ–¹æ³•ï¼š</p></blockquote><br>æ ¹æ®å®é™…æƒ…å†µè€Œå®šï¼Œæˆ‘ç”¨çš„æ˜¯phpstudy<br><img src="/composer-æŠ¥é”™php-pdo-firebird-dllæ‰¾ä¸åˆ°æŒ‡å®šæ¨¡å—/img/save.png" class="ä¿®æ”¹æ‰©å±•"><br><blockquote><p>ç»“æœï¼š</p></blockquote><br><img src="/composer-æŠ¥é”™php-pdo-firebird-dllæ‰¾ä¸åˆ°æŒ‡å®šæ¨¡å—/img/composer.png" class="ç»“æœ"></p><p>æœ€ååˆè¯•äº†å‡ æ¬¡ï¼Œå‘ç°åªè¦æ˜¯æŠ¥é”™ä»€ä¹ˆæ¨¡å—æ‰¾ä¸åˆ°ï¼Œå°±ç›´æ¥å¸è½½ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> phpæ‰©å±•ç±» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> composer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sublime text3 ä¸èƒ½å®‰è£…æ’ä»¶</title>
      <link href="/sublime-text3-%E4%B8%8D%E8%83%BD%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/"/>
      <url>/sublime-text3-%E4%B8%8D%E8%83%BD%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>ç”¨sublimeçš„å°ä¼™ä¼´ä¼šå‘ç°æœ€è¿‘ç”¨Package Controlå®‰è£…æ’ä»¶çš„æ—¶å€™æ€»ä¼šæç¤ºè¯·å‰å¾€ä¸€ä¸ªåœ°å€å¯»æ±‚å¸®åŠ©çš„ä¸€å¥è¯ã€‚æˆ‘åœ¨ç™¾åº¦ä¸Šä¹Ÿäº†è§£äº†ä¸€ä¸‹ï¼Œå¤§å¤šéƒ½è¯´æ˜¯è¢«å¢™äº†æˆ–è€…æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ï¼ŒçœŸå®çš„åŸå› è¿˜ä¸çŸ¥é“æ˜¯é‚£ä¸ªï¼Œä¸ç®¡äº†åæ­£èƒ½è§£å†³å°±è¡Œã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š<br><a id="more"></a><br><blockquote><p>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½channel_v3.jsonæ–‡ä»¶åˆ°æœ¬åœ°</p></blockquote><br>æ–‡ä»¶åœ°å€ï¼š<br><a>channe_v3.json /img/channel_v3.json</a></p><blockquote><p>ç¬¬äºŒæ­¥ï¼šä¿®æ”¹é…ç½®</p></blockquote><p>æ‰¾åˆ°ï¼š<br><img src="/sublime-text3-ä¸èƒ½å®‰è£…æ’ä»¶/img/sublime.png" class="é…ç½®æ–¹æ³•"><br>æ‰“å¼€å†…å®¹<br><img src="/sublime-text3-ä¸èƒ½å®‰è£…æ’ä»¶/img/sublime1.png" class="æ–‡ä»¶å†…å®¹"><br>æ·»åŠ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;channels&quot;:</span><br><span class="line">[</span><br><span class="line">&quot;D:/PHPTutorial/channel_v3.json&quot;//æ–‡ä»¶çš„åœ°å€</span><br><span class="line">],</span><br></pre></td></tr></table></figure><br>æœ€åå…³é—­sublimeé‡å¯ï¼Œctrl+shift+p æ‰¾ä¸ªæ’ä»¶è¯•è¯•æœç„¶å¯ä»¥äº†ï¼ï¼</p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sublime </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sublime Text3è‡ªåŠ¨æ ¼å¼åŒ–phpä»£ç </title>
      <link href="/sublime-Text3%E8%87%AA%E5%8A%A8%E6%A0%BC%E5%BC%8F%E5%8C%96php%E4%BB%A3%E7%A0%81/"/>
      <url>/sublime-Text3%E8%87%AA%E5%8A%A8%E6%A0%BC%E5%BC%8F%E5%8C%96php%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<p>sublime text3å¾ˆå°çš„ä¸€ä¸ªä»£ç å¼€å‘å·¥å…·ï¼Œä½†åŠŸèƒ½å´å¾ˆå¼ºå¤§ã€‚å¼€å‘è€…å¯å®‰è£…å„ç§æ’ä»¶å¸®åŠ©å¼€å‘ï¼Œæå‡ä»£ç è´¨é‡å’Œå¼€å‘æ•ˆç‡ï¼Œç›¸æ¯”ä¸€äº›HDæˆ–pSçš„å¼€å‘å·¥å…·ï¼Œä¸ªäººè¿˜æ˜¯æ¯”è¾ƒå–œæ¬¢sublimeã€‚</p><p>è¿™ç¯‡æ–‡ç« ä¸»è¦è®²sublimeä¸­è‡ªåŠ¨æ ¼å¼åŒ–phpä»£ç çš„æ’ä»¶ä»‹ç»å’Œå®‰è£…é…ç½®ã€‚<br><a id="more"></a><br>é¦–å…ˆä¸‹è½½æ’ä»¶<a href="https://github.com/nanch/phpfmt_stable" target="_blank" rel="noopener">phpfmt</a></p><p>ä¸‹è½½ä¹‹åæŠŠæ–‡ä»¶åæ”¹ä¸ºphpfmtæ”¾å…¥ï¼šé¦–é€‰é¡¹-ã€‹æµè§ˆæ’ä»¶ç›®å½•ä¸­ã€‚é‡å¯sublimeã€‚</p><p>ç¬¬äºŒæ­¥ï¼šé€‰æ‹©é¦–é€‰é¡¹-ã€‹package Settings-ã€‹phpfmt-ã€‹settings-Default ç‚¹å‡»</p><p>ç¬¬ä¸‰æ­¥ï¼šé…ç½®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;version&quot;: 4,</span><br><span class="line">&quot;php_bin&quot;:&quot;D:/PHPTutorial/php/php-7.2.1-nts/php.exe&quot;,//ä½ çš„phpå®‰è£…è·¯å¾„</span><br><span class="line">&quot;format_on_save&quot;:true,</span><br><span class="line">&quot;option&quot;: &quot;value&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¿å­˜ä¹‹åé‡å¯ï¼ŒæŒ‰ctrl+så°±ä¼šè‡ªåŠ¨æ ¼å¼åŒ–äº†ï¼Œç„¶åæ ¼å¼åŒ–çš„è¿˜æ˜¯ä¸ç¾è§‚ã€‚</p><p>é‚£ä¹ˆä¸‹ä¸€æ­¥é€‰æ‹©PSR2ï¼ŒæŒ‰ä½ctrl+shift+pï¼Œè¾“å…¥phpfmt: toggle PSR2 å›è½¦ï¼Œåœ¨æµ‹è¯•ä½ å°±ä¼šå‘ç°æ ¼å¼æ¼‚äº®äº†è®¸å¤šã€‚</p><p>æ³¨æ„ï¼šctrl+shift+pæ— æ³•ä½¿ç”¨æ˜¯éœ€è¦å®‰è£…package Control ç™¾åº¦æœä¸€ä¸‹æ•™ç¨‹ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†</p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sublime </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlæŠŠå­—æ®µçš„å€¼ç”¨é€—å·è¿æ¥æˆå­—ç¬¦ä¸²</title>
      <link href="/mysql%E6%8A%8A%E5%AD%97%E6%AE%B5%E7%9A%84%E5%80%BC%E7%94%A8%E9%80%97%E5%8F%B7%E8%BF%9E%E6%8E%A5%E6%88%90%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
      <url>/mysql%E6%8A%8A%E5%AD%97%E6%AE%B5%E7%9A%84%E5%80%BC%E7%94%A8%E9%80%97%E5%8F%B7%E8%BF%9E%E6%8E%A5%E6%88%90%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<p>ä¸¤å¼ å¤šå¯¹å¤šå…³ç³»çš„è¡¨è¿›è¡Œæ•°æ®å…³è”æŸ¥è¯¢ï¼Œæœ‰ä¸¤ç§å¸¸è§çš„å†™æ³•(æˆ‘åªçŸ¥é“ä¸¤ç§,å˜¿å˜¿)ï¼š<br>(1) ä»ä¸»è¡¨ä¸­æŸ¥å‡ºæ¥æ‰€å…³è”çš„å­—æ®µï¼Œä¾‹å¦‚order_idï¼Œç„¶åå¾ªç¯æ•°ç»„å°†order_idç”¨é€—å·éš”å¼€ï¼›å‰¯è¡¨è¿›è¡ŒinæŸ¥è¯¢ï¼ˆå½“ç„¶è¿™ç§å†™æ³•æ¯”è¾ƒlow,æ–°æ‰‹ä½¿ç”¨çš„æ¯”è¾ƒå¤šï¼‰</p><p>(2) ä½¿ç”¨leftJoinå…³è”ï¼Œå·¦è¾¹ä¸ºä¸»è¡¨<br>ä»¥ä¸Šä»…ä¸¾ä¾‹</p><p>æœ‰äº›æƒ…å†µä¸‹åªèƒ½ä½¿ç”¨å…ˆæŸ¥å†inçš„å†™æ³•ï¼Œé‚£ä¹ˆæ€ä¹ˆç®€åŒ–å®ƒå‘¢(å°±ä¸æƒ³å…ˆæŸ¥å†å¾ªç¯è¿æ¥)ï¼Ÿ</p><p>é‚£ä¹ˆä¸€ä¸ªmysqlçš„å‡½æ•°å°±èƒ½ä½¿ç”¨ä¸Šäº†ï¼Œä»–å°±æ˜¯<a>GROUP_CONCAT()</a>.è¿™ä¸ªå‡½æ•°å°±æ˜¯æŠŠæŸä¸ªå­—æ®µçš„å€¼ç”¨å­—ç¬¦ä¸²è¿æ¥æˆ<a>A,B,C</a>è¿™æ ·çš„æ ¼å¼<br><a id="more"></a><br>ç”¨æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GROUP_CONCAT(å­—æ®µ) </span><br></pre></td></tr></table></figure><br>å»é‡æ—¶ç”¨æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GROUP_CONCAT(DISTINCT(å­—æ®µ))</span><br></pre></td></tr></table></figure><br>æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ä¹‹åå°±ä¼šå¾—åˆ°è¿™ä¸ªå­—æ®µç”¨é€—å·éš”å¼€çš„å€¼</p>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpExcelåˆ†æå¤æ‚è¡¨æ ¼æ•°æ®(è¿œç¨‹æ–‡ä»¶)</title>
      <link href="/phpExcel%E5%88%86%E6%9E%90%E5%A4%8D%E6%9D%82%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6/"/>
      <url>/phpExcel%E5%88%86%E6%9E%90%E5%A4%8D%E6%9D%82%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>phpExcelæ˜¯ä¸€ä¸ªä¸“é—¨æ“ä½œæ•°æ®è¡¨æ ¼çš„ç±»ï¼Œä»–å¯ä»¥å¯¼å…¥ã€å¯¼å‡ºexcelè¡¨æ ¼ä¸­çš„æ•°æ®ï¼Œç®€å•ã€æ¼‚äº®ï¼Œéå¸¸é€‚åˆå¯¼å…¥ã€å¯¼å‡ºã€åˆ†ææ•°æ®æ¥ä½¿ç”¨ã€‚</p><p>ä»¥ä¸‹ä»£ç ä¸»è¦ä¸ºäº†å®ç°ä»é˜¿é‡ŒOSSä¸Šè·å–æ•°æ®è¡¨æ ¼ï¼Œå¹¶åˆ†æè¡¨æ ¼æ•°æ®å¯¼å…¥æ•°æ®åº“ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯è¿™ä¸ªè¡¨æ ¼æ˜¯ä¸è§„åˆ™ï¼Œåˆ†ææ•°æ®çš„è¯ç›¸å¯¹æ¥æ•°å¤æ‚äº†ä¸€äº›ï¼ŒåºŸè¯ä¸å¤šå°‘ï¼Œä¸‹é¢ç›´æ¥ä»‹ç»å¦‚ä½•å¤„ç†è¿™ç§å¤æ‚çš„è¡¨æ ¼ï¼š<br><a id="more"></a><br><blockquote><p>ç¬¬ä¸€æ­¥ï¼šåˆ†æè¡¨æ ¼</p></blockquote><br><img src="/phpExcelåˆ†æå¤æ‚è¡¨æ ¼æ•°æ®-è¿œç¨‹æ–‡ä»¶/img/1.png"><br>ç»è¿‡å¤„ç†ï¼ŒæŠŠè¿™ä¸ªåº•è‰²ä¸ºç™½è‰²çš„è¡¨æ ¼å¤„ç†æˆæ­£å¸¸çš„å½¢å¼<br><img src="/phpExcelåˆ†æå¤æ‚è¡¨æ ¼æ•°æ®-è¿œç¨‹æ–‡ä»¶/img/2.png"><br>ç»è¿‡å¤„ç†å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªè¡¨æ ¼çš„æ•°æ®æ˜¯æœ‰è§„å¾‹çš„ã€‚<br>åæ ‡B6æ˜¯è´¦å·ï¼ŒC6æ˜¯æˆ¿å·ï¼ŒD6æ˜¯æˆ¿ç±»ï¼Œä¸€æ¬¡ç±»æ¨ï¼Œæ¯è¡Œä¸åŒçš„æ•°æ®éƒ½æ˜¯ç”±ä¸åŒå­—æ¯å’Œæ•°å­—çš„ç»„åˆã€‚</p><p>ç‰¹æ®Šçš„ä¸€ç‚¹å°±æ˜¯æˆ¿ä»·åœ¨è¡Œæ•°æ®çš„ä¸‹ä¸€è¡Œï¼Œé€šè¿‡è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œæ¯è¡Œçš„çœŸå®æ•°æ®çš„åˆ—åæ ‡æ˜¯å¶æ•°ï¼Œç›¸å¯¹åº”çš„æˆ¿ä»·éƒ½æ˜¯åœ¨å¥‡æ•°ä¸Šï¼Œè¿™æ ·ä¸€åˆ†æå°±å¯ä»¥æ‰¾åˆ°æ–¹æ³•åˆ†ææ•°æ®äº†ã€‚</p><blockquote><p>ç¬¬äºŒæ­¥ï¼šå®ç°ä»£ç </p></blockquote><figure class="highlight php"><figcaption><span>å®ç°ä»£ç </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">'../excel/Classes/PHPExcel/IOFactory.php'</span>);<span class="comment">//é™æ€</span></span><br><span class="line">file_put_contents(<span class="string">'abc.xls'</span>,file_get_contents(<span class="string">'https://www.baidu.com/20190226/caf55125b3f510b9242235bfa7f06212.xls'</span>));</span><br><span class="line"></span><br><span class="line">$filePath = <span class="string">'abc.xls'</span>;</span><br><span class="line">$fileType = PHPExcel_IOFactory::identify($filePath);<span class="comment">//æ£€æµ‹æ–‡ä»¶ç±»å‹</span></span><br><span class="line">$fileRead = PHPExcel_IOFactory::createReader($fileType);<span class="comment">//è¯»å–æ–‡ä»¶</span></span><br><span class="line">$excelObj = $fileRead-&gt;load($filePath);</span><br><span class="line">$sheet = $excelObj-&gt;getActiveSheet();</span><br><span class="line">$highestRow = $sheet-&gt;getHighestRow();<span class="comment">//è¡Œæ•°</span></span><br><span class="line">$highestColumn = $sheet-&gt;getHighestColumn();<span class="comment">//åˆ—æ•°</span></span><br><span class="line"></span><br><span class="line">$dataSet = <span class="keyword">array</span>();<span class="comment">//æ•°æ®</span></span><br><span class="line"><span class="comment">//è¿™é‡Œæ˜¯ä»ç¬¬6è¡Œå¼€å§‹ï¼Œå› ä¸ºä¸Š5è¡Œéƒ½æ˜¯ç©ºçš„ï¼Œç›´æ¥è¿‡æ»¤</span></span><br><span class="line"><span class="keyword">for</span>($row = <span class="number">6</span>;$row&lt;=$highestRow<span class="number">-4</span>;$row++)&#123;</span><br><span class="line">    $dataSet[$row] = <span class="keyword">array</span>();</span><br><span class="line">    <span class="comment">//åˆ—ä»Bå¼€å§‹Aä¹Ÿæ˜¯ç©ºçš„</span></span><br><span class="line"><span class="keyword">for</span>($column=<span class="string">"B"</span>;$column&lt;=$highestColumn;$column++)&#123;</span><br><span class="line"><span class="comment">//å¦‚æœåˆ—åæ ‡æ˜¯F(æˆ¿ä»·) and æ˜¯å¥‡æ•°è¡Œï¼Œè¯´æ˜å·²ç»åˆ°æˆ¿ä»·é‚£ä¸€è¡Œäº†</span></span><br><span class="line"><span class="keyword">if</span>($column==<span class="string">'F'</span> &amp;&amp; $row%<span class="number">2</span>==<span class="number">1</span>)&#123;</span><br><span class="line"><span class="comment">//åˆ—åæ ‡æ˜¯F è¡Œåæ ‡7 7-1 å°±æ˜¯ä¸Šä¸€è¡Œ,è¿™é‡Œçš„æ„æ€å°±æ˜¯ä¸Šä¸€è¡Œçš„Fé‡Œçš„å€¼ç­‰äºä¸‹ä¸€è¡Œçš„Fçš„å€¼</span></span><br><span class="line">$dataSet[$row<span class="number">-1</span>][$column] = $sheet-&gt;getCell($column.$row)-&gt;getValue();</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//å¦‚æœåˆ—åæ ‡æ˜¯Lå’ŒNè¯´æ˜æ˜¯æ—¶é—´</span></span><br><span class="line"><span class="keyword">if</span>($column ==<span class="string">'L'</span> || $column == <span class="string">'N'</span>)&#123;</span><br><span class="line">$time = $sheet-&gt;getCell($column.$row)-&gt;getValue();</span><br><span class="line"><span class="comment">//è½¬åŒ–æ—¶é—´</span></span><br><span class="line">$dataSet[$row][$column] = date(<span class="string">'Y-m-d H:i:s'</span>,PHPExcel_Shared_Date::ExcelToPHP($time));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$dataSet[$row][$column] = $sheet-&gt;getCell($column.$row)-&gt;getValue();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ é™¤å·²ç»åˆå¹¶è¿‡çš„å¥‡æ•°è¡Œ</span></span><br><span class="line"><span class="keyword">if</span>($row%<span class="number">2</span>==<span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">unset</span>($dataSet[$row]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//åˆ é™¤ç©ºæ•°ç»„</span></span><br><span class="line">$dataSet[$row] = array_filter($dataSet[$row]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">print_r($dataSet);</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹ç»“æœ</p></blockquote><figure class="highlight php"><figcaption><span>æ‰“å°æ•°æ®</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">6</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [B] =&gt; <span class="number">233756</span></span><br><span class="line">            [C] =&gt; <span class="number">1</span>AC65</span><br><span class="line">            [D] =&gt; DDYG</span><br><span class="line">            [G] =&gt; æˆ´</span><br><span class="line">            [L] =&gt; <span class="number">2019</span><span class="number">-02</span><span class="number">-04</span> <span class="number">12</span>:<span class="number">42</span>:<span class="number">00</span></span><br><span class="line">            [N] =&gt; <span class="number">2019</span><span class="number">-03</span><span class="number">-06</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">            [F] =&gt; <span class="number">400</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">8</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [B] =&gt; <span class="number">233758</span></span><br><span class="line">            [C] =&gt; <span class="number">1</span>BC65</span><br><span class="line">            [D] =&gt; DDYG</span><br><span class="line">            [G] =&gt; æˆ´</span><br><span class="line">            [H] =&gt; <span class="number">48</span>+<span class="number">456</span>+<span class="number">844654654</span></span><br><span class="line">            [L] =&gt; <span class="number">2019</span><span class="number">-02</span><span class="number">-04</span> <span class="number">12</span>:<span class="number">44</span>:<span class="number">00</span></span><br><span class="line">            [N] =&gt; <span class="number">2019</span><span class="number">-03</span><span class="number">-06</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">            [F] =&gt; <span class="number">400</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">10</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [B] =&gt; <span class="number">241572</span></span><br><span class="line">            [C] =&gt; E55b</span><br><span class="line">            [D] =&gt; DDYG</span><br><span class="line">            [G] =&gt; æˆ´</span><br><span class="line">            [L] =&gt; <span class="number">2019</span><span class="number">-02</span><span class="number">-16</span> <span class="number">09</span>:<span class="number">40</span>:<span class="number">00</span></span><br><span class="line">            [N] =&gt; <span class="number">2019</span><span class="number">-03</span><span class="number">-30</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">            [F] =&gt; <span class="number">0</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">12</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [B] =&gt; <span class="number">246484</span></span><br><span class="line">            [C] =&gt; <span class="number">2</span>AC52</span><br><span class="line">            [D] =&gt; YGTYF</span><br><span class="line">            [G] =&gt; æˆ´</span><br><span class="line">            [H] =&gt; <span class="number">476</span>+<span class="number">5456456156415641</span></span><br><span class="line">            [I] =&gt; åšå®¢</span><br><span class="line">            [L] =&gt; <span class="number">2019</span><span class="number">-02</span><span class="number">-25</span> <span class="number">17</span>:<span class="number">23</span>:<span class="number">00</span></span><br><span class="line">            [N] =&gt; <span class="number">2019</span><span class="number">-02</span><span class="number">-27</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">            [F] =&gt; <span class="number">362</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">14</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [B] =&gt; <span class="number">246485</span></span><br><span class="line">            [C] =&gt; <span class="number">2</span>BC52</span><br><span class="line">            [D] =&gt; YGTYF</span><br><span class="line">            [G] =&gt; æˆ´</span><br><span class="line">            [H] =&gt; <span class="number">415645156</span></span><br><span class="line">            [I] =&gt; åšå®¢</span><br><span class="line">            [L] =&gt; <span class="number">2019</span><span class="number">-02</span><span class="number">-25</span> <span class="number">17</span>:<span class="number">24</span>:<span class="number">00</span></span><br><span class="line">            [N] =&gt; <span class="number">2019</span><span class="number">-02</span><span class="number">-27</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">            [F] =&gt; <span class="number">362</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">16</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [B] =&gt; <span class="number">246486</span></span><br><span class="line">            [C] =&gt; D86a</span><br><span class="line">            [D] =&gt; DDYG</span><br><span class="line">            [G] =&gt; æˆ´</span><br><span class="line">            [H] =&gt; <span class="number">156</span>+<span class="number">1112</span></span><br><span class="line">            [L] =&gt; <span class="number">2019</span><span class="number">-02</span><span class="number">-25</span> <span class="number">17</span>:<span class="number">25</span>:<span class="number">00</span></span><br><span class="line">            [N] =&gt; <span class="number">2019</span><span class="number">-02</span><span class="number">-28</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">            [P] =&gt; ä¸šä¸»è‡ªä¸»</span><br><span class="line">            [F] =&gt; <span class="number">0</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å¾ˆå®Œç¾ï¼Œå¦‚æœ‰å…¶å®ƒéœ€è¦å¯æ ¹æ®ä»£ç è°ƒæ•´ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> phpæ‰©å±•ç±» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phpExcel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>laravelå°ç¨‹åºæ¨¡æ¿æ¶ˆæ¯å‘é€</title>
      <link href="/larveral%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%A8%A1%E6%9D%BF%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81/"/>
      <url>/larveral%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%A8%A1%E6%9D%BF%E6%B6%88%E6%81%AF%E5%8F%91%E9%80%81/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æ¥ä¸€ç¯‡laravel5.5çš„å°ç¨‹åºæ¨¡æ¿æ¶ˆæ¯å‘é€ç¤ºä¾‹ï¼Œæ€»æ„Ÿè§‰ç”¨laravelæ¡†æ¶å†™çš„ä»£ç é€¼æ ¼é«˜äº†å¾ˆå¤šï¼Œå¥‡æ€ªï¼ï¼</p><p>1.å°ç¨‹åºå‘ç”¨æˆ·å‘é€æ¨¡æ¿æ¶ˆæ¯åˆ†ä¸ºä¸¤æ­¥ï¼š<br>    ç¬¬ä¸€æ­¥ï¼šç”¨æˆ·åœ¨å°ç¨‹åºä¸Šè¿›è¡Œè¡¨å•æ“ä½œ(ä¾‹å¦‚æäº¤è¡¨å•),æ­¤æ—¶å‰ç«¯è¦è·å–åˆ°form_idä¼ é€’ç»™åç«¯<br>    ç¬¬äºŒæ­¥ï¼šåç«¯æ¥æ”¶åˆ°from_idï¼Œå†æŸ¥è¯¢ç”¨æˆ·çš„openidï¼ŒæŒ‰ç…§å¾®ä¿¡æ–‡æ¡£çš„æ•°æ®æ ¼å¼è¿›è¡Œå‘é€<br>2.å‘é€ä¹‹å‰æœ‰ä¸€ä¸‹å‡ ä¸ªå‰æ:<br>    ç¬¬ä¸€:å¾®ä¿¡å°ç¨‹åºä»¥å¼€é€šäº†æ¶ˆæ¯æœåŠ¡<br>    ç¬¬äºŒ:å¾®ä¿¡å°ç¨‹åºä»¥é…ç½®äº†æ¨¡æ¿æ¶ˆæ¯<br>    ç¬¬ä¸‰:å‘é€çš„æ•°æ®å†…å®¹å¿…é¡»å’Œå¾®ä¿¡å°ç¨‹åºé…ç½®çš„æ¨¡æ¿æ¶ˆæ¯ä¸€è‡´<br>    ç¬¬å››:è·å–åˆ°æ­£ç¡®çš„ç”¨æˆ·openid<br>    ç¬¬äº”:è·å–åˆ°æœªè¿‡æœŸçš„å¾®ä¿¡access_token<br><a id="more"></a><br><blockquote><p>é¦–å…ˆæ˜¯å‘é€ç¤ºä¾‹:</p></blockquote></p><figure class="highlight php"><figcaption><span>phpä»£ç </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WxHelper</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * seedTempMessage å‘é€æ¨¡æ¿æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> DaiChong</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@DateTime</span> 2019-01-04</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>    array      $seedData    éœ€è¦å‘é€çš„æ•°æ® æ ¼å¼ä¸º(key=&gt;value)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>    string     $tempKey     tempkey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>   json</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">seedTempMessage</span><span class="params">($seedData,$tempKey)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( <span class="keyword">empty</span>($seedData) )&#123;</span><br><span class="line">            <span class="keyword">self</span>::seedError(<span class="string">'è¯·ä¼ è¾“æ•°æ®(æ ¼å¼ä¸ºArray)ï¼'</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€æ¨¡æ¿æ¶ˆæ¯åœ°å€</span></span><br><span class="line">        $postUrl = config(<span class="string">"company.seedTempMeg"</span>);</span><br><span class="line">        <span class="keyword">if</span>( $postUrl == <span class="keyword">false</span> )&#123;</span><br><span class="line">            <span class="keyword">self</span>::seedError(<span class="string">'æœªå®šä¹‰å¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯åœ°å€(seedTempMeg)ï¼'</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($tempKey)&#123;</span><br><span class="line">            <span class="comment">//æŸ¥è¯¢æ¶ˆæ¯æ¨¡æ¿å†…å®¹</span></span><br><span class="line">            $temp = \App\Models\WechatMessageModel::where(<span class="string">'temp_key'</span>,$tempKey)-&gt;first()-&gt;toArray();</span><br><span class="line">            <span class="keyword">if</span>( <span class="keyword">empty</span>($temp) )&#123;</span><br><span class="line">                <span class="keyword">self</span>::seedError(<span class="string">'æœªæ·»åŠ æ­¤æ¨¡æ¿!'</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            $seedData[<span class="string">'template_id'</span>] = $temp[<span class="string">'temp_id'</span>];</span><br><span class="line">            $temp_context = $temp[<span class="string">'context'</span>];</span><br><span class="line">            $temp_json = vsprintf($temp_context,$seedData);<span class="comment">//æ›¿æ¢æ•°æ®</span></span><br><span class="line"></span><br><span class="line">            $temp_array = json_decode($temp_json,<span class="keyword">true</span>);</span><br><span class="line">            <span class="comment">//è·å–AccessToken</span></span><br><span class="line">            $accessToken = <span class="keyword">self</span>::getAccessToken();</span><br><span class="line">            $postUrl = str_replace(<span class="string">'ACCESS_TOKEN'</span>, $accessToken, $postUrl);</span><br><span class="line">            $curl = <span class="keyword">new</span> \JSocket();</span><br><span class="line">            $curl-&gt;setUrl($postUrl);</span><br><span class="line">            $curl-&gt;setRetFormat(\JSocket::retFormatText);</span><br><span class="line">            <span class="keyword">foreach</span> ($temp_array <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">                $curl-&gt;setParam($key,$value);</span><br><span class="line">            &#125;</span><br><span class="line">            $curl-&gt;setTimeout(<span class="number">30</span>);</span><br><span class="line">            $curl-&gt;setHeader(<span class="string">"Content-Type:application/json"</span>);</span><br><span class="line">            $curl-&gt;setRequestType(\JSocket::retFormatJson);</span><br><span class="line">            $curl-&gt;setMethod(\JSocket::methodPost);</span><br><span class="line">            $curl-&gt;exe();</span><br><span class="line">            $result = $curl-&gt;getRet();</span><br><span class="line">            <span class="keyword">self</span>::seedError($result);</span><br><span class="line">            <span class="keyword">return</span> $result;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">self</span>::seedError(<span class="string">'æœªä¼ å…¥æ¨¡æ¿Key(tempKey)!'</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–å¾®ä¿¡AccessToken æˆ‘è¿™é‡Œå·²ç»åšäº†access_tokenå¤„ç†ï¼Œå…·ä½“ç»†èŠ‚æŒ‰ç…§å¾®ä¿¡æ–‡æ¡£è¿›è¡Œæ“ä½œæˆ–è¯„è®º</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getAccessToken</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $access_token = \App\Data\WxAccessTokenData::info();</span><br><span class="line">        <span class="keyword">if</span> ($access_token)&#123;</span><br><span class="line">            <span class="keyword">return</span> $access_token;</span><br><span class="line">        &#125;</span><br><span class="line">        $getAccessTokenUrl = config(<span class="string">"company.getAccessToken"</span>);</span><br><span class="line">        $getAccessTokenUrl = str_replace([<span class="string">"APPID"</span>,<span class="string">"APPSECRET"</span>],[config(<span class="string">"company.appid"</span>),config(<span class="string">"company.appsecret"</span>)],$getAccessTokenUrl);</span><br><span class="line">        $curl = <span class="keyword">new</span> \JSocket();</span><br><span class="line">        $curl-&gt;setUrl($getAccessTokenUrl);</span><br><span class="line">        $curl-&gt;setRetFormat(\JSocket::retFormatJson);</span><br><span class="line">        $curl-&gt;setTimeout(<span class="number">30</span>);</span><br><span class="line">        $curl-&gt;setMethod(\JSocket::methodGet);</span><br><span class="line">        $curl-&gt;exe();</span><br><span class="line">        $r = $curl-&gt;getRet();</span><br><span class="line">        <span class="keyword">return</span> \App\Data\WxAccessTokenData::set($r[<span class="string">"access_token"</span>],$r[<span class="string">"expires_in"</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å‘é€å¤±è´¥</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">seedError</span><span class="params">($msg)</span></span>&#123;</span><br><span class="line">        \Log::info($msg);</span><br><span class="line">        <span class="keyword">return</span> \ResponseHelper::success([</span><br><span class="line">            <span class="string">'code'</span>    =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">'message'</span> =&gt; $msg</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ•°æ®é…ç½®:</p></blockquote><figure class="highlight json"><figcaption><span>é…ç½®</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"touser"</span>:<span class="string">"%s"</span>,</span><br><span class="line">    <span class="attr">"template_id"</span>:<span class="string">"%s"</span>,</span><br><span class="line">    <span class="attr">"page"</span>:<span class="string">"%s"</span>,</span><br><span class="line">    <span class="attr">"form_id"</span>:<span class="string">"%s"</span>,</span><br><span class="line">    <span class="attr">"data"</span>:&#123;</span><br><span class="line">        <span class="attr">"keyword1"</span>:&#123;</span><br><span class="line">            <span class="attr">"value"</span>:<span class="string">"%s"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"keyword2"</span>:&#123;</span><br><span class="line">            <span class="attr">"value"</span>:<span class="string">"%s"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"keyword3"</span>:&#123;</span><br><span class="line">            <span class="attr">"value"</span>:<span class="string">"%s"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"keyword4"</span>:&#123;</span><br><span class="line">            <span class="attr">"value"</span>:<span class="string">"%s"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"keyword5"</span>:&#123;</span><br><span class="line">            <span class="attr">"value"</span>:<span class="string">"%s"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé…ç½®ä¹Ÿè¦å’Œå¾®ä¿¡æ¨¡æ¿æ¶ˆæ¯çš„é…ç½®ä¸€è‡´ï¼Œä¾‹å¦‚æ¨¡æ¿æ¶ˆæ¯çš„é…ç½®å†…å®¹æœ€å¤šåˆ°keyword8,é‚£ä¹ˆè¿™é‡Œå°±è¦åœ¨å¤åˆ¶3ä¸ª,â€keyword5â€:{â€œvalueâ€:â€%sâ€}å‡ºæ¥æ·»åŠ åˆ°åé¢ï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®çš„å†…å®¹éƒ½æ˜¯ç”¨<a>%s</a>è¡¨ç¤ºçš„ï¼Œå°±æ˜¯ä¸ºäº†ä½¿ç”¨<a href="http://php.net/manual/en/function.vsprintf.php" title="phpå®˜ç½‘ä»‹ç»" target="_blank" rel="noopener">vsprintf</a>æ›¿æ¢æ•°æ®ã€‚<br><blockquote><p>å‘é€é…ç½®:</p></blockquote><br><figure class="highlight php"><figcaption><span>å‘é€é…ç½®</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‘é€æ¨¡æ¿æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">postSeedTemp</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $request = \Request::all();</span><br><span class="line">        <span class="keyword">if</span>( $request[<span class="string">'openid'</span>] == <span class="keyword">false</span> || $request[<span class="string">'form_id'</span>] == <span class="keyword">false</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> \ResponseHelper::error(<span class="string">"ç¼ºå°‘å‚æ•°!"</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $array = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'touser'</span>       =&gt; $request[<span class="string">'openid'</span>],</span><br><span class="line">            <span class="string">'template_id'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">            <span class="string">'page'</span>         =&gt; <span class="string">'pages/home/home'</span>,</span><br><span class="line">            <span class="string">'form_id'</span>      =&gt; $request[<span class="string">'form_id'</span>],</span><br><span class="line">            <span class="string">'keyword1'</span>     =&gt; <span class="string">'å–å®¶æ­£åœ¨ç§¯æå‡†å¤‡å•†å“'</span>,</span><br><span class="line">            <span class="string">'keyword2'</span>     =&gt; <span class="string">'é¡ºä¸°å¿«é€’'</span>,</span><br><span class="line">            <span class="string">'keyword3'</span>     =&gt; <span class="string">'4324242342'</span>,</span><br><span class="line">            <span class="string">'keyword4'</span>     =&gt; <span class="string">'S123456789'</span>,</span><br><span class="line">            <span class="string">'keyword5'</span>     =&gt; <span class="string">'ä½ çš„ç‰©æµçŠ¶æ€å·²æ›´æ–°'</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span> \ResponseHelper::success([</span><br><span class="line">            <span class="string">'result'</span> =&gt; \WxHelper::seedTempMessage($array,<span class="string">'logisticsMsg'</span>)</span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹å‡ºè¿™é‡Œçš„é…ç½®å’Œæ•°æ®é…ç½®æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚<br><blockquote><p>curlæ¨¡æ‹Ÿæäº¤ç¤ºä¾‹:</p></blockquote><br><figure class="highlight php"><figcaption><span>curlç±»</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JSocket</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> methodGet=<span class="string">"GET"</span>;              <span class="comment">//å‘èµ·GETè¯·æ±‚</span></span><br><span class="line">    <span class="keyword">const</span> methodPost=<span class="string">"POST"</span>;            <span class="comment">//å‘èµ·POSTè¯·æ±‚</span></span><br><span class="line">    <span class="keyword">const</span> methodDelete=<span class="string">"DELETE"</span>;        <span class="comment">//å‘èµ·DELETEè¯·æ±‚</span></span><br><span class="line">    <span class="keyword">const</span> methodPut=<span class="string">"PUT"</span>;          <span class="comment">//å‘èµ·PUTè¯·æ±‚</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> retFormatJson=<span class="string">"JSON"</span>;     <span class="comment">//è¿”å›jsonæ ¼å¼</span></span><br><span class="line">    <span class="keyword">const</span> retFormatXml=<span class="string">"XML"</span>;       <span class="comment">//è¿”å›XMLæ ¼å¼</span></span><br><span class="line">    <span class="keyword">const</span> retFormatText=<span class="string">"Text"</span>;       <span class="comment">//è¿”å›XMLæ ¼å¼</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> $ch;            <span class="comment">//é“¾æ¥å¯¹è±¡</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> $url;               <span class="comment">//è¯·æ±‚åœ°å€</span></span><br><span class="line">    <span class="keyword">private</span> $requestType;       <span class="comment">//è¯·æ±‚æ–¹å¼</span></span><br><span class="line">    <span class="keyword">private</span> $param=[];             <span class="comment">//è¯·æ±‚å‚æ•°</span></span><br><span class="line">    <span class="keyword">private</span> $timeout=<span class="number">10</span>;           <span class="comment">//è¶…æ—¶æ—¶é—´</span></span><br><span class="line">    <span class="keyword">private</span> $header=[];         <span class="comment">//è¯·æ±‚å¤´ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">private</span> $method=JSocket::methodGet;        <span class="comment">//è¯·æ±‚æ–¹å¼</span></span><br><span class="line">    <span class="keyword">private</span> $file;          <span class="comment">//æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">private</span> $ssl;           <span class="comment">//è¯ä¹¦æ–‡ä»¶</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> $ret;                                   <span class="comment">//è¿”å›ç»“æœ</span></span><br><span class="line">    <span class="keyword">private</span> $retFormat=JSocket::retFormatJson;      <span class="comment">//è¿”å›æ ¼å¼</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ch = curl_init();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setRetFormat</span><span class="params">($retFormat)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;retFormat=$retFormat;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setRequestType</span><span class="params">($requestType)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;requestType=$requestType;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è¯·æ±‚åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setUrl</span><span class="params">($url)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;url=$url;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è¯·æ±‚å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \JSocket</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setParam</span><span class="params">($key,$value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;param[$key]=$value;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–è¯·æ±‚å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \JSocket</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getParam</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;param;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $timeout</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \JSocket</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setTimeout</span><span class="params">($timeout)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;timeout=$timeout;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è¯·æ±‚å¤´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $header</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \JSocket</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setHeader</span><span class="params">($header)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;header[]=$header;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è¯·æ±‚æ–¹å¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $method</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \JSocket</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setMethod</span><span class="params">($method)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;method=$method;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®å‘é€æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \JSocket</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setFile</span><span class="params">($key,$file)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file[$key]=curl_file_create($file);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®æ•´æ•°æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type $ssl</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \JSocket</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">ssl</span><span class="params">($ssl)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ssl=$ssl;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯·æ±‚æ¥å£</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \JSocket</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">exe</span><span class="params">()</span></span>&#123;</span><br><span class="line">        curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_TIMEOUT, <span class="keyword">$this</span>-&gt;timeout);</span><br><span class="line">        curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_RETURNTRANSFER, <span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;header)&#123;</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_HTTPHEADER, <span class="keyword">$this</span>-&gt;header);</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_HEADER,<span class="keyword">FALSE</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;method)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">self</span>::methodPost:</span><br><span class="line">                curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_POST, <span class="keyword">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;file)&#123;</span><br><span class="line">                    curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_POSTFIELDS, <span class="keyword">$this</span>-&gt;file);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;param)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;requestType==<span class="keyword">self</span>::retFormatJson)&#123;</span><br><span class="line">                        curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_POSTFIELDS, json_encode(<span class="keyword">$this</span>-&gt;param));</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;requestType==<span class="keyword">self</span>::retFormatXml)&#123;</span><br><span class="line">                        curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_POSTFIELDS, \DataBaseHelper::arrayToXml(<span class="keyword">$this</span>-&gt;param));</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_POSTFIELDS, http_build_query(<span class="keyword">$this</span>-&gt;param));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">self</span>::methodDelete:</span><br><span class="line">                curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_CUSTOMREQUEST, <span class="string">'DELETE'</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">self</span>::methodGet:</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;param)&#123;</span><br><span class="line">                    <span class="keyword">$this</span>-&gt;url = <span class="keyword">$this</span>-&gt;url . (strpos(<span class="keyword">$this</span>-&gt;url, <span class="string">'?'</span>) ? <span class="string">'&amp;'</span> : <span class="string">'?'</span>) . http_build_query(<span class="keyword">$this</span>-&gt;param);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;ssl)&#123;</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_SSLCERTTYPE,<span class="string">'PEM'</span>);</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_SSLCERT, <span class="keyword">$this</span>-&gt;ssl[<span class="string">'cert'</span>]);</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_SSLKEYTYPE,<span class="string">'PEM'</span>);</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_SSLKEY, <span class="keyword">$this</span>-&gt;ssl[<span class="string">'key'</span>]);</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_SSL_VERIFYPEER,<span class="keyword">TRUE</span>);</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_SSL_VERIFYHOST,<span class="number">2</span>);<span class="comment">//ä¸¥æ ¼æ ¡éªŒ</span></span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_HEADER, <span class="keyword">FALSE</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;ssl[<span class="string">'ca'</span>]))&#123;</span><br><span class="line">                curl_setopt(<span class="keyword">$this</span>-&gt;ch,CURLOPT_CAINFO, <span class="keyword">$this</span>-&gt;ssl[<span class="string">'ca'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);</span><br><span class="line">            curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_SSL_VERIFYHOST, <span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        curl_setopt(<span class="keyword">$this</span>-&gt;ch, CURLOPT_URL, <span class="keyword">$this</span>-&gt;url);</span><br><span class="line">        $starttime=<span class="keyword">$this</span>-&gt;microtimeFloat();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;ret = curl_exec(<span class="keyword">$this</span>-&gt;ch);</span><br><span class="line">        $endtime = <span class="keyword">$this</span>-&gt;microtimeFloat();</span><br><span class="line">        $errorNum=curl_errno(<span class="keyword">$this</span>-&gt;ch);</span><br><span class="line">        $errorMsg=curl_error(<span class="keyword">$this</span>-&gt;ch);</span><br><span class="line">        $runtime = number_format(($endtime-$starttime), <span class="number">4</span>).<span class="string">'s'</span>;</span><br><span class="line">        <span class="keyword">if</span>($errorNum)&#123;</span><br><span class="line">            Log::error(<span class="keyword">$this</span>-&gt;url, [<span class="string">"param"</span>=&gt;<span class="keyword">$this</span>-&gt;param,<span class="string">"result"</span>=&gt;$errorNum,<span class="string">"runtime"</span>=&gt;$runtime,<span class="string">"response"</span>=&gt;<span class="keyword">$this</span>-&gt;ret]);</span><br><span class="line">            Log::error(<span class="string">"curlè¯·æ±‚é”™è¯¯ä¿¡æ¯ï¼š"</span>.$errorMsg);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;http_code = curl_getinfo(<span class="keyword">$this</span>-&gt;ch,CURLINFO_HTTP_CODE); </span><br><span class="line">        curl_close (<span class="keyword">$this</span>-&gt;ch);</span><br><span class="line">        Log::info(<span class="keyword">$this</span>-&gt;url, [<span class="string">"param"</span>=&gt;<span class="keyword">$this</span>-&gt;param,<span class="string">"status"</span>=&gt;<span class="keyword">$this</span>-&gt;http_code,<span class="string">"runtime"</span>=&gt;$runtime,<span class="string">"response"</span>=&gt;<span class="keyword">$this</span>-&gt;ret]);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getRet</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;retFormat)&#123;</span><br><span class="line">            <span class="keyword">case</span> JSocket::retFormatJson:</span><br><span class="line">                <span class="keyword">return</span> json_decode(<span class="keyword">$this</span>-&gt;ret,<span class="keyword">TRUE</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> JSocket::retFormatXml:</span><br><span class="line">                <span class="keyword">return</span> \DataBaseHelper::xmlToArray(<span class="keyword">$this</span>-&gt;ret);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;ret;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getHttpCode</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;http_code;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç²¾ç¡®æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> type</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">microtimeFloat</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">list</span>($usec, $sec) = explode(<span class="string">" "</span>, microtime());</span><br><span class="line">        <span class="keyword">return</span> ((float)$usec + (float)$sec);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> phpæ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tp5æ¨¡å‹äº‹ä»¶â€˜before_insertâ€™ç”¨æ³•</title>
      <link href="/tp5%E6%A8%A1%E5%9E%8B%E4%BA%8B%E4%BB%B6%E2%80%98beforeInsert%E2%80%99%E7%94%A8%E6%B3%95/"/>
      <url>/tp5%E6%A8%A1%E5%9E%8B%E4%BA%8B%E4%BB%B6%E2%80%98beforeInsert%E2%80%99%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<blockquote><p>tp5çš„æ¨¡å‹äº‹ä»¶åªæœ‰åœ¨è°ƒç”¨æ¨¡å‹æ–¹æ³•çš„æ—¶å€™ç”Ÿæ•ˆï¼Œä½¿ç”¨æŸ¥è¯¢æ„é€ å™¨æ˜¯æ— æ•ˆçš„ã€‚</p><footer><strong>å¼•è¨€TP5å®˜ç½‘</strong></footer></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å®ä¾‹åŒ–æ¨¡å‹è¿›è¡Œæ“ä½œbefore_insertè¿™ä¸ªæ–¹æ³•æ˜¯ä¸æ‰§è¡Œçš„ã€‚</p><p>æ¨¡å‹çš„æ„ä¹‰å°±æ˜¯ä¸ºäº†ç®€åŒ–æ§åˆ¶å™¨æ“ä½œï¼Œç®€åŒ–é€»è¾‘å¤„ç†ï¼Œæå‡ä»£ç çš„æ•´æ´åº¦å’Œå¯è¯»æ€§ã€‚è¿™æ ·ä¸€æ¥æ¨¡å‹äº‹ä»¶èµ·åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚<br><a id="more"></a><br>è¿™ç¯‡æ–‡ç« å°±ä»‹ç»ä¸€ä¸‹æ¨¡å‹äº‹ä»¶â€˜before_insertâ€™äº‹ä»¶å¯¹äºä¸‹å•é€»è¾‘çš„å¸®åŠ©ã€‚<br><figure class="highlight php"><figcaption><span>æ¨¡å‹ShopOrder</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">common</span>\<span class="title">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">daichongweb</span>\<span class="title">helper</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShopOrderM</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">protected</span> $table = <span class="string">'shop_text'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">self</span>::beforeInsert(<span class="function"><span class="keyword">function</span><span class="params">($ShopOrderM)</span></span>&#123;</span><br><span class="line"><span class="comment">//åˆ›å»ºè®¢å•å·</span></span><br><span class="line">       $ShopOrderM[<span class="string">'orderno'</span>] = helper::buildOrderno(<span class="string">'T'</span>, <span class="string">'shop_text'</span>);$ShopOrderM[<span class="string">'name'</span>] = $ShopOrderM[<span class="string">'name'</span>].<span class="string">'1'</span>;<span class="comment">//å¤„ç†å‰ç«¯ä¼ è¿‡æ¥çš„æ•°æ®è¿›è¡Œæ“ä½œ</span></span><br><span class="line">       <span class="keyword">return</span> $ShopOrderM;</span><br><span class="line">&#125;,<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight php"><figcaption><span>æ§åˆ¶å™¨</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">api</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">daichongweb</span>\<span class="title">helper</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">response</span>\<span class="title">Json</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Db</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">facade</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">facade</span>\<span class="title">Cache</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">api</span>\<span class="title">controller</span>\<span class="title">ShopMain</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•†åŸä¸‹å•æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShopOrder</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹å•æµ‹è¯•</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">orderText</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$info = input();</span><br><span class="line"><span class="comment">//éªŒè¯å™¨</span></span><br><span class="line">$validate = <span class="keyword">new</span> \app\common\validate\ShopOrderV();</span><br><span class="line">        <span class="keyword">if</span>(!$validate-&gt;check($info)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Json([</span><br><span class="line"><span class="string">'code'</span>    =&gt; <span class="number">1</span>,</span><br><span class="line"><span class="string">'message'</span> =&gt; $validate-&gt;getError(),</span><br><span class="line">]);</span><br><span class="line">        &#125;</span><br><span class="line">$shopOrder = <span class="keyword">new</span> \app\common\model\ShopOrderM();</span><br><span class="line">$shopOrder-&gt;save($info);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»æ§åˆ¶å™¨çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œæ§åˆ¶å™¨çš„é€»è¾‘å¤„ç†åªæœ‰æ¥æ”¶æ•°æ®ã€éªŒè¯ã€æ‰§è¡Œæ’å…¥ã€‚<br>ç”Ÿæˆè®¢å•ã€å¤„ç†æ•°æ®å…¨éƒ¨æ”¾åœ¨æ¨¡å‹çš„æ–°å¢å‰å¤„ç†ã€‚<br>$ShopOrderM[â€˜nameâ€™] = $ShopOrderM[â€˜nameâ€™].â€™1â€™;è¿™é‡Œå°±æ˜¯è‡ªåŠ¨å‘æ•°æ®è¡¨çš„nameæ’å…¥æ•°æ®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> phpæ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tp5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tp5ç±»çš„å±æ€§ä¸å­˜åœ¨</title>
      <link href="/tp5%E7%B1%BB%E7%9A%84%E5%B1%9E%E6%80%A7%E4%B8%8D%E5%AD%98%E5%9C%A8/"/>
      <url>/tp5%E7%B1%BB%E7%9A%84%E5%B1%9E%E6%80%A7%E4%B8%8D%E5%AD%98%E5%9C%A8/</url>
      
        <content type="html"><![CDATA[<p>tp5æ¨¡å‹æ–°å¢å…³è”æŠ¥é”™ç±»çš„å±æ€§ä¸å­˜åœ¨,å³ä½¿æ•°æ®è¡¨ä¸­å­˜åœ¨éœ€è¦çš„å­—æ®µï¼Œä½†æ˜¯ä¾ç„¶æŠ¥é”™app\common\model\Slide-&gt;is_slideç±»ä¼¼çš„é—®é¢˜ï¼Œå…¶å®æ˜¯å› ä¸ºåœ¨ä½¿ç”¨å…³è”æ¨¡å‹æ–°å¢çš„æ—¶å€™ä¸»è¡¨æ–°å¢æ“ä½œæœªä½¿ç”¨æ¨¡å‹æ–°å¢ã€‚<br><a id="more"></a><br><figure class="highlight php"><figcaption><span>é”™è¯¯å†™æ³•</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç›´æ¥æ–°å¢æœªä½¿ç”¨æ¨¡å‹</span></span><br><span class="line">$result = Db::name(<span class="string">'table'</span>)-&gt;allowField(<span class="keyword">true</span>)-&gt;save($info);</span><br><span class="line"><span class="comment">//ç„¶åä½¿ç”¨æ¨¡å‹æ–°å¢</span></span><br><span class="line">$model = <span class="keyword">new</span> \app\common\model\ShopCommentM();</span><br><span class="line">$model-&gt;comment_image()-&gt;saveAll($imageData);</span><br></pre></td></tr></table></figure></p><figure class="highlight php"><figcaption><span>æ­£ç¡®å†™æ³•</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…ˆä½¿ç”¨æ¨¡å‹æ–°å¢ä¸»è¡¨ï¼Œå†æ–°å¢å…³è”è¡¨</span></span><br><span class="line">$model = <span class="keyword">new</span> \app\common\model\ShopCommentM();</span><br><span class="line">$model-&gt;allowField(<span class="keyword">true</span>)-&gt;save($info);</span><br><span class="line">$model-&gt;comment_image()-&gt;saveAll($imageData);</span><br></pre></td></tr></table></figure><figure class="highlight php"><figcaption><span>æ¨¡å‹æ–‡ä»¶</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸»è¡¨æ¨¡å‹</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">common</span>\<span class="title">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShopCommentM</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">protected</span> $table = <span class="string">'shop_comment'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">comment_image</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;hasMany(<span class="string">'ShopCommentImageM'</span>,<span class="string">'comment_id'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å…³è”è¡¨æ¨¡å‹</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">common</span>\<span class="title">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShopCommentImageM</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">protected</span> $table = <span class="string">'shop_comment_image'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> tp5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå…³äºtraitçš„ä½¿ç”¨</title>
      <link href="/php%E5%85%B3%E4%BA%8Etrait%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/php%E5%85%B3%E4%BA%8Etrait%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>å…³äºtraitä¹‹å‰å¯ä»¥è¯´æ˜¯å®Œå…¨æ²¡æœ‰äº†è§£è¿‡ï¼Œçœ‹äº†å®˜æ–¹æ–‡æ¡£ä¹‹åæ‰å¾—çŸ¥æ˜¯php5.4çš„æ–°ç‰¹æ€§,ç”¨æ¥è§£å†³åœ¨ä¸åŒç»“æ„(æ¨¡å—)ä¸‹ä»£ç å¤ç”¨çš„é—®é¢˜.å…·ä½“å¯ä»¥æŸ¥çœ‹<a href="http://php.net/traits" target="_blank" rel="noopener">phpæ‰‹å†Œ</a><br>æ‰‹å†Œçš„ä»‹ç»ç›¸å¯¹æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œé‚£è¿™ç¯‡æ–‡ç« å°±æ˜¯ä¸ºäº†çŒ®ç»™é‚£äº›ä¸å–œæ¬¢çœ‹æ–‡æ¡£ï¼Œå–œæ¬¢ç›´æ¥ä¸Šæ‰‹ä½¿ç”¨çš„ç«¥é‹.</p><p>é¦–å…ˆä»‹ç»ä¸€ä¸‹æˆ‘çš„é¡¹ç›®ç»“æ„ æˆ‘åœ¨Commonæ¨¡å—ä¸‹æ–°å»ºäº†ä¸€ä¸ªæ–‡ä»¶traits å‘½åç©ºé—´ä¸º common/traitsã€‚</p><p>ç°åœ¨æœ‰å¤šä¸ªæ¨¡å—éœ€è¦ä½¿ç”¨ç›¸åŒçš„ä»£ç ï¼Œé‚£ä¹ˆå°±åœ¨traitsä¸‹æ–°å»ºä¸€ä¸ªæ§åˆ¶å™¨,å†™å…¥å…¬ç”¨çš„ä»£ç <br><a id="more"></a><br><figure class="highlight php"><figcaption><span>common/traits/ShopGoods.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> \<span class="title">common</span>\<span class="title">traits</span>;</span><br><span class="line"><span class="keyword">trait</span> ShopGoods&#123;</span><br><span class="line"><span class="keyword">use</span> \<span class="title">app</span>\<span class="title">common</span>\<span class="title">traits</span>\<span class="title">ShopCommon</span>;<span class="comment">//è¿™é‡Œæ˜¯å¼•ç”¨äº†å…¶ä»–çš„å…¬å…±æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å•†å“æ•°æ®</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">goodsList</span><span class="params">($company_id,$hotel_id = NULL)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$post = input();</span><br><span class="line"></span><br><span class="line">$post[<span class="string">'company_id'</span>] = $company_id;</span><br><span class="line">$post[<span class="string">'hotel_id'</span>] = $hotel_id;</span><br><span class="line"></span><br><span class="line">$post[<span class="string">'my'</span>] = <span class="keyword">isset</span>($post[<span class="string">'my'</span>])??<span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">$goods = <span class="keyword">new</span> ShopGoodsM();</span><br><span class="line"></span><br><span class="line">$model = $goods-&gt;alias(<span class="string">'goods'</span>)</span><br><span class="line">-&gt;leftJoin(<span class="string">'shop_goods_category gcat'</span>,<span class="string">'goods.id=gcat.goods_id'</span>)</span><br><span class="line">-&gt;leftJoin(<span class="string">'shop_category cat'</span>,<span class="string">'gcat.category_id=cat.category_id'</span>)</span><br><span class="line">-&gt;where(<span class="string">'cat.deletetime'</span>,<span class="keyword">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($post[<span class="string">'my'</span>])&#123;</span><br><span class="line">$model-&gt;withSearch([<span class="string">'company_id'</span>,<span class="string">'hotel_id'</span>],$post);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$model-&gt;withSearch([<span class="string">'company_id'</span>],$post);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$model-&gt;group(<span class="string">'goods.id'</span>);</span><br><span class="line">$list = $model-&gt;field(<span class="string">"GROUP_CONCAT(DISTINCT(cat.name)) as category_name,goods.*"</span>)</span><br><span class="line">-&gt;select();</span><br><span class="line"><span class="comment">//æŸ¥è¯¢skuå±æ€§</span></span><br><span class="line"><span class="keyword">foreach</span> ($list <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">$list[$key][<span class="string">'sku'</span>] = $goods-&gt;skus()-&gt;where(<span class="string">'goods_id'</span>,$value[<span class="string">'id'</span>])-&gt;field(<span class="string">'sku,price,stock,score'</span>)-&gt;select();</span><br><span class="line">&#125;</span><br><span class="line">$total = $model-&gt;count();</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> Json([</span><br><span class="line"><span class="string">'code'</span>    =&gt; <span class="number">0</span>,</span><br><span class="line"><span class="string">'message'</span> =&gt; <span class="string">'success'</span>,</span><br><span class="line"><span class="string">'data'</span>  =&gt; $list,</span><br><span class="line"><span class="string">'total'</span>  =&gt; $total</span><br><span class="line">]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>é‚£ä¸Šè¾¹è¿™å—ä»£ç ç°åœ¨æœ‰Companyå’ŒHotelä¸¤ä¸ªæ¨¡å—è¦ä½¿ç”¨:<br><figure class="highlight php"><figcaption><span>company/index.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">company</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShopGoods</span></span>&#123;</span><br><span class="line"><span class="keyword">use</span> \<span class="title">common</span>\<span class="title">traits</span>\<span class="title">ShopGoods</span>;<span class="comment">//å¼•å…¥å…¬å…±çš„traitsæ–‡ä»¶</span></span><br><span class="line"><span class="comment">//å•†å“æ•°æ®</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getGoods</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">$this</span>-&gt;goodsList(helper::getCompanyIdInCompany());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>è¿™æ ·çš„è¯Companyå’ŒHotelæ¨¡å—ä¸‹åªæœ‰å†™è¿™ä¸¤è¡Œä»£ç å°±å¤Ÿäº†ã€‚</p><p>çœ‹åˆ°è¿™é‡Œå…¶å®å¾ˆå¤šäººä¼šæœ‰ç–‘é—®ï¼Œè¯´:è¿™ä¸å’Œæ™®é€šçš„ä»£ç å…¬ç”¨æ˜¯ä¸€ä¸ªç±»å‹å—ï¼Ÿ<br>ä¸ä¸ä¸ï¼ä»–ä»¬ä¸ä¸€æ ·ï¼Œä¾‹å¦‚å¾ˆå¤šæ¨¡å—ä¸‹çš„å‚æ•°æ˜¯æ— æ³•å…¬ç”¨çš„,companyä¸‹çš„company_idåœ¨hotelæ¨¡å—ä¸‹æ˜¯æ— æ³•è°ƒç”¨çš„,ä½†å¼•å…¥traitæ–¹æ³•ä¹‹åï¼Œä½ å°±å¯ä»¥åœ¨ä¸åŒçš„æ¨¡å—ä¸‹åšå‚æ•°å¤„ç†,traitæ–¹æ³•æ—¢å¯ä»¥é€šè¿‡é»˜è®¤å‚æ•°çš„å½¢å¼ä¼ é€’ä¹Ÿå¯ä»¥æ¥æ”¶postã€getç­‰æ–¹æ³•çš„ä¼ é€’ã€‚<br>å®‰å…¨æ–¹é¢ï¼štraitæ–¹æ³•ä¸å¯ç›´æ¥é€šè¿‡æ¥å£è®¿é—®ã€ç›¸æ¯”ç”¨å…¬ç”¨çš„commonæ–¹æ³•åšè®¿é—®å¤„ç†çœäº‹äº†å¾ˆå¤šï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jsä¸€æ¬¡æäº¤å´å‘èµ·å¤šæ¬¡è¯·æ±‚</title>
      <link href="/js%E4%B8%80%E6%AC%A1%E6%8F%90%E4%BA%A4%E5%8D%B4%E5%8F%91%E8%B5%B7%E5%A4%9A%E6%AC%A1%E8%AF%B7%E6%B1%82/"/>
      <url>/js%E4%B8%80%E6%AC%A1%E6%8F%90%E4%BA%A4%E5%8D%B4%E5%8F%91%E8%B5%B7%E5%A4%9A%E6%AC%A1%E8%AF%B7%E6%B1%82/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åšå‰ç«¯çš„å·¥ä½œæ¯”è¾ƒå¤š,ç»å¸¸ä¼šé‡åˆ°ä¸€äº›è‡ªå·±ä¸å¤ªæ˜ç™½çš„é—®é¢˜ï¼Œéå¸¸çš„æ‡µé€¼ã€‚<br>æ¯”å¦‚åšä¸€ä¸ªç®€å•çš„ajaxå¼‚æ­¥æäº¤ä¼šå‡ºç°ä¸¤æ¬¡è¯·æ±‚çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯æœ€è¿‘é‡è§æ¯”è¾ƒå¥‡æ€ªçš„é—®é¢˜ã€‚</p><p>ç»è¿‡æ’æŸ¥ä¹‹åå‘ç°ä¸¤æ¬¡å‡ºç°ä¸¤æ¬¡è¯·æ±‚çš„åŸå› å¯èƒ½æ˜¯ï¼š<br><blockquote><p>1.å¼•å…¥äº†ä¸¤ä¸ªåŒæ ·çš„js,æ¯”å¦‚å¼•å…¥äº†ä¸¤ä¸ªåŒæ ·çš„jqueryæ’ä»¶</p></blockquote><br><a id="more"></a><br><blockquote><p>2.é¡µé¢å­˜åœ¨formè¡¨å•ï¼Œç‚¹å‡»æäº¤æŒ‰é’®ä¹‹ååˆæ‰§è¡Œäº†form.submit(),è¿™ä¸ªformæœ¬èº«å°±ä¼šæäº¤ä¸€æ¬¡ã€‚</p></blockquote><br><blockquote><p>3.è·¨åŸŸè¯·æ±‚ï¼Œè¿™ä¸ªé—®é¢˜å°±æ¯”è¾ƒæ·±å…¥ä¸€ç‚¹äº†ï¼Œjsè·¨åŸŸçš„æ—¶å€™æœ¬èº«ä¼šå‘é€ä¸¤æ¬¡è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡æ˜¯é¢„æŸ¥è¯·æ±‚(option)ï¼Œæ˜¯ä¸ºäº†æŸ¥è¯¢æ˜¯å¦æ”¯æŒè·¨åŸŸï¼Œç¬¬äºŒæ¬¡æ‰æ˜¯çœŸæ­£çš„æ•°æ®è¯·æ±‚ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆåç«¯è¦æœ‰å…è®¸è·¨åŸŸè¯·æ±‚çš„å¤„ç†ï¼Œå‰ç«¯çš„headerè¦åŠ å…¥application/x-www-form-urlencoded, multipart/form-data æˆ– text/plainä¸­çš„ä¸€ç§ï¼Œå°±å¯ä»¥è§£å†³äº†ã€‚</p></blockquote><br><figure class="highlight php"><figcaption><span>åç«¯è·¨åŸŸå¤„ç†</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">'Access-Control-Allow-Origin: *'</span>);</span><br><span class="line">header(<span class="string">"Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept"</span>);</span><br><span class="line">header(<span class="string">'Access-Control-Allow-Methods: GET, POST, PUT'</span>);</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°ç¨‹åºæœåŠ¡å•†æ”¯ä»˜</title>
      <link href="/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%9C%8D%E5%8A%A1%E5%95%86%E6%94%AF%E4%BB%98/"/>
      <url>/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%9C%8D%E5%8A%A1%E5%95%86%E6%94%AF%E4%BB%98/</url>
      
        <content type="html"><![CDATA[<p>å»ºè®®æŒ‰ç…§æ¥å£æ–‡æ¡£è¿›è¡Œå¼€å‘,ä¸è¦ç›´æ¥ä½¿ç”¨sdk<br>ä¸‹é¢è´´ä¸Šä»£ç ä¸ºå¤§å®¶ä¸€ä¸€ä»‹ç»æ–‡æ¡£å’ŒçœŸå®æƒ…å†µçš„å·®è·:<br><a id="more"></a><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'./common/payConfig.php'</span>;</span><br><span class="line">$key = $payConfig[<span class="string">'key'</span>];</span><br><span class="line">$orderData = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">"appid"</span>            =&gt;   $payConfig[<span class="string">'appid'</span>],</span><br><span class="line"><span class="string">'mch_id'</span>           =&gt;   $payConfig[<span class="string">'mchid'</span>],</span><br><span class="line"><span class="string">'sub_appid'</span>        =&gt;   $payConfig[<span class="string">'sub_appid'</span>],</span><br><span class="line"><span class="string">'sub_mch_id'</span>       =&gt;   $mchid,</span><br><span class="line"><span class="string">'body'</span>             =&gt;   $body,</span><br><span class="line"><span class="string">'attach'</span>           =&gt;   $attach,</span><br><span class="line"><span class="string">'out_trade_no'</span>     =&gt;   $order_id,</span><br><span class="line"><span class="string">'total_fee'</span>        =&gt;   $total_price,</span><br><span class="line"><span class="string">'spbill_create_ip'</span> =&gt;   $_SERVER[<span class="string">'REMOTE_ADDR'</span>],</span><br><span class="line"><span class="string">'notify_url'</span>       =&gt;   <span class="string">'daichongweb.com'</span>,</span><br><span class="line"><span class="string">'trade_type'</span>       =&gt;   <span class="string">'JSAPI'</span>,</span><br><span class="line"><span class="comment">// 'openid'        =&gt;   $UnionID, è¿™ä¸ªæ˜¯ä¸éœ€è¦çš„</span></span><br><span class="line"><span class="string">'goods_tag'</span>        =&gt;   <span class="string">'daichong'</span>,</span><br><span class="line"><span class="string">'nonce_str'</span>        =&gt;   <span class="keyword">$this</span>-&gt;getNonceStr(),</span><br><span class="line"><span class="string">'sub_openid'</span>       =&gt;   $mini_openid</span><br><span class="line">);</span><br><span class="line">ksort($orderData);</span><br><span class="line">reset($orderData);</span><br><span class="line">$buff = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">foreach</span> ($orderData <span class="keyword">as</span> $k =&gt; $v)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">if</span>($k != <span class="string">"sign"</span> &amp;&amp; $v != <span class="string">""</span> &amp;&amp; !is_array($v))&#123;</span><br><span class="line">      $buff .= ($k . <span class="string">"="</span> . $v . <span class="string">"&amp;"</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">$buff = trim($buff, <span class="string">"&amp;"</span>);</span><br><span class="line">$buff = $buff.<span class="string">'&amp;key='</span>.$key;</span><br><span class="line">$signA = strtoupper(MD5($buff));</span><br><span class="line">$orderData[<span class="string">'sign'</span>] = $signA;</span><br><span class="line"></span><br><span class="line">$xml = <span class="keyword">$this</span>-&gt;arrayToXml($orderData);</span><br><span class="line"></span><br><span class="line">$url = <span class="string">"https://api.mch.weixin.qq.com/pay/unifiedorder"</span>;</span><br><span class="line">        </span><br><span class="line">$result = <span class="keyword">$this</span>-&gt;https_post($url,$xml);</span><br><span class="line">$payArray = (<span class="keyword">array</span>)simplexml_load_string($result, <span class="string">'SimpleXMLElement'</span>, LIBXML_NOCDATA);</span><br></pre></td></tr></table></figure><br>åœ¨ä»£ç ä¸Šçš„å·®è·å…¶å®åªæœ‰ä¸€ä¸ªopenid,ä½†æ˜¯ä»–è¿˜æ˜¯ä¼šæŠ¥é”™appidå’Œsub_mch_idä¸åŒ¹é…,è§£å†³è¿™ä¸ªé—®é¢˜çš„å‰æå°ç¨‹åºå’Œå…¬ä¼—å·çš„ä¸»ä½“å¿…é¡»ä¸€è‡´,ä¹Ÿå°±æ˜¯å°ç¨‹åºå’Œå¾®ä¿¡å…¬ä¼—å·å¿…é¡»åœ¨åŒä¸€ä¸ªæœåŠ¡å•†ä¸Šç»‘å®šã€‚ç»‘å®šæ–¹å¼æ˜¯åœ¨æœåŠ¡å•†æˆ·é‡Œæ‰¾åˆ°â€™æœåŠ¡å•†åŠŸèƒ½â€˜-&gt;â€™ç‰¹çº¦å•†æˆ·ç®¡ç†â€˜æ‰¾åˆ°å¯¹åº”å•†æˆ·ç‚¹å‡»é…ç½®<br><blockquote><p>ç¬¬ä¸€æ­¥ï¼š</p></blockquote><br><img src="/å°ç¨‹åºæœåŠ¡å•†æ”¯ä»˜/img/2.png" title="å°ç¨‹åºæœåŠ¡å•†æ”¯ä»˜ é…ç½®"><br><blockquote><p>ç¬¬äºŒæ­¥ï¼š</p></blockquote><br><img src="/å°ç¨‹åºæœåŠ¡å•†æ”¯ä»˜/img/1.png" title="å°ç¨‹åºæœåŠ¡å•†æ”¯ä»˜ é…ç½®"><br>æ·»åŠ å¥½ä¹‹åå°±å¯ä»¥æµ‹è¯•æ”¯ä»˜äº†ï¼ŒæŠŠæ”¯ä»˜å‚æ•°è¿”å›ç»™å‰ç«¯ï¼Œå•Šå°±å®Œäº‹äº†!</p>]]></content>
      
      
      
        <tags>
            
            <tag> å°ç¨‹åºæ”¯ä»˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è°·æ­Œæµè§ˆå™¨Flashæ²¡æœ‰æ·»åŠ æŒ‰é”®</title>
      <link href="/%E8%B0%B7%E6%AD%8C%E6%B5%8F%E8%A7%88%E5%99%A8Flash%E6%B2%A1%E6%9C%89%E6%B7%BB%E5%8A%A0%E6%8C%89%E9%94%AE/"/>
      <url>/%E8%B0%B7%E6%AD%8C%E6%B5%8F%E8%A7%88%E5%99%A8Flash%E6%B2%A1%E6%9C%89%E6%B7%BB%E5%8A%A0%E6%8C%89%E9%94%AE/</url>
      
        <content type="html"><![CDATA[<p>å…³äºè°·æ­Œæµè§ˆå™¨ä¸èƒ½ä½¿ç”¨Flashçš„é—®é¢˜å¤§å®¶è‚¯å®šé‡åˆ°è¿‡ï¼Œåªè¦åœ¨<a>è®¾ç½®-ã€‹é«˜çº§-ã€‹å†…å®¹ç®¡ç†-ã€‹Flashé‡Œæ·»åŠ ç½‘ç«™å°±å¯ä»¥äº†</a><br>ä»Šå¤©æˆ‘æ›´æ–°äº†ä¸€ä¸‹æµè§ˆå™¨ï¼Œå‡çº§åˆ°äº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå‘ç°Flashåˆä½¿ç”¨ä¸äº†ã€‚æŒ‰ç…§ä»¥å¾€çš„æµç¨‹å»æ·»åŠ å±…ç„¶å‘ç°æ²¡æœ‰å±…ç„¶æ²¡æœ‰æ·»åŠ æŒ‰é’®<br><a id="more"></a><br>ç„¶åå°±æ˜¯é•¿è¾¾1ä¸ªå¤šå°æ—¶çš„ç™¾åº¦ï¼Œè¯•äº†æ— æ•°çš„æ–¹æ³•éƒ½æ²¡æœ‰è§£å†³ï¼Œæœ€åé™ä¸‹æ¥æ€è€ƒä¹‹åæ‰æœ‰äº†å¤´ç»ªã€‚<br>é‚£ä¹ˆæœ€ç»ˆçš„è§£å†³æ–¹æ³•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>é¦–å…ˆï¼š<br><figure class="highlight plain"><figcaption><span>åœ¨æµè§ˆå™¨è¾“å…¥</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome://flags/#run-all-flash-in-allow-mode</span><br></pre></td></tr></table></figure><br>æœç´¢ï¼š<br><figure class="highlight plain"><figcaption><span>æœç´¢</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Enable Ephemeral Flash Permissions</span><br></pre></td></tr></table></figure><br>ä¿®æ”¹çŠ¶æ€ä¸ºDisabled<br>ç„¶åä¸‹é¢ä¼šå¼¹å‡ºä¸€ä¸ªæ¡†ï¼Œç‚¹å‡»ä¸€ä¸‹æŒ‰é’®å°±å¯ä»¥äº†ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> æµè§ˆå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpæ ¹æ®äºŒä½æ•°æ®ä¸­çš„æŸä¸ªé”®å€¼æ’åº</title>
      <link href="/php%E6%A0%B9%E6%8D%AE%E4%BA%8C%E4%BD%8D%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%E6%9F%90%E4%B8%AA%E9%94%AE%E5%80%BC%E6%8E%92%E5%BA%8F/"/>
      <url>/php%E6%A0%B9%E6%8D%AE%E4%BA%8C%E4%BD%8D%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9A%84%E6%9F%90%E4%B8%AA%E9%94%AE%E5%80%BC%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<p>ä¸‹é¢å…ˆä¸ºå¤§å®¶ä»‹ç»ä¸¤ä¸ªphpå‡½æ•°ï¼š<br><a>array_column()</a>:è¿”å›è¾“å…¥æ•°ç»„ä¸­æŸä¸ªå•ä¸€åˆ—çš„å€¼ã€‚<br><blockquote class="pullquote"><p>å°ä¾‹å­ï¼š</p></blockquote><br><figure class="highlight php"><figcaption><span>array_columnçš„ç”¨æ³•</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$a = <span class="keyword">array</span>(</span><br><span class="line">  <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'id'</span> =&gt; <span class="number">5698</span>,</span><br><span class="line">    <span class="string">'first_name'</span> =&gt; <span class="string">'daichong'</span>,</span><br><span class="line">    <span class="string">'last_name'</span> =&gt; <span class="string">'css'</span>,</span><br><span class="line">  ),</span><br><span class="line">  <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'id'</span> =&gt; <span class="number">4767</span>,</span><br><span class="line">    <span class="string">'first_name'</span> =&gt; <span class="string">'dc'</span>,</span><br><span class="line">    <span class="string">'last_name'</span> =&gt; <span class="string">'js'</span>,</span><br><span class="line">  ),</span><br><span class="line">  <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'id'</span> =&gt; <span class="number">3809</span>,</span><br><span class="line">    <span class="string">'first_name'</span> =&gt; <span class="string">'DC'</span>,</span><br><span class="line">    <span class="string">'last_name'</span> =&gt; <span class="string">'web'</span>,</span><br><span class="line">  )</span><br><span class="line">);</span><br><span class="line">$lastNames = array_column($a,<span class="string">'first_name'</span>)</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><figure class="highlight php"><figcaption><span>æ‰“å°ç»“æœ</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">  [<span class="number">0</span>] =&gt; daichong</span><br><span class="line">  [<span class="number">1</span>] =&gt; dc</span><br><span class="line">  [<span class="number">2</span>] =&gt; DC</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><a>array_multisort()</a>:è¿”å›æŒ‡å®šæ’åºåçš„æ•°ç»„ã€‚<br>å‡½æ•°è¿”å›æ’åºæ•°ç»„ã€‚æ‚¨å¯ä»¥è¾“å…¥ä¸€ä¸ªæˆ–å¤šä¸ªæ•°ç»„ã€‚å‡½æ•°å…ˆå¯¹ç¬¬ä¸€ä¸ªæ•°ç»„è¿›è¡Œæ’åºï¼Œæ¥ç€æ˜¯å…¶ä»–æ•°ç»„ï¼Œå¦‚æœä¸¤ä¸ªæˆ–å¤šä¸ªå€¼ç›¸åŒï¼Œå®ƒå°†å¯¹ä¸‹ä¸€ä¸ªæ•°ç»„è¿›è¡Œæ’åºã€‚<br>æ³¨é‡Šï¼šå­—ç¬¦ä¸²é”®åå°†è¢«ä¿ç•™ï¼Œä½†æ˜¯æ•°å­—é”®åå°†è¢«é‡æ–°ç´¢å¼•ï¼Œä» 0 å¼€å§‹ï¼Œå¹¶ä»¥ 1 é€’å¢ã€‚<br><br>æ³¨é‡Šï¼šæ‚¨å¯ä»¥åœ¨æ¯ä¸ªæ•°ç»„åè®¾ç½®æ’åºé¡ºåºå’Œæ’åºç±»å‹å‚æ•°ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œæ¯ä¸ªæ•°ç»„å‚æ•°ä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚<br><br><blockquote class="pullquote"><p>å®è·µï¼š</p></blockquote><figure class="highlight php"><figcaption><span>ä»£ç </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$arr=<span class="keyword">array</span>(</span><br><span class="line">      <span class="number">0</span>=&gt;<span class="keyword">array</span>(</span><br><span class="line">         <span class="string">'run_date'</span>=&gt;<span class="number">3</span>,</span><br><span class="line">          <span class="string">'count'</span>=&gt;<span class="string">'5'</span></span><br><span class="line">      ),</span><br><span class="line">      <span class="number">1</span>=&gt;<span class="keyword">array</span>(</span><br><span class="line">          <span class="string">'run_date'</span>=&gt;<span class="number">2</span>,</span><br><span class="line">          <span class="string">'count'</span>=&gt;<span class="string">'10'</span></span><br><span class="line">     ),</span><br><span class="line">     <span class="number">2</span>=&gt;<span class="keyword">array</span>(</span><br><span class="line">         <span class="string">'run_date'</span>=&gt;<span class="number">1</span>,</span><br><span class="line">         <span class="string">'count'</span>=&gt;<span class="string">'10'</span></span><br><span class="line">     )</span><br><span class="line"> );</span><br><span class="line">$date = array_column($arr, <span class="string">'run_date'</span>);</span><br><span class="line">array_multisort($date,SORT_ASC,$arr);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">print_r($arr);</span><br></pre></td></tr></table></figure><blockquote class="pullquote"><p>ç»“æœï¼š</p></blockquote><figure class="highlight php"><figcaption><span>æ‰“å°ç»“æœ</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [run_date] =&gt; <span class="number">1</span></span><br><span class="line">            [count] =&gt; <span class="number">10</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">1</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [run_date] =&gt; <span class="number">2</span></span><br><span class="line">            [count] =&gt; <span class="number">10</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">2</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [run_date] =&gt; <span class="number">3</span></span><br><span class="line">            [count] =&gt; <span class="number">5</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸æ˜¯æ ¹æ®æŒ‡å®šçš„é”®å€¼è¿›è¡Œæ’åºäº†å‘¢ï¼Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webç«¯å­˜å‚¨æ•°æ®(cookie,storage)é€‰æ‹©å’Œä½¿ç”¨</title>
      <link href="/web%E7%AB%AF%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE-cookie-storage-%E9%80%89%E6%8B%A9%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
      <url>/web%E7%AB%AF%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE-cookie-storage-%E9%80%89%E6%8B%A9%E5%92%8C%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>å…³äºå‰ç«¯å­˜å‚¨çš„æ–¹æ³•ç”¨å¾ˆå¤šï¼Œæœ€ä¸ºå¸¸è§çš„æ˜¯cookieå’ŒlocationStorageã€‚</p><p>å…¶ä¸­cookieçš„é™åˆ¶æ¯”è¾ƒå¤§ï¼Œæ¯”å¦‚å¿…é¡»éœ€è¦cookie.jsã€æµè§ˆå™¨å¯¹cookieçš„æ•°é‡é™åˆ¶(ä¹‹å‰çš„æµè§ˆå™¨æ¯ä¸ªåŸŸåé™åˆ¶cookieä¹‹æ¶èƒ½å­˜å‚¨50ä¸ª)ï¼Œæ•°æ®é•¿åº¦çš„é™åˆ¶(å¤§éƒ¨åˆ†æµè§ˆå™¨æ˜¯4085å­—èŠ‚å·¦å³,ä½†å®é™…æ›´å°)ã€‚</p><p>locationstorageèƒ½å­˜å‚¨4-5Må¤§å°çš„æ•°æ®ï¼Œæœ‰æ•ˆæœŸæœªæ°¸ä¹…ã€‚</p><p>application cache æ˜¯ç¦»çº¿ç¼“å­˜ï¼Œå­˜å‚¨å¤§å°ä¹Ÿæ˜¯5Må·¦å³,ä»–ä¸å…¶ä»–ä¸¤ç§æ–¹å¼çš„ä¸åŒåœ¨ä¸æµè§ˆå™¨ç¼“å­˜æ˜¯å¯¹å•ä¸ªæ–‡ä»¶ï¼Œè€Œapplocation cacheæ˜¯å¯¹æ•´ä¸ªåº”ç”¨ï¼Œå½“æ•´ä¸ªåº”ç”¨éƒ½ç¼“å­˜ä¸‹æ¥çš„æ—¶å€™å¯ä»¥è¾¾åˆ°æ— ç½‘ç»œè¿æ¥ã€‚</p><p>ä»Šå¤©æˆ‘è¦å†™çš„æ˜¯locationstorageçš„sessionStorageï¼Œä»–ä»¬çš„ç”¨æ³•å®Œå…¨ç›¸åŒï¼Œå¾ˆç®€å•ï¼Œä½†æ˜¯çœŸçš„å¾ˆå®ç”¨ã€‚ä»Šå¤©ä½¿ç”¨ä¹‹åæˆ‘è§‰å¾—è¿™ä¸ªsessionStorageçœŸçš„æ˜¯å¤ªæ–¹ä¾¿äº†ã€‚<br><a id="more"></a><br><blockquote><p>æµ‹è¯•cookieå­˜å‚¨</p></blockquote><br>æœ€ç»ˆå‘ç°1837çš„é•¿åº¦å­˜ä¸è¿›å»ã€‚<br><blockquote><p>sessionStorage çš„ä½¿ç”¨</p></blockquote><br><figure class="highlight js"><figcaption><span>sessionStorage</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å­˜å‚¨</span></span><br><span class="line">sessionStorage.setItem(<span class="string">'newList'</span>,str)</span><br><span class="line"><span class="comment">//è·å–</span></span><br><span class="line">sessionStorage.getItem(<span class="string">'newList'</span>)</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> jquery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå¾ªç¯å¤„ç†ä¸‡æ¡æ•°æ®å¦‚ä½•ä¼˜åŒ–ï¼Ÿ</title>
      <link href="/php%E5%BE%AA%E7%8E%AF%E5%A4%84%E7%90%86%E4%B8%87%E6%9D%A1%E6%95%B0%E6%8D%AE%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96%EF%BC%9F/"/>
      <url>/php%E5%BE%AA%E7%8E%AF%E5%A4%84%E7%90%86%E4%B8%87%E6%9D%A1%E6%95%B0%E6%8D%AE%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æ¥å†™ä¸€ç¯‡å¦‚ä½•ä¼˜åŒ–åœ¨å¾ªç¯é‡Œçš„sqlã€‚ç›¸ä¿¡å¤§å®¶éƒ½ä¼šé‡åˆ°åœ¨foreaché‡Œå¾ªç¯æ“ä½œæ•°æ®åº“ï¼Œä¸Šå­¦çš„æ—¶å€™ä¸€å¬åˆ°å¾ªç¯æŸ¥è¡¨è¿™ç±»çš„è¯ï¼Œå“‡ï¼æ„Ÿè§‰å¾ˆé«˜ç«¯ï¼Œæ®Šä¸çŸ¥è¿™æ ·çš„æ“ä½œå¯¹æ•°æ®åº“çš„å‹åŠ›æ˜¯æ— é™å¤§çš„ã€‚åƒä¸€ä¸ªä¸‰çº§çš„åˆ†ç±»æ•°æ®æ“ä½œï¼Œå¾ˆå¤šäººä¼šé€‰æ‹©å¾ªç¯æŸ¥è¡¨ï¼Œæ¯•ç«Ÿè¿™æ ·çš„å†™æ³•æ˜¯æœ€æ–¹ä¾¿ã€æœ€ç®€å•çš„ã€‚å‰æœŸæ•°æ®é‡å°çš„æ—¶å€™æ˜¯æ²¡æœ‰å¾ˆæ˜æ˜¾çš„é—®é¢˜ï¼Œåˆ°äº†ä¸€å®šç¨‹åº¦ï¼Œä½ ä¼šå‘ç°é¡µé¢åŠ è½½é€Ÿåº¦è¶Šæ¥è¶Šæ…¢ï¼Œæ•°æ®åº“çš„å‹åŠ›è¶Šæ¥è¶Šå¤§ã€‚è¿™ä¸ªæ—¶å€™ä½ å¿…é¡»è¦é€‰æ‹©ä¿®æ”¹ä½ çš„ç¨‹åºäº†ï¼</p><p>ä½†æ˜¯è¿™ç¯‡æ–‡ç« ä¸æ˜¯æ¥ä»‹ç»å¦‚ä½•ä¼˜åŒ–å¾ªç¯æŸ¥è¯¢çš„ï¼Œæ˜¯ä»‹ç»å¦‚ä½•æ¥ä¼˜åŒ–å¾ªç¯ä¿®æ”¹è¡¨æ•°æ®çš„ã€‚<br><a id="more"></a><br>ä¸‹é¢ä»‹ç»ä¸€ä¸‹æˆ‘æ­£åœ¨åšçš„ä¸€äº›ä¸šåŠ¡ï¼š<br><figure class="highlight php"><figcaption><span>æ•°ç»„</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [did] =&gt; <span class="number">1446175</span></span><br><span class="line">            [userid] =&gt; <span class="number">449310</span></span><br><span class="line">            [danhao] =&gt; W1808100219</span><br><span class="line">            [isno] =&gt; <span class="number">2</span></span><br><span class="line">            [green_state] =&gt; R</span><br><span class="line">            [id] =&gt; <span class="number">19</span></span><br><span class="line">            [time] =&gt; <span class="number">2018</span><span class="number">-08</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">06</span>:<span class="number">30</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">1</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [did] =&gt; <span class="number">1446174</span></span><br><span class="line">            [userid] =&gt; <span class="number">456791</span></span><br><span class="line">            [danhao] =&gt; W1808100218</span><br><span class="line">            [isno] =&gt; <span class="number">2</span></span><br><span class="line">            [green_state] =&gt; R</span><br><span class="line">            [id] =&gt; <span class="number">34</span></span><br><span class="line">            [time] =&gt; <span class="number">2018</span><span class="number">-08</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">06</span>:<span class="number">30</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">2</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [did] =&gt; <span class="number">1446172</span></span><br><span class="line">            [userid] =&gt; <span class="number">113637</span></span><br><span class="line">            [danhao] =&gt; W1808100217</span><br><span class="line">            [isno] =&gt; <span class="number">2</span></span><br><span class="line">            [green_state] =&gt; R</span><br><span class="line">            [id] =&gt; <span class="number">38</span></span><br><span class="line">            [time] =&gt; <span class="number">2018</span><span class="number">-08</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">06</span>:<span class="number">30</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">3</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [did] =&gt; <span class="number">1446171</span></span><br><span class="line">            [userid] =&gt; <span class="number">10884</span></span><br><span class="line">            [danhao] =&gt; W1808100216</span><br><span class="line">            [isno] =&gt; <span class="number">2</span></span><br><span class="line">            [green_state] =&gt; R</span><br><span class="line">            [id] =&gt; <span class="number">5</span></span><br><span class="line">            [time] =&gt; <span class="number">2018</span><span class="number">-08</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">06</span>:<span class="number">30</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">4</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [did] =&gt; <span class="number">1446169</span></span><br><span class="line">            [userid] =&gt; <span class="number">79165</span></span><br><span class="line">            [danhao] =&gt; W1808100214</span><br><span class="line">            [isno] =&gt; <span class="number">2</span></span><br><span class="line">            [green_state] =&gt; R</span><br><span class="line">            [id] =&gt; <span class="number">11</span></span><br><span class="line">            [time] =&gt; <span class="number">2018</span><span class="number">-08</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">06</span>:<span class="number">30</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">code snippet</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªåŠŸèƒ½çš„è¦æ±‚æ˜¯åŒæ­¥è®¢å•ï¼Œæ•°æ®å°±åƒä¸Šè¾¹å±•ç¤ºçš„ä¸€æ · green_state çš„å€¼æ˜¯ä¸å›ºå®šçš„ï¼Œå¯èƒ½æ˜¯Rä¹Ÿå¯èƒ½æ˜¯X,è¿™ä¸ªä»£è¡¨çš„æ˜¯è®¢å•çš„çŠ¶æ€ã€‚<br>æˆ‘ç°åœ¨è¦åšçš„æ˜¯æ‹¿è¿™ä¸ªè®¢å•çŠ¶æ€å»æŠŠä»–ç›¸åº”çš„å­—æ®µå€¼æ”¹æˆè¿™ä¸ªçŠ¶æ€ã€‚</p><blockquote><p>åŸå§‹å†™æ³•:å¾ªç¯ä¿®æ”¹</p></blockquote><figure class="highlight php"><figcaption><span>é€»è¾‘</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>($order <span class="keyword">as</span> $k=&gt;$v)&#123;</span><br><span class="line">    Db::query(<span class="string">"update order set green_state=$v['green_state'] set did=$v['did']"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„å†™æ³•æœ‰å¤šå°‘æ¡æ•°æ®å°±ä¼šè¯·æ±‚æ•°æ®åº“å¤šå°‘æ¬¡ï¼Œæ— ç–‘æ˜¯æœ€æ¶ˆè€—æ€§èƒ½çš„å†™æ³•ã€‚<br><blockquote><p>ä¼˜åŒ–å†™æ³•ï¼šé“¾æ¥sql</p></blockquote><br><figure class="highlight php"><figcaption><span>é€»è¾‘ä»£ç </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é¢„å®šsql s</span></span><br><span class="line">$Rsql = <span class="string">''</span>;</span><br><span class="line">$RsetIds = <span class="string">''</span>;</span><br><span class="line"><span class="comment">//e</span></span><br><span class="line"><span class="comment">//å–æ¶ˆsql s</span></span><br><span class="line">$Xsql = <span class="string">''</span>;</span><br><span class="line">$XsetIds = <span class="string">''</span>;</span><br><span class="line"><span class="comment">//e</span></span><br><span class="line"><span class="comment">//I</span></span><br><span class="line">$Isql = <span class="string">''</span>;</span><br><span class="line">$IsetIds = <span class="string">''</span>;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//O</span></span><br><span class="line">$Osql = <span class="string">''</span>;</span><br><span class="line">$OsetIds = <span class="string">''</span>;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//N</span></span><br><span class="line">$Nsql = <span class="string">''</span>;</span><br><span class="line">$NsetIds = <span class="string">''</span>;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//D</span></span><br><span class="line">$Dsql = <span class="string">''</span>;</span><br><span class="line">$DsetIds = <span class="string">''</span>;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">foreach</span> ($order_data <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">$order_data[$k][<span class="string">'time'</span>] = date(<span class="string">'Y-m-d H:i:s'</span>);</span><br><span class="line">$data = json_decode(<span class="keyword">$this</span>-&gt;order_info($pms[<span class="string">'url'</span>],$pms[<span class="string">'jiudian'</span>],$pms[<span class="string">'hotelgroupId'</span>],$v[<span class="string">'danhao'</span>]),<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">if</span>($data[<span class="string">'resultCode'</span>]==<span class="number">0</span>)&#123;</span><br><span class="line">        $order_data[$k][<span class="string">'green_state'</span>] = $data[<span class="string">'guest'</span>][<span class="string">'sta'</span>];</span><br><span class="line">&#125;</span><br><span class="line">       <span class="comment">//ç»„åˆsql Rç±»å‹ é¢„å®š</span></span><br><span class="line"><span class="keyword">if</span>($order_data[$k][<span class="string">'green_state'</span>]==<span class="string">'R'</span>)&#123;</span><br><span class="line">$Rsql = <span class="string">"set green_state='R'"</span>;</span><br><span class="line">$RsetIds .= $v[<span class="string">'did'</span>].<span class="string">','</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç»„åˆsql Xç±»å‹ å–æ¶ˆ</span></span><br><span class="line"><span class="keyword">if</span>($order_data[$k][<span class="string">'green_state'</span>]==<span class="string">'X'</span>)&#123;</span><br><span class="line">$Xsql = <span class="string">"set green_state='X'"</span>;</span><br><span class="line">$XsetIds .= $v[<span class="string">'did'</span>].<span class="string">','</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç»„åˆsql Iç±»å‹ åœ¨ä½</span></span><br><span class="line"><span class="keyword">if</span>($order_data[$k][<span class="string">'green_state'</span>]==<span class="string">'I'</span>)&#123;</span><br><span class="line">$Isql = <span class="string">"set green_state='I'"</span>;</span><br><span class="line">$IsetIds .= $v[<span class="string">'did'</span>].<span class="string">','</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç»„åˆsql Oç±»å‹ é€€æˆ¿</span></span><br><span class="line"><span class="keyword">if</span>($order_data[$k][<span class="string">'green_state'</span>]==<span class="string">'O'</span>)&#123;</span><br><span class="line">$Osql = <span class="string">"set green_state='O'"</span>;</span><br><span class="line">$OsetIds .= $v[<span class="string">'did'</span>].<span class="string">','</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç»„åˆsql Nç±»å‹ åº”åˆ°æœªåˆ°</span></span><br><span class="line"><span class="keyword">if</span>($order_data[$k][<span class="string">'green_state'</span>]==<span class="string">'N'</span>)&#123;</span><br><span class="line">$Nsql = <span class="string">"set green_state='N'"</span>;</span><br><span class="line">$NsetIds .= $v[<span class="string">'did'</span>].<span class="string">','</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç»„åˆsql Dç±»å‹ åˆ é™¤</span></span><br><span class="line"><span class="keyword">if</span>($order_data[$k][<span class="string">'green_state'</span>]==<span class="string">'D'</span>)&#123;</span><br><span class="line">$Dsql = <span class="string">"set green_state='D'"</span>;</span><br><span class="line">$DsetIds .= $v[<span class="string">'did'</span>].<span class="string">','</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$RsetIds = trim($RsetIds,<span class="string">','</span>);</span><br><span class="line">$XsetIds = trim($XsetIds,<span class="string">','</span>);</span><br><span class="line">$IsetIds = trim($IsetIds,<span class="string">','</span>);</span><br><span class="line">$OsetIds = trim($OsetIds,<span class="string">','</span>);</span><br><span class="line">$NsetIds = trim($NsetIds,<span class="string">','</span>);</span><br><span class="line">$DsetIds = trim($DsetIds,<span class="string">','</span>);</span><br><span class="line">$sql = <span class="string">"update order $Rsql where did in($RsetIds)"</span>;</span><br></pre></td></tr></table></figure><br>ä»¥ä¸Šå°±æ˜¯æˆ‘æ ¹æ®éœ€æ±‚è°ƒæ•´çš„ä»£ç ï¼Œé€šè¿‡ä¸åŒè®¢å•ç±»å‹ç»„æˆä¸åŒçš„sqlï¼Œæœ€ç»ˆå®ç°6æ¡sqlå®Œæˆ6ä¸ªç±»å‹çš„ä¿®æ”¹ï¼Œå¦‚æœæ˜¯10wæ¡æ•°æ®ï¼Œé‚£ä¹ˆè¯·æ±‚æ•°æ®åº“çš„æ¬¡æ•°æ˜¯6æ¬¡ï¼Œç›¸æ¯”ä¹‹å‰çš„æ¬¡æ•°é™ä½äº†9åƒå¤šæ¬¡ï¼è¾¾åˆ°äº†ä¼˜åŒ–çš„æ•ˆæœï¼Œå½“ç„¶è¿™ä¸ªä»£ç è¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚<br>ä»¥ä¸Šä»£ç åªæ˜¯ä¸ºå¤§å®¶æä¾›æ€è·¯ï¼Œå…·ä½“ä¸šåŠ¡é€»è¾‘è¿˜è¦æ ¹æ®å®é™…æƒ…å†µè€Œå®šï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpåšä¸€ä¸ªç®€å•çš„æ—¥å¿—åŠŸèƒ½</title>
      <link href="/php%E5%81%9A%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%97%A5%E5%BF%97%E5%8A%9F%E8%83%BD/"/>
      <url>/php%E5%81%9A%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%97%A5%E5%BF%97%E5%8A%9F%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©ä¸€ç›´åœ¨å’Œåˆ«çš„å…¬å¸å¯¹æ¥æ¥å£ï¼Œä¹‹å‰çš„å¯¹æ¥éƒ½æ²¡æœ‰åšæ¥å¾€æ—¥å¿—ï¼Œè¿™æ ·çš„è¯åŠŸèƒ½å‡ºäº†é—®é¢˜è¦é’ˆå¯¹æ€§çš„æ‰¾åˆ°é—®é¢˜çš„åŸå› æ¯”è¾ƒéº»çƒ¦ï¼Œé€¼ä¸å¾—å·²åªèƒ½åšä¸ªæ—¥å¿—è®°å½•ä¸€ä¸‹ã€‚è€Œä¸”ç¨‹åºè¿˜æ²¡æœ‰ä½¿ç”¨ä»»ä½•æ¡†æ¶ï¼Œåˆä¸æƒ³ç ”ç©¶åˆ«äººçš„ä»£ç ï¼Œæ²¡åŠæ³•åªèƒ½è‡ªå·±ç®€å•çš„åšä¸€ä¸ªå†™å…¥æ—¥å¿—çš„åŠŸèƒ½ã€‚<br><a id="more"></a><br><blockquote><p>å®ç°é€»è¾‘:</p></blockquote><br><figure class="highlight php"><figcaption><span>å†™å…¥æ–‡ä»¶</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†™å…¥æ—¥å¿—</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@access</span> public</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> must $path å†™å…¥æ—¥å¿—çš„åœ°å€(./log/)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> must $data å†™å…¥å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> optional $fileName æ–‡ä»¶åç§°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Number 1 æˆåŠŸ 0 å¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">write_log</span><span class="params">($path,$data,$fileName=<span class="string">'error'</span>)</span></span>&#123;</span><br><span class="line">        $file_path = $path.date(<span class="string">'Y-m-d'</span>);</span><br><span class="line"><span class="comment">//æ–‡ä»¶å¤¹ä¸å­˜åœ¨åˆ›å»ºæ–‡ä»¶å¤¹</span></span><br><span class="line">        <span class="keyword">if</span>(!file_exists($file_path))&#123;</span><br><span class="line">            mkdir($file_path,<span class="number">0777</span>,<span class="keyword">true</span>);  </span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//æ–‡ä»¶å®Œæ•´è·¯å¾„</span></span><br><span class="line">        $file = $path.date(<span class="string">'Y-m-d'</span>).<span class="string">"/"</span>.$fileName.<span class="string">".txt"</span>;</span><br><span class="line"><span class="comment">//æ‰“å¼€æ–‡ä»¶ "a+" è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶æœ«å°¾ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»º</span></span><br><span class="line">        $handle = fopen($file,<span class="string">"a+"</span>);</span><br><span class="line"><span class="comment">//å†™å…¥æ–‡ä»¶ </span></span><br><span class="line">        $str = fwrite($handle,date(<span class="string">'Y-m-d H:i:s'</span>).<span class="string">':'</span>.json_encode($data).<span class="string">"\n"</span>);</span><br><span class="line"><span class="comment">//å…³é—­æ–‡ä»¶</span></span><br><span class="line">        fclose($handle);</span><br><span class="line">        <span class="keyword">if</span>($str)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br><blockquote><p>è°ƒç”¨æ–¹æ³•:</p></blockquote><br><figure class="highlight php"><figcaption><span>è°ƒç”¨</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> Db::write_log(<span class="string">'./log/'</span>,<span class="keyword">array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>),<span class="string">'greenCloudReturnMsg'</span>);</span><br></pre></td></tr></table></figure><br><blockquote><p>æ•ˆæœï¼š</p></blockquote><br><img src="/phpåšä¸€ä¸ªç®€å•çš„æ—¥å¿—åŠŸèƒ½/../img/log/1_log.png" title="phpå®ç°å†™å…¥æ—¥å¿—"><br><img src="/phpåšä¸€ä¸ªç®€å•çš„æ—¥å¿—åŠŸèƒ½/../img/log/2_log.png" title="phpå®ç°å†™å…¥æ—¥å¿—"><br><img src="/phpåšä¸€ä¸ªç®€å•çš„æ—¥å¿—åŠŸèƒ½/../img/log/3_log.png" title="phpå®ç°å†™å…¥æ—¥å¿—"></p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlæ›´æ–°sqlä¼˜åŒ–</title>
      <link href="/mysql%E6%9B%B4%E6%96%B0sql%E4%BC%98%E5%8C%96/"/>
      <url>/mysql%E6%9B%B4%E6%96%B0sql%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>mysql on duplicate key update å¯¹äºä¸æ˜¯å¾ˆå¸¸ç”¨çš„äººæ¥è¯´æ˜¯æ¯”è¾ƒé™Œç”Ÿçš„ã€‚é‚£ä¹ˆä»–åˆ°åº•æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹ï¼š</p><p>æ¯”å¦‚åœ¨æˆ‘ä»¬åšä¸€ä¸ªç‚¹å‡»é‡çš„åŠŸèƒ½ï¼Œç¨‹åºçš„é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š<br>åœ¨ç”¨æˆ·ç‚¹å‡»çš„æ—¶å€™æˆ‘ä»¬é¦–å…ˆè¦åˆ¤æ–­æ•°æ®è¡¨ä¸­å·²ç»å­˜åœ¨äº†è¿™ä¸ªäººçš„æ•°æ®ï¼Œå¦‚æœå­˜åœ¨æ—¥å¿—è¡¨å¯¹åº”çš„ç”¨æˆ·ç‚¹å‡»æ¬¡æ•°åŠ 1ï¼Œå¦‚æœä¸å­˜åœ¨æ–°å¢ä¸€æ¡æ•°æ®ã€‚</p><p>é‚£ä¹ˆæŒ‰ç…§æ­£å¸¸çš„ç¼–ç¨‹éœ€è¦æœ‰ä¸¤æ¡sql</p><p>å…ˆæŸ¥è¯¢æ•°æ®è¡¨ä¸­æ˜¯å¦æœ‰ï¼Œæœ‰äº†æ‰§è¡Œä¿®æ”¹æ“ä½œï¼Œæ²¡æœ‰æ‰§è¡Œæ·»åŠ æ“ä½œã€‚ä¸€æ¡æŸ¥è¯¢ä¸€æ¡ä¿®æ”¹æˆ–æ·»åŠ ã€‚</p><p>é‚£ä¹ˆæœ‰äº†è¿™ä¸ªon duplicate key update ä¹‹åå°±å¯ä»¥æŠŠè¿™ä¸¤ä¸ªsqlç®€åŒ–ä¸ºä¸€æ¡ï¼Œå‡å°‘äº†æ•°æ®çš„æŸ¥è¯¢æ¬¡æ•°ã€é¿å…äº†æ•°æ®é‡å¤è€Œä¸”å°‘æ‰“ä¸€äº›ä»£ç ï¼Œå¯è°“æ˜¯ä¸€ä¸¾ä¸‰å¾—ï¼<br><a id="more"></a><br><figure class="highlight plain"><figcaption><span>sql</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into t_my (id,click) VALUES (2,1) on DUPLICATE KEY UPDATE click=click+1;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡å°ç¨‹åºå¼€å‘è·å–unionID</title>
      <link href="/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%E8%8E%B7%E5%8F%96unionID/"/>
      <url>/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%E8%8E%B7%E5%8F%96unionID/</url>
      
        <content type="html"><![CDATA[<p>è¿™å‡ å¤©åœ¨åšä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºï¼Œåœ¨å¾®ä¿¡å…¬ä¼—å¹³å°å·²ç»å®Œæˆçš„é…ç½®ï¼Œä»¥åŠæ¥å£çš„å¼€å‘ã€‚æœ€åå´å‘ç°å°ç¨‹åºçš„openidå’Œå¾®ä¿¡å…¬ä¼—å·çš„ä¸ä¸€è‡´ï¼Œå†çœ‹äº†å¾®ä¿¡æ–‡æ¡£ä¹‹åå‘ç°ï¼Œå°ç¨‹åºå’Œå¾®ä¿¡å…¬å·çš„openidéƒ½æ˜¯ç‹¬ç«‹çš„ã€‚åªæœ‰ä¸€ä¸ªUnionIDæ˜¯é€šç”¨çš„ï¼Œåˆ°è¿™é‡Œå°±å¯ä»¥é€šè¿‡å¾®ä¿¡çš„æ¥å£getuserinfoå»è·å–äº†ã€‚ä½†æ˜¯æœ‰å¾ˆå¤šäººæ˜¯è·å–ä¸åˆ°çš„ï¼Œä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹æœ‰ä»€ä¹ˆæƒ…å†µæ˜¯è·å–ä¸åˆ°çš„ï¼š<br><blockquote><p>ç¬¬ä¸€ç§æƒ…å†µï¼šå¾®ä¿¡è¯·æ±‚ç”¨æˆ·æˆæƒï¼Œç”¨æˆ·æœªåŒæ„</p></blockquote><br><blockquote><p>ç¬¬äºŒç§æƒ…å†µï¼šç”¨æˆ·æ²¡æœ‰å…³æ³¨è¿‡å°ç¨‹åºç»‘å®šçš„å…¬ä¼—å·ã€ä¹Ÿæ²¡æœ‰ç™»å½•è¿‡</p></blockquote><br><blockquote><p>ç¬¬ä¸‰ç§ï¼šåœ¨å¾®ä¿¡å…¬ä¼—å¹³å°æœªç»‘å®šå¼€å‘è€…</p></blockquote><br>å¦‚æœè¿™ä¸‰ç§æƒ…å†µéƒ½æ²¡æœ‰ï¼Œæ˜¯å¯ä»¥è·å–åˆ°unionIdçš„ã€‚<br><a id="more"></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å¾®ä¿¡å°ç¨‹åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sublimeé…ç½®è‡ªåŠ¨ä¸Šä¼ æ–‡ä»¶</title>
      <link href="/sublime%E9%85%8D%E7%BD%AE%E8%87%AA%E5%8A%A8%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6/"/>
      <url>/sublime%E9%85%8D%E7%BD%AE%E8%87%AA%E5%8A%A8%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ä¸€ç›´åœ¨ä¿®æ”¹å…¬å¸è€ç³»ç»Ÿä¸Šçš„bug,å› ä¸ºè€ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£…gitä»¥åŠå…¶ä»–çš„ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ï¼Œæ‰€ä»¥åªèƒ½ç”¨ftpä¸Šä¼ ã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹æ˜¯æä¸ºç—›è‹¦çš„ï¼Œè¦æƒ³ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶å¿…é¡»å…ˆä¸‹è½½ï¼Œå†ä¿®æ”¹ï¼Œå†ä¸Šä¼ ã€‚æ¯æ¬¡ç‚¹æ¥ç‚¹å»ç»ˆäºæŠŠæˆ‘æçƒ¦äº†ï¼Œä»Šå¤©ä¸‹å®šå†³å¿ƒä¸€å®šè¦æä¸€ä¸ªè‡ªåŠ¨ä¸Šä¼ ã€‚</p><p>ä¹‹åå°±æ˜¯åœ¨ç™¾åº¦ä¸æ–­çš„æ‰¾èµ„æ–™ï¼Œåœ¨èåˆäº†å¤šç¯‡èµ„æ–™çš„ç²¾ååç»ˆäºæ­å»ºæˆåŠŸï¼</p><p>ä¸€æ¬¡æ¬¡çš„æµ‹è¯•åï¼Œå“ˆå“ˆå“ˆå“ˆï¼ï¼ï¼ï¼ï¼ï¼å®Œå…¨æ²¡é—®é¢˜ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p><p>ä¸‹é¢ä¸ºå¤§å®¶å¥‰çŒ®å®ç°æ­¥éª¤ï¼š<br><a id="more"></a><br><blockquote class="pullquote [class]"><p>ç¬¬ä¸€æ­¥ï¼šæ‰“å¼€sublime å®‰ä½Ctrl+Shift+p</p></blockquote><br><img src="/sublimeé…ç½®è‡ªåŠ¨ä¸Šä¼ æ–‡ä»¶/img/2.png" title="sublimeé…ç½®sftpè‡ªåŠ¨ä¸Šä¼  sublimeå‘½ä»¤"><br><blockquote class="pullquote [class]"><p>ç¬¬äºŒæ­¥ï¼šè¾“å…¥sftpï¼Œå›è½¦ã€‚æ³¨æ„è¦é€‰æ‹©åå­—ä¸ºsftpçš„ï¼Œè¿™é‡Œå› ä¸ºæˆ‘å®‰è£…è¿‡äº†æ‰€ä»¥æœä¸åˆ°ï¼</p></blockquote><br><img src="/sublimeé…ç½®è‡ªåŠ¨ä¸Šä¼ æ–‡ä»¶/img/4.png" title="sublimeé…ç½®sftpè‡ªåŠ¨ä¸Šä¼  sublimeå‘½ä»¤"><br>ç­‰å¾…å®‰è£…å®Œæˆåè¿›è¡Œä¸‹ä¸€æ­¥ï¼<br><blockquote class="pullquote [class]"><p>ç¬¬ä¸‰æ­¥ï¼šé…ç½®æ’ä»¶å‚æ•°</p></blockquote><br><img src="/sublimeé…ç½®è‡ªåŠ¨ä¸Šä¼ æ–‡ä»¶/img/3.png" title="sublimeé…ç½®sftpè‡ªåŠ¨ä¸Šä¼  é…ç½®å‚æ•°"><br><blockquote class="pullquote [class]"><p>ç¬¬å››æ­¥ï¼šæµ‹è¯•</p></blockquote><br><img src="/sublimeé…ç½®è‡ªåŠ¨ä¸Šä¼ æ–‡ä»¶/img/1.png" title="sublimeé…ç½®sftpè‡ªåŠ¨ä¸Šä¼  æµ‹è¯•"><br>åˆ°è¿™é‡Œè‡ªåŠ¨ä¸Šä¼ çš„åŠŸèƒ½å°±å·²ç»å®Œæˆäº†ï¼Œå¦‚æœæœ‰é‡åˆ°é—®é¢˜è¯·åœ¨ä¸‹é¢ç•™è¨€æˆ–å‘é‚®ä»¶ï¼Œæˆ‘ä¼šå°½åŠ›å¸®ä½ è§£ç­”ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡å…¬ä¼—å·æ”¯ä»˜å›è°ƒä¸­å‘é€æ¨¡æ¿æ¶ˆæ¯çš„é—®é¢˜ä»¥åŠå¦‚ä½•å®ç°å‘é€æ¨¡æ¿æ¶ˆæ¯</title>
      <link href="/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E6%94%AF%E4%BB%98%E5%9B%9E%E8%B0%83%E4%B8%AD%E5%8F%91%E9%80%81%E6%A8%A1%E6%9D%BF%E6%B6%88%E6%81%AF%E7%9A%84%E9%97%AE%E9%A2%98%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8F%91%E9%80%81%E6%A8%A1%E6%9D%BF%E6%B6%88%E6%81%AF/"/>
      <url>/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E6%94%AF%E4%BB%98%E5%9B%9E%E8%B0%83%E4%B8%AD%E5%8F%91%E9%80%81%E6%A8%A1%E6%9D%BF%E6%B6%88%E6%81%AF%E7%9A%84%E9%97%AE%E9%A2%98%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8F%91%E9%80%81%E6%A8%A1%E6%9D%BF%E6%B6%88%E6%81%AF/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨åšä¸€ä¸ªå¾®ä¿¡ä¸Šçš„ä¼šå‘˜ç³»ç»Ÿï¼Œæ¶‰åŠåˆ°å¾®ä¿¡æ”¯ä»˜å›è°ƒä¸­å‘é€æ¨¡æ¿æ¶ˆæ¯çš„é—®é¢˜ã€‚ä»æ¥ä¸å–œæ¬¢çœ‹å¾®ä¿¡æ–‡æ¡£çš„æˆ‘é‡åˆ°äº†éå¸¸å¤šçš„å‘ï¼Œæœ€ç»ˆè¿˜æ˜¯å¡«å¹³äº†ï¼Œå¸Œæœ›å¤§å®¶å†çœ‹äº†æˆ‘è¿™ç¯‡æ–‡ç« ä¹‹åèƒ½å°‘èµ°äº›å¼¯è·¯å§ï¼</p><p>ä¸‹é¢ä¸ºå¤§å®¶è´´å‡ºä»£ç ï¼š<br><figure class="highlight php"><figcaption><span>æ”¯ä»˜å›è°ƒ</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è°ƒç”¨æ¨¡æ¿æ¶ˆæ¯</span></span><br><span class="line">user_pay(<span class="number">100</span>,$userid,$openid,<span class="string">'pay_success'</span>,$integral.<span class="string">'å…ƒ'</span>,$balance.<span class="string">'å…ƒ'</span>);</span><br><span class="line"><span class="comment">//å‘å¾®ä¿¡å‘é€æ”¯ä»˜æˆåŠŸ</span></span><br><span class="line">$textTpl=<span class="string">"&lt;xml&gt;</span></span><br><span class="line"><span class="string">&lt;return_code&gt;&lt;![CDATA[SUCCESS]]&gt;&lt;/return_code&gt;</span></span><br><span class="line"><span class="string">&lt;return_msg&gt;&lt;![CDATA[OK]]&gt;&lt;/return_msg&gt;</span></span><br><span class="line"><span class="string">&lt;/xml&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> $textTpl;</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><figure class="highlight php"><figcaption><span>æ¨¡æ¿æ¶ˆæ¯</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–access_token</span></span><br><span class="line">$access_token=access_tokens($appid,$appsecret,$mulu);</span><br><span class="line"><span class="comment">//ç‚¹å‡»æ¨¡æ¿çš„è·³è½¬åœ°å€</span></span><br><span class="line">$url=$a[<span class="string">'titleurl'</span>].<span class="string">"?action=my"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–é€šçŸ¥æ¨¡æ¿Id</span></span><br><span class="line">$mb = $mbID;</span><br><span class="line"><span class="comment">//å……å€¼æˆåŠŸé€šçŸ¥</span></span><br><span class="line"><span class="keyword">if</span>($type==<span class="string">'pay_success'</span>)&#123;</span><br><span class="line">$name = <span class="string">'å……å€¼æˆåŠŸï¼'</span>;</span><br><span class="line">$time = date(<span class="string">"Y-m-d H:i:s"</span>);</span><br><span class="line">$remark = <span class="string">"æ­å–œæ‚¨å……å€¼æˆåŠŸäº†ï¼æ‚¨å¯ä»¥å‰å¾€ä¸ªäººä¸­å¿ƒæŸ¥çœ‹è´¦æˆ·ä½™é¢ä»¥åŠå‡çº§æ–¹å¼,æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼"</span>;</span><br><span class="line"><span class="comment">//æ¨¡æ¿æ¶ˆæ¯</span></span><br><span class="line">$template=<span class="keyword">array</span>(</span><br><span class="line"><span class="string">'touser'</span>=&gt;$openid,</span><br><span class="line"><span class="string">'template_id'</span>=&gt;$mb,</span><br><span class="line"><span class="string">'url'</span>=&gt;$url,</span><br><span class="line"><span class="string">'topcolor'</span>=&gt;<span class="string">"#7B68EE"</span>,</span><br><span class="line"><span class="string">'data'</span>=&gt;<span class="keyword">array</span>(</span><br><span class="line"><span class="string">'first'</span>=&gt;<span class="keyword">array</span>(<span class="string">'value'</span>=&gt;urlencode($name),<span class="string">'color'</span>=&gt;<span class="string">"#ff0000"</span>),</span><br><span class="line"><span class="string">'keyword1'</span>=&gt;<span class="keyword">array</span>(<span class="string">'value'</span>=&gt;urlencode($userid),<span class="string">'color'</span>=&gt;<span class="string">'#0000FE'</span>),</span><br><span class="line"><span class="string">'keyword2'</span>=&gt;<span class="keyword">array</span>(<span class="string">'value'</span>=&gt;urlencode($price),<span class="string">'color'</span>=&gt;<span class="string">'#000000'</span>),</span><br><span class="line"><span class="string">'keyword3'</span>=&gt;<span class="keyword">array</span>(<span class="string">'value'</span>=&gt;urlencode($balance),<span class="string">'color'</span>=&gt;<span class="string">'#000000'</span>),</span><br><span class="line"><span class="string">'keyword4'</span>=&gt;<span class="keyword">array</span>(<span class="string">'value'</span>=&gt;urlencode($time),<span class="string">'color'</span>=&gt;<span class="string">'#000000'</span>),</span><br><span class="line"><span class="string">'remark'</span>=&gt;<span class="keyword">array</span>(<span class="string">'value'</span>=&gt;urlencode($remark),<span class="string">'color'</span>=&gt;<span class="string">'#008000'</span>),</span><br><span class="line">)</span><br><span class="line">);</span><br><span class="line">&#125;</span><br><span class="line">$json_template=json_encode($template);</span><br><span class="line">$url=<span class="string">"https://api.weixin.qq.com/cgi-bin/message/template/send?access_token="</span>.$access_token;</span><br><span class="line">$res=http_request($url,urldecode($json_template));</span><br><span class="line">$res = json_decode($res,<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">if</span>($res[<span class="string">'errcode'</span>]==<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>å¾®ä¿¡å‘é€æ¨¡æ¿æ¶ˆæ¯æˆåŠŸä¹‹åä¼šå›è°ƒä½ é…ç½®çš„æ¶ˆæ¯åœ°å€<br><blockquote><p>æ³¨æ„åœ¨ä½ é…ç½®çš„æ¶ˆæ¯å›è°ƒåœ°å€çš„æ–¹æ³•ä¸­æ‰¾åˆ°å¾®ä¿¡æ‰€å›è°ƒçš„ä»£ç ä¸èƒ½ç”¨exitæˆ–dieæ¥ç»“æŸä»£ç ï¼Œæ”¯ä»˜å›è°ƒå°†æ— æ³•è¾“å‡ºæ”¯ä»˜æˆåŠŸï¼</p></blockquote></p>]]></content>
      
      
      
        <tags>
            
            <tag> å¾®ä¿¡æ”¯ä»˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå®ç°æ•°æ®å¯¼å‡ºexcelè¡¨æ ¼</title>
      <link href="/php%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BAexcel%E8%A1%A8%E6%A0%BC/"/>
      <url>/php%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BAexcel%E8%A1%A8%E6%A0%BC/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©çš„åšå®¢å†…å®¹æ˜¯phpå®ç°å¯¼å‡ºexcel,å¤§å®¶éƒ½çŸ¥é“å®ç°phpå¯¼å‡ºexcelæœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œæœ€æ–¹ä¾¿çš„æ˜¯phpexcelè¿™ä¸ªæ’ä»¶ï¼Œä½†æ˜¯åœ¨å¤„ç†æµ·é‡æ•°æ®çš„æ—¶å€™å°±ä¼šå‡ºç°éå¸¸éå¸¸ç¼“æ…¢çš„æƒ…å†µã€‚è€Œä¸”ç”¨è¿™ä¸ªæ’ä»¶è¦æ±‚çš„phpç‰ˆæœ¬æ˜¯5.6ä»¥ä¸Šï¼Œå¾ˆä¸å·§ï¼Œæˆ‘çš„phpç‰ˆæœ¬æ˜¯5.4ã€‚ç”¨ä¸äº†è¿™ä¸ªæ’ä»¶ï¼Œåªèƒ½å¦å¯»ä»–æ³•äº†ï¼</p><p>åˆšå¼€å§‹çš„ä½¿ç”¨æ˜¯ä½¿ç”¨å‰ç«¯çš„tableå¯¼å‡º,æ„Ÿè§‰ä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œä»£ç é‡å¤ªå¤§ï¼Œä¸æ–¹ä¾¿ã€‚</p><p>åæ¥åˆå°è¯•äº†å‡ ç§æ–¹æ³•ï¼Œæœ€åé€‰æ‹©äº†ä¸€ç§æœ€ç®€å•ï¼Œæœ€æœ‰æ•ˆï¼Œä»£ç é‡æœ€å°‘çš„æ–¹æ³•ï¼<br><a id="more"></a><br><figure class="highlight php"><figcaption><span>ä»£ç </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'./db.php'</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">index</span> <span class="keyword">extends</span> <span class="title">Db</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$data = Db::get_all(<span class="string">"select userid from order"</span>);</span><br><span class="line">header(<span class="string">"Content-type:application/vnd.ms-excel"</span>);<span class="comment">//è®¾ç½®å¯¼å‡ºæ ¼å¼</span></span><br><span class="line">        header(<span class="string">"Content-Disposition:filename=å¯¼å‡º.xls"</span>);<span class="comment">//è®¾ç½®å¯¼å‡ºæ–‡ä»¶åç§°</span></span><br><span class="line">  header(<span class="string">"Cache-Control: max-age=0"</span>);<span class="comment">//æ•°æ®ä¸ç»è¿‡ç¼“å­˜ï¼Œæ¯æ¬¡æŸ¥è¯¢æ•°æ®åº“</span></span><br><span class="line">$strexport=<span class="string">"Userid\r"</span>;</span><br><span class="line"><span class="keyword">foreach</span> ($data <span class="keyword">as</span> $row)&#123;</span><br><span class="line">            $strexport.= $row[<span class="string">'userid'</span>].<span class="string">"\r"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">$strexport = iconv(<span class="string">'UTF-8'</span>,<span class="string">"GB2312//IGNORE"</span>,$strexport);</span><br><span class="line">        <span class="keyword">exit</span>($strexport);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$obj = <span class="keyword">new</span> index;</span><br></pre></td></tr></table></figure></p><p>è¿™æ®µä»£ç åªæ˜¯å®ç°æœ€ç®€å•çš„å¯¼å‡ºï¼Œå…·ä½“çš„ä¼˜åŒ–å°±éœ€è¦å¤§å®¶å»ç ”ç©¶äº†ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpè½¬ä¹‰htmlå®ä½“</title>
      <link href="/php%E8%BD%AC%E4%B9%89html%E5%AE%9E%E4%BD%93/"/>
      <url>/php%E8%BD%AC%E4%B9%89html%E5%AE%9E%E4%BD%93/</url>
      
        <content type="html"><![CDATA[<p>ç»å¸¸ä½¿ç”¨å„ç§ç¼–è¾‘å™¨çš„å°ä¼™ä¼´ä»¬éƒ½ä¼šé‡åˆ°ï¼Œåœ¨å¤åˆ¶ä¸€äº›å¸¦æœ‰æ ·å¼æ–‡å­—åˆ°ç¼–è¾‘å™¨ç„¶åä¿å­˜åˆ°æ•°æ®åº“é‡Œä¹‹åä¸€äº›ç‰¹æ®Šçš„ç¬¦å·è¢«è½¬ä¹‰æˆäº†htmlå®ä½“ã€‚</p><p>ä¾‹å¦‚ï¼šå¤§äºå·å’Œå°äºå·ï¼Œé€šè¿‡ç¼–è¾‘å™¨å’Œæ¡†æ¶çš„è¿‡æ»¤å’Œå¤„ç†å­˜åˆ°æ•°æ®åº“çš„æ˜¯&amp;gtå’Œ&lt;</p><p>ç„¶ååœ¨å‰ç«¯æŠŠæ•°æ®è¾“å‡ºåˆ°é¡µé¢ä¸Šä¹‹åè¿˜æ˜¯æ•°æ®åº“é‡Œçš„åŸæ–‡ï¼Œå¹¶æ²¡æœ‰è½¬ä¹‰æˆæ­£å¸¸çš„ç¬¦å·ã€‚</p><p>é‚£ä¹ˆå°±éœ€è¦ç”¨åˆ°è¿™ä¸ªphpå‡½æ•°äº†ï¼š</p><figure class="highlight php"><figcaption><span>è½¬ä¹‰å‡½æ•°</span><a href="http://php.net/manual/zh/function.htmlspecialchars-decode.php" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">htmlspecialchars_decode()</span><br></pre></td></tr></table></figure><p>åœ¨æˆ‘ä½¿ç”¨ä¹‹åå‘ç°ä»–ä¸ä»…èƒ½è§£å†³è¿™äº›ç¬¦å·çš„é—®é¢˜ï¼Œå…¶ä»–htmlæ ‡ç­¾çš„é—®é¢˜åœ¨è½¬ä¹‰åä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡æ”¯ä»˜å¼‚æ­¥å›è°ƒéªŒè¯è®¢å•çœŸå®æ€§</title>
      <link href="/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%BC%82%E6%AD%A5%E5%9B%9E%E8%B0%83%E9%AA%8C%E8%AF%81%E8%AE%A2%E5%8D%95%E7%9C%9F%E5%AE%9E%E6%80%A7/"/>
      <url>/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%BC%82%E6%AD%A5%E5%9B%9E%E8%B0%83%E9%AA%8C%E8%AF%81%E8%AE%A2%E5%8D%95%E7%9C%9F%E5%AE%9E%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨åšä¸€ä¸ªå……å€¼åŠŸèƒ½ï¼Œå› ä¸ºæ˜¯å¾®ç½‘ç«™å¹¶ä¸”æ˜¯åœ¨å¾®ä¿¡å…¬ä¼—å·å†…ï¼Œæ‰€ä»¥é€‰æ‹©äº†å¾®ä¿¡å…¬ä¼—å·æ”¯ä»˜ã€‚åšè¿‡å¾®ä¿¡æ”¯ä»˜çš„å°ä¼™ä¼´éƒ½çŸ¥é“å¾®ä¿¡æ”¯ä»˜çš„æ¨¡å¼åˆ†ä¸ºä¸‰ç§ï¼š</p><p>ç¬¬ä¸€ç§ï¼šæ™®é€šå•†æˆ·</p><p>ç¬¬äºŒç§ï¼šæœåŠ¡å•†</p><p>ç¬¬ä¸‰ç§ï¼šé“¶è¡ŒæœåŠ¡</p><p>ä¸‰ç§æ”¯ä»˜æ¨¡å¼æœ‰å¾ˆæ˜æ˜¾çš„ä¸åŒï¼Œç¬¬ä¸€ç§å°±æ˜¯æœ€å¸¸è§çš„æ™®é€šå¾®ä¿¡å…¬ä¼—å·æ”¯ä»˜ï¼Œæ”¯ä»˜éœ€è¦å¾®ä¿¡å…¬ä¼—å·çš„appid appkey mc_id mc_key å››ä¸ªæ”¯ä»˜å‚æ•°ã€‚è€Œè¿™å››ä¸ªå‚æ•°éƒ½æ˜¯å±äºå•ç‹¬çš„å¾®ä¿¡æ”¯<br>ä»˜å‚æ•°ã€‚<br><a id="more"></a><br>ç¬¬äºŒç§æ˜¯æœåŠ¡å•†æ¨¡å¼ï¼Œé¦–å…ˆè¦æœ‰ä¸€ä¸ªæœåŠ¡å•†çš„æ”¯ä»˜å¹³å°ï¼Œç„¶åé€šè¿‡è¿™ä¸ªæœåŠ¡å•†æ”¯ä»˜å¹³å°ç”³è¯·å­å•†æˆ·å¹³å°ã€‚é‚£ä¹ˆæ”¯ä»˜çš„æ—¶å€™åŒæ ·çš„å››ä¸ªæ”¯ä»˜å‚æ•°å°±è¦ä»æœåŠ¡å•†å’Œå­å•†æˆ·è·å¾—äº†ï¼Œå¹¶ä¸æ˜¯<br>å•ç‹¬çš„ä¸€ä¸ªå…¬ä¼—å·é‡Œçš„å‚æ•°ã€‚å…·ä½“å¤§å®¶å¯ä»¥çœ‹å¾®ä¿¡çš„æ–‡æ¡£ã€‚</p><p>ç¬¬ä¸‰ç§æš‚æ—¶æ²¡åšè¿‡ã€‚</p><p>å‘¨æ‰€ä¼—çŸ¥å¾®ä¿¡æ”¯ä»˜å¼‚æ­¥å›è°ƒéªŒè¯è®¢å•çœŸå®æ€§æ˜¯éå¸¸é‡è¦çš„ï¼Œå¦‚æœä¸åšéªŒè¯ï¼Œåœ¨æœ‰äººçŸ¥é“ä½ çš„å¾®ä¿¡æ”¯ä»˜å›è°ƒåœ°å€åå°±èƒ½ç›´æ¥è¯·æ±‚ä½ çš„æ”¯ä»˜å›è°ƒåœ°å€ï¼Œæ¨¡ä»¿å¾®ä¿¡æ”¯ä»˜å›è°ƒè¾¾åˆ°ä¸æ”¯ä»˜<br>é‡‘é¢å°±èƒ½å……å€¼ã€è´­ä¹°å•†å“ç­‰æ“ä½œï¼æ‰€ä»¥éªŒè¯è®¢å•çš„çœŸå®æ€§æ˜¯æ¯ä¸ªç¨‹åºå‘˜å¿…é¡»è¦åšçš„ï¼</p><p>é‚£ä¹ˆå…·ä½“çš„éªŒè¯æ­¥éª¤æœ‰å“ªäº›å‘¢ï¼Ÿ</p><p>ç¬¬ä¸€æ­¥ï¼šæ¥æ”¶å¾®ä¿¡è¿”å›çš„å‚æ•°ã€‚<br>ç¬¬äºŒæ­¥ï¼šå¤„ç†å‚æ•°ã€‚<br>ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨ksortæ’åºå‚æ•°ï¼ŒASCIIç ä»å°åˆ°å¤§æ’åº.<br>ç¬¬å››æ­¥ï¼šåœ¨å‚æ•°åé¢è¿æ¥ä¸Š(å•†æˆ·ç§˜é’¥è®¾ç½®è·¯å¾„ï¼šå¾®ä¿¡å•†æˆ·å¹³å°(pay.weixin.qq.com)â€“&gt;è´¦æˆ·è®¾ç½®â€“&gt;APIå®‰å…¨â€“&gt;å¯†é’¥è®¾ç½®)ã€‚<br>ç¬¬äº”æ­¥ï¼šåŠ å¯†ç”Ÿæˆç­¾åã€‚<br>ç¬¬å…­æ­¥ï¼šå¯¹æ¯”åŠ å¯†åçš„ç­¾åã€‚</p><p>å…·ä½“çš„æ­¥éª¤å¯ä»¥åœ¨å¾®ä¿¡æ”¯ä»˜å¼€å‘æ–‡æ¡£ä¸­æŸ¥çœ‹è¯¦ç»†çš„ç­¾åç”Ÿæˆå’Œå¯¹æ¯”çš„æ­¥éª¤ï¼</p><p>ä¸‹é¢å°±æ˜¯æˆ‘æ ¹æ®å¾®ä¿¡æ–‡æ¡£å†™çš„ä»£ç ï¼š<br><figure class="highlight php"><figcaption><span>[ç”Ÿæˆç­¾ååŠå¯¹æ¯”] []</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$postobj = $GLOBALS[<span class="string">'HTTP_RAW_POST_DATA'</span>];<span class="comment">//ç¬¬ä¸€ç§æ–¹å¼</span></span><br><span class="line">$postobj = file_get_contents(<span class="string">"php://input"</span>);<span class="comment">//ç¬¬äºŒç§æ–¹å¼</span></span><br><span class="line">$postObj = (<span class="keyword">array</span>)simplexml_load_string($postStr, <span class="string">'SimpleXMLElement'</span>, LIBXML_NOCDATA);<span class="comment">//è½¬åŒ–xmlæ•°æ®ä¸ºæ•°ç»„</span></span><br><span class="line">    $result_code = $postObj[<span class="string">'result_code'</span>];<span class="comment">//å¾®ä¿¡è¿”å›çš„å‚æ•°</span></span><br><span class="line"><span class="keyword">if</span>($result_code==<span class="string">"SUCCESS"</span>)&#123;<span class="comment">//å‚æ•°å€¼ä¸ºSUCCESSæ—¶è¯´æ˜æ”¯ä»˜æˆåŠŸ</span></span><br><span class="line">           $total_fee = $postObj[<span class="string">'total_fee'</span>];</span><br><span class="line">        <span class="comment">//ç­¾åç®—æ³• Start</span></span><br><span class="line">           ksort($postObj);<span class="comment">//æ’åºå‚æ•°</span></span><br><span class="line">           $buff = <span class="string">""</span>;</span><br><span class="line">           <span class="keyword">foreach</span> ($postObj <span class="keyword">as</span> $k =&gt; $v)<span class="comment">//å¤„ç†å‚æ•°æŒ‰ç…§key=&gt;valueçš„å½¢å¼ç»„åˆæˆå­—ç¬¦ä¸²</span></span><br><span class="line">           &#123;</span><br><span class="line">              <span class="keyword">if</span>($k != <span class="string">"sign"</span> &amp;&amp; $v != <span class="string">""</span> &amp;&amp; !is_array($v))&#123;<span class="comment">//å»æ‰å‚æ•°ä¸­çš„signï¼ˆå¾®ä¿¡è¿”å›çš„ç­¾åï¼‰</span></span><br><span class="line">                 $buff .= $k . <span class="string">"="</span> . $v . <span class="string">"&amp;"</span>;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           $buff = trim($buff, <span class="string">"&amp;"</span>);<span class="comment">//å»é™¤æœ«å°¾çš„&amp;çš„ç¬¦å·</span></span><br><span class="line">           $buff = $buff.<span class="string">'&amp;key=ç§˜é’¥'</span>;<span class="comment">//è¿æ¥ä¸Šå•†æˆ·æ”¯ä»˜ç§˜é’¥</span></span><br><span class="line">           $signA = strtoupper(MD5($buff));<span class="comment">//MD5åŠ å¯†å¹¶è½¬ä¸ºå°å†™</span></span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">if</span>($postobj[<span class="string">'sign'</span>]==$signA &amp;&amp; $total_fee==çœŸå®çš„æ”¯ä»˜é‡‘é¢)&#123;</span><br><span class="line"><span class="comment">//è®¢å•çœŸå®</span></span><br><span class="line"><span class="comment">//é€»è¾‘å¤„ç†</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//ç­¾åé”™è¯¯æˆ–æ”¯ä»˜é”™è¯¯</span></span><br><span class="line">       <span class="keyword">echo</span> <span class="string">'&lt;xml&gt;</span></span><br><span class="line"><span class="string">  &lt;return_code&gt;&lt;![CDATA[FAIL]]&gt;&lt;/return_code&gt;//successæˆåŠŸ failå¤±è´¥</span></span><br><span class="line"><span class="string"> &lt;return_msg&gt;&lt;![CDATA[OK]]&gt;&lt;/return_msg&gt;</span></span><br><span class="line"><span class="string">    &lt;/xml&gt;'</span>;<span class="comment">//è¿”å›å¾®ä¿¡æ¶ˆæ¯å¦åˆ™å¾®ä¿¡ä¼šä¸€ç›´è¯·æ±‚ä½ çš„å¼‚æ­¥å›è°ƒåœ°å€</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼šä»¥ä¸Šæ˜¯é’ˆå¯¹æœåŠ¡å•†æ”¯ä»˜çš„ç­¾åå¯¹æ¯”æ–¹æ³•ï¼Œæ™®é€šå•†æˆ·çš„æ–¹æ³•åŸºæœ¬ä¸Šå’Œè¿™ä¸ªæ˜¯ä¸€è‡´çš„ï¼ˆæ™®é€šå•†æˆ·å¯èƒ½ä¸éœ€è¦å»é™¤signï¼‰ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¾®ä¿¡æ”¯ä»˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php å•ä¾‹æ¨¡å¼è¿æ¥æ•°æ®åº“PDO</title>
      <link href="/php%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93PDO/"/>
      <url>/php%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93PDO/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç¯‡ä»‹ç»ä¸€ä¸‹phpçš„å•ä¾‹æ¨¡å¼ä»¥åŠPDOè¿æ¥æ•°æ®åº“çš„æ–¹æ³•ã€‚</p><p>è¯´åˆ°â€™å•ä¾‹æ¨¡å¼â€˜phpåŸºç¡€æ¯”è¾ƒæ‰å®çš„ç«¥é‹è‚¯å®šä¸é™Œç”Ÿï¼Œä½†åƒæœ¬äººè¿™æ ·çš„ç¨‹åºçŒ¿åŸºç¡€ä¸æ˜¯å¾ˆå¥½çš„å¯èƒ½åªæ˜¯æœ‰äº›å°è±¡è€Œå·²ã€‚</p><p>é‚£ä¹ˆâ€™å•ä¾‹æ¨¡å¼â€˜åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ä»–å…¶å®æ˜¯phpæ¡†æ¶åº•å±‚æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œä¾‹å¦‚â€™å·¥å‚æ¨¡å¼â€˜ã€â€™æ³¨å†Œæ ‘æ¨¡å¼â€˜ã€â€™ç­–ç•¥æ¨¡å¼â€˜ä»¥åŠâ€™è§‚å¯Ÿè€…æ¨¡å¼â€˜ç­‰ç­‰ï¼Œéƒ½æ˜¯phpå„å¤§æ¡†æ¶åº•å±‚æ¶æ„çš„æ ¸å¿ƒæ‰€åœ¨ï¼</p><p>æ‰€è°“çš„â€™å•ä¾‹æ¨¡å¼â€˜è¯´ç™½äº†å…¶å®å°±æ˜¯â€™ä¸‰ç§æœ‰ï¼Œä¸€å…¬æœ‰â€˜ã€‚</p><p>â€™ä¸‰ç§æœ‰â€˜ï¼šä¸€ä¸ªç§æœ‰å˜é‡ä½œä¸ºå®ä¾‹åŒ–å¯¹è±¡å­˜å‚¨ï¼Œä¸¤ä¸ªç§æœ‰æ–¹æ³•â€™<strong>cloneâ€˜é˜²æ­¢å…‹éš†å¯¹è±¡ä»¥åŠâ€™</strong>constructâ€˜ã€‚</p><p>â€™ä¸€å…¬æœ‰â€˜ï¼šä¸€ä¸ªå…±æœ‰çš„æ–¹æ³•ç”¨æ¥æ£€æµ‹å’Œå®ä¾‹åŒ–ç±»ã€‚<br><a id="more"></a><br>ä¸‹é¢æ˜¯ä»£ç ï¼š<br><figure class="highlight php"><figcaption><span>[å•ä¾‹ç±»]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line"> <span class="comment">//å•ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Uni</span></span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºé™æ€ç§æœ‰çš„å˜é‡ä¿å­˜è¯¥ç±»å¯¹è±¡</span></span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">static</span> $instance;</span><br><span class="line">     <span class="comment">//é˜²æ­¢ç›´æ¥åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">     <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">     &#125;</span><br><span class="line">         <span class="comment">//é˜²æ­¢å…‹éš†å¯¹è±¡</span></span><br><span class="line">     <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span><span class="params">()</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">     &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">         <span class="comment">//åˆ¤æ–­$instanceæ˜¯å¦æ˜¯Uniçš„å¯¹è±¡</span></span><br><span class="line">         <span class="comment">//æ²¡æœ‰åˆ™åˆ›å»º</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">self</span>::$instance) &#123;</span><br><span class="line">            <span class="comment">//å®ä¾‹åŒ–æœ¬ç±»å¯¹è±¡ ä¼ å…¥å‚æ•°,å®ä¾‹åŒ–ç±»ä¼šæ‰§è¡Œæ„é€ å‡½æ•°</span></span><br><span class="line">            <span class="keyword">self</span>::$instance = <span class="keyword">new</span> PDO(<span class="string">'mysql:host=127.0.0.1;dbname=test'</span>, <span class="string">'root'</span>, <span class="string">'root'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢å¤šæ¡æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_all</span><span class="params">($sql,$type=<span class="number">1</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>($type==<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="comment">//ç¼“å†²æŸ¥è¯¢</span></span><br><span class="line">                $data = <span class="keyword">self</span>::getInstance()-&gt;query($sql)-&gt;fetchAll(PDO::FETCH_ASSOC);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//éç¼“å†²æŸ¥è¯¢</span></span><br><span class="line">                $uresult = <span class="keyword">self</span>::getInstance()-&gt;query($sql);</span><br><span class="line">                <span class="keyword">if</span> ($uresult) &#123;</span><br><span class="line">                   <span class="keyword">while</span> ($data[] = $uresult-&gt;fetch(PDO::FETCH_ASSOC)) &#123;&#125; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> $data;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'æŸ¥è¯¢é”™è¯¯'</span>.$e;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_one</span><span class="params">($sql)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            $data = <span class="keyword">self</span>::getInstance()-&gt;query($sql)-&gt;fetch(PDO::FETCH_ASSOC);</span><br><span class="line">            <span class="keyword">return</span> $data;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'æŸ¥è¯¢é”™è¯¯'</span>.$e;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢å•ä¸ªå­—æ®µ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_field</span><span class="params">($sql,$field)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            $data = <span class="keyword">self</span>::getInstance()-&gt;query($sql)-&gt;fetch(PDO::FETCH_ASSOC);</span><br><span class="line">            <span class="keyword">return</span> $data[$field];</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'æŸ¥è¯¢é”™è¯¯'</span>.$e;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p><p>çœ‹åˆ°è¿™é‡Œæœ‰çš„ç«¥é‹å¯èƒ½è¿˜ä¼šæœ‰äº›ç–‘é—®ï¼šâ€è¿™äº›ä»£ç åˆ°åº•æ˜¯èƒ½èµ·åˆ°ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿâ€œï¼Œä¸‹é¢å°±ä¸ºå¤§å®¶æ¼”ç¤ºä¸€ä¸‹è¿™ä¸ªå•ä¾‹ç±»åˆ°åº•æ˜¯å¹²ä»€ä¹ˆç”¨çš„ã€‚<br><figure class="highlight php"><figcaption><span>[æ¼”ç¤ºä»£ç ]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­$instanceæ˜¯å¦æ˜¯Uniçš„å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//æ²¡æœ‰åˆ™åˆ›å»º</span></span><br><span class="line">       <span class="keyword">if</span> (!<span class="keyword">self</span>::$instance) &#123; <span class="comment">// è¿™é‡Œåœ¨å¾€ä¸Šçœ‹åˆ°æœ‰çš„äººæ˜¯ç”¨ instanceof self æ¥åˆ¤æ–­çš„ï¼Œå¤§åŒå°å¼‚ã€‚ </span></span><br><span class="line">           <span class="keyword">echo</span> <span class="number">1</span>;</span><br><span class="line">           <span class="comment">//å®ä¾‹åŒ–æœ¬ç±»å¯¹è±¡ ä¼ å…¥å‚æ•°,å®ä¾‹åŒ–ç±»ä¼šæ‰§è¡Œæ„é€ å‡½æ•°</span></span><br><span class="line">           <span class="keyword">self</span>::$instance = <span class="keyword">new</span> PDO(<span class="string">'mysql:host=127.0.0.1;dbname=test'</span>, <span class="string">'root'</span>, <span class="string">'root'</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">self</span>::$instance;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å†è¿æ¥æ•°æ®åº“è¿™é‡Œè¾“å‡ºä¸€ä¸ª 1ï¼Œç„¶åè°ƒç”¨ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight plain"><figcaption><span>[è°ƒç”¨æ–¹æ³•]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Uni::getInstance();</span><br><span class="line">//1</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼šå‘ç°é¡µé¢ä¸Šè¾“å‡ºäº†ä¸€ä¸ª â€™1â€˜ï¼Œè¿™æ˜¯æ²¡é—®é¢˜çš„ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å†™ä¸€ä¸ªå¾ªç¯ï¼š</p><figure class="highlight php"><figcaption><span>[å¾ªç¯è°ƒç”¨]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt;<span class="number">10</span>; $i++) &#123; </span><br><span class="line">   Uni::getInstance(); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1</span></span><br></pre></td></tr></table></figure><p>åˆ°è¿™æˆ‘ä»¬ä¼šå‘ç°é¡µé¢ä¸Šè¾“å‡ºçš„è¿˜æ˜¯ä¸€ä¸ª â€™1â€˜ï¼Œè¯´æ˜æˆ‘ä»¬å¤šæ¬¡è°ƒç”¨è¿™ä¸ªç±»ï¼Œä½†åªè¿æ¥äº†ä¸€æ¬¡æ•°æ®åº“ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªå•ä¾‹ç±»ï¼Œæˆ‘ä»¬å¯èƒ½æ¯æ¬¡çš„æŸ¥è¯¢éƒ½å»è¿æ¥æ•°æ®åº“ï¼Œè¿‡å¤šçš„è¿æ¥ä¼šå¯¼è‡´æ•°æ®åº“å´©æºƒã€‚</p><p>æ‰€ä»¥è¿™ä¸ªå•ä¾‹æ¨¡å¼è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚</p><p>å¤§å®¶å­¦åˆ°äº†å—ï¼Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql åˆ é™¤è¡¨ä¸­é‡å¤çš„æ•°æ®</title>
      <link href="/mysql%E5%88%A0%E9%99%A4%E8%A1%A8%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%E6%8D%AE/"/>
      <url>/mysql%E5%88%A0%E9%99%A4%E8%A1%A8%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<p>sqlåˆ é™¤æ•°æ®åº“é‡å¤çš„æ•°æ®</p><p>ä»Šå¤©åœ¨å·¥ä½œä¸­é‡åˆ°äº†ä¸€ä¸ªæ³¨å†Œç»‘å®šå¾®ä¿¡UIDçš„é—®é¢˜ã€‚æŒ‰æ­£å¸¸é€»è¾‘æ¥è¯´ï¼Œä¸€ä¸ªæ‰‹æœºå·åªèƒ½ç»‘å®šä¸€ä¸ªUIdï¼Œä½†é—®é¢˜æ€»æ˜¯ä¼šåªæœ‰ä½ æƒ³ä¸åˆ°æ²¡æœ‰ä½ åšä¸åˆ°ï¼Œæœ‰ä¸ªå®¢æˆ·å±…ç„¶ç”¨ä¸€ä¸ªæ‰‹æœºå·ç»‘å®šäº†å‡ ç™¾ä¸ªæ‰‹æœºå·ï¼Œå…·ä½“æ˜¯ä¸ºäº†å¹²ä»€ä¹ˆå°±ä¸è¯´äº†ã€‚æœ‰ä¸€ä¸ªäººèƒ½æƒ³åˆ°è¿™æ ·çš„æ–¹æ³•ï¼Œå°±ä¼šæœ‰ç¬¬äºŒä¸ªäººèƒ½æƒ³åˆ°ï¼Œä¹‹åå°±ä¸ç”¨è¯´äº†è¶Šæ¥è¶Šå¤šã€‚ä»…ä»…å‡ å¤©æ•°æ®åº“é‡Œçš„æ•°æ®å·²ç»å‡ ä¸‡æ¡äº†ï¼Œæ…¢æ…¢çš„æˆ‘æ„è¯†åˆ°äº†è¿™æ ·ä¸‹å»è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œå¿…é¡»æƒ³åŠæ³•è§£å†³ã€‚åˆšå¼€å§‹æ˜¯æ‰‹åŠ¨åˆ é™¤é‡å¤çš„æ•°æ®ï¼Œä½†æ˜¯å¤ªå¤šäº†ï¼Œæ‰‹åŠ¨åˆ ç®€ç›´æ˜¯æ²¡æ³•å¼„ï¼Œä¸åˆ è¿˜ä¸è¡Œï¼Œç»™å­—æ®µåŠ å”¯ä¸€ç´¢å¼•å¿…é¡»è¦æŠŠé‡å¤çš„æ•°æ®åˆ æ‰.<br><a id="more"></a><br><figure class="highlight plain"><figcaption><span>[sql]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">delete from [table_name] where [primary key] in (select [primary key] from (select [primary key]</span><br><span class="line">FROM</span><br><span class="line">   [table_name]</span><br><span class="line">WHERE</span><br><span class="line">    [é‡å¤çš„å­—æ®µå] IN (</span><br><span class="line">        SELECT</span><br><span class="line">            [primary key]</span><br><span class="line">        FROM</span><br><span class="line">            [table_name]</span><br><span class="line">        GROUP BY</span><br><span class="line">            [é‡å¤çš„å­—æ®µå]</span><br><span class="line">        HAVING</span><br><span class="line">            count([é‡å¤çš„å­—æ®µå]) &gt; 1</span><br><span class="line">    )</span><br><span class="line">AND [primary key] NOT IN (</span><br><span class="line">    SELECT</span><br><span class="line">        min([primary key])</span><br><span class="line">    FROM</span><br><span class="line">        [table_name]</span><br><span class="line">    GROUP BY</span><br><span class="line">        [é‡å¤çš„å­—æ®µå]</span><br><span class="line">    HAVING</span><br><span class="line">        count([é‡å¤çš„å­—æ®µå]) &gt; 1</span><br><span class="line">))a)</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>è¿™æ®µsqlä¸ä»…è§£å†³äº†æˆ‘çš„ç‡ƒçœ‰ä¹‹æ€¥ï¼Œå¹¶ä¸”è¿˜å¸®æˆ‘ä¿ç•™äº†é‡å¤æ•°æ®ä¸­çš„ä¸€æ¡æœ€è€çš„æ•°æ®ï¼</p><p>è™½ç„¶sqlå†™çš„å¾ˆå®Œç¾ä½†æ˜¯ä¹Ÿè¦ç»è¿‡å®è·µæ‰èƒ½æ˜¯ä¸æ˜¯æ­£ç¡®çš„ï¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECTÂ *Â FROMÂ [table_name]Â groupÂ byÂ [é‡å¤çš„å­—æ®µå]Â HAVINGÂ count(*)&gt;1</span><br></pre></td></tr></table></figure><br>æŸ¥è¯¢æ¡æ•°ä¸º0ï¼Œsqlæ­£ç¡®æ— è¯¯ï¼Œæ¼‚äº®ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå°†æŒ‡å®šæ–‡å­—æ›¿æ¢ä¸ºç›¸åŒæ•°é‡çš„*å·</title>
      <link href="/php%E5%B0%86%E6%8C%87%E5%AE%9A%E6%96%87%E5%AD%97%E6%9B%BF%E6%8D%A2%E4%B8%BA%E7%9B%B8%E5%90%8C%E6%95%B0%E9%87%8F%E7%9A%84-%E5%8F%B7/"/>
      <url>/php%E5%B0%86%E6%8C%87%E5%AE%9A%E6%96%87%E5%AD%97%E6%9B%BF%E6%8D%A2%E4%B8%BA%E7%9B%B8%E5%90%8C%E6%95%B0%E9%87%8F%E7%9A%84-%E5%8F%B7/</url>
      
        <content type="html"><![CDATA[<p>æ›¿æ¢æ–‡å­—ä¸ºæ˜Ÿå·çš„åŠŸèƒ½ç»å¸¸ä¼šé‡åˆ°ï¼Œæ¯”å¦‚å…³é”®è¯è¿‡æ»¤ï¼ŒèŠå¤©å†…å®¹è¿‡æ»¤ç­‰ï¼Œè¯ä¸å¤šè¯´ç›´æ¥ä¸Šä»£ç ï¼</p><figure class="highlight php"><figcaption><span>[å®ç°ä»£ç ]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$text = <span class="string">"è‹è²çš„ä¸–ç•Œå®‰é˜²ç§‘æŠ€æŒ‰æ—¶ä»˜æ¬¾é“¾æ¥è¨è¾¾å“ˆåƒåœ¾å¡åˆ·å¡è´¹SAPå‘ç”Ÿç ´æˆ¿é—´çˆ±ä¸Šï¼›é è°±ç§¯åˆ†å¡æ™®æ–¯å®‰å¾½äº¤ä»˜ææ€•æ˜¯ç”µè¯è´¹ç ´IDå¡æ‰‹IPå¡"</span>;</span><br><span class="line"><span class="comment">// å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">next_year</span><span class="params">($matches)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  $len = mb_strlen($matches[<span class="number">0</span>],<span class="string">'UTF8'</span>);</span><br><span class="line">  $res = <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">for</span>($i=<span class="number">1</span>;$i&lt;=$len;$i++)&#123;</span><br><span class="line">  $res.=<span class="string">'*'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> $res;</span><br><span class="line">&#125;</span><br><span class="line">$arr = <span class="keyword">array</span>(<span class="string">'é“¾æ¥'</span>,<span class="string">'å¡'</span>);</span><br><span class="line">$preg_str = implode(<span class="string">'|'</span>,$arr);</span><br><span class="line"><span class="keyword">echo</span> preg_replace_callback(<span class="string">"/($preg_str)/"</span>,<span class="string">"next_year"</span>,$text);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php æ•°ç»„åˆ†ç»„ äºŒç»´æ•°ç»„ä¸­ï¼Œå°†æŸä¸ªé”®å€¼ç›¸åŒçš„åˆå¹¶åˆ°ä¸€ä¸ªæ•°ç»„ä¸­</title>
      <link href="/php%E6%95%B0%E7%BB%84%E5%88%86%E7%BB%84-%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%AD%EF%BC%8C%E5%B0%86%E6%9F%90%E4%B8%AA%E9%94%AE%E5%80%BC%E7%9B%B8%E5%90%8C%E7%9A%84%E5%90%88%E5%B9%B6%E5%88%B0%E4%B8%80%E4%B8%AA%E6%95%B0%E7%BB%84%E4%B8%AD/"/>
      <url>/php%E6%95%B0%E7%BB%84%E5%88%86%E7%BB%84-%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%AD%EF%BC%8C%E5%B0%86%E6%9F%90%E4%B8%AA%E9%94%AE%E5%80%BC%E7%9B%B8%E5%90%8C%E7%9A%84%E5%90%88%E5%B9%B6%E5%88%B0%E4%B8%80%E4%B8%AA%E6%95%B0%E7%BB%84%E4%B8%AD/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><figcaption><span>åŸæ•°æ®</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$arr    =   <span class="keyword">array</span></span><br><span class="line">(</span><br><span class="line">    <span class="number">0</span> =&gt; <span class="keyword">array</span></span><br><span class="line">    (</span><br><span class="line">        <span class="string">'initial'</span> =&gt; <span class="string">'A'</span>,</span><br><span class="line">        <span class="string">'typename'</span> =&gt; <span class="string">'å¥¥è¿ª'</span></span><br><span class="line">    ),</span><br><span class="line">    <span class="number">1</span> =&gt; <span class="keyword">array</span></span><br><span class="line">    (</span><br><span class="line">        <span class="string">'initial'</span> =&gt; <span class="string">'F'</span>,</span><br><span class="line">        <span class="string">'typename'</span> =&gt;<span class="string">'F1'</span></span><br><span class="line">    ),</span><br><span class="line">    <span class="number">2</span> =&gt; <span class="keyword">array</span></span><br><span class="line">    (</span><br><span class="line">        <span class="string">'initial'</span> =&gt; <span class="string">'F'</span>,</span><br><span class="line">        <span class="string">'typename'</span> =&gt; <span class="string">'F2'</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure><a id="more"></a><figure class="highlight php"><figcaption><span>[åˆå¹¶ä»£ç ]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$result =  <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">foreach</span>($arr <span class="keyword">as</span> $k=&gt;$v)&#123;</span><br><span class="line">    $result[$v[<span class="string">'initial'</span>]][] = $v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><figcaption><span>[åˆ†ç»„åçš„æ•°ç»„]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">    [A] =&gt; <span class="keyword">Array</span></span><br><span class="line">    (</span><br><span class="line">        [<span class="number">0</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [initial] =&gt; A</span><br><span class="line">            [typename] =&gt; å¥¥è¿ª</span><br><span class="line">         )</span><br><span class="line"></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [F] =&gt; <span class="keyword">Array</span></span><br><span class="line">    (</span><br><span class="line">        [<span class="number">0</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [initial] =&gt; F</span><br><span class="line">            [typename] =&gt; F1</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        [<span class="number">1</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [initial] =&gt; F</span><br><span class="line">            [typename] =&gt; F2</span><br><span class="line">         )</span><br><span class="line"></span><br><span class="line">       )</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxé‡è£…ç³»ç»Ÿåsshè¿æ¥è®¤è¯çš„é—®é¢˜</title>
      <link href="/Linux%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%90%8Essh%E8%BF%9E%E6%8E%A5%E8%AE%A4%E8%AF%81%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/Linux%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%90%8Essh%E8%BF%9E%E6%8E%A5%E8%AE%A4%E8%AF%81%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><figcaption><span>[å‘½ä»¤è¡ŒæŠ¥é”™æç¤º]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class="line"></span><br><span class="line">@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @</span><br><span class="line"></span><br><span class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class="line"></span><br><span class="line">IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!</span><br><span class="line"></span><br><span class="line">Someone could be eavesdropping on you right now (man-in-the-middle attack)!</span><br><span class="line"></span><br><span class="line">It is also possible that a host key has just been changed.</span><br><span class="line"></span><br><span class="line">The fingerprint for the ECDSA key sent by the remote host is</span><br><span class="line"></span><br><span class="line">SHA256:Qv4XPuXFuO1G8s0teCXRANvVnZy1jjIFKkp8yfJgLeA.</span><br><span class="line"></span><br><span class="line">Please contact your system administrator.</span><br><span class="line"></span><br><span class="line">Add correct host key in /c/Users/Administrator/.ssh/known_hosts to get rid of this message.</span><br><span class="line"></span><br><span class="line">Offending ECDSA key in /c/Users/Administrator/.ssh/known_hosts:3</span><br><span class="line"></span><br><span class="line">ECDSA host key for 58.87.72.33 has changed and you have requested strict checking.</span><br><span class="line"></span><br><span class="line">Host key verification failed.</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸€ä¸ªå°ç™½æ¥è¯´ï¼Œè¿™ä¸ªæ˜¯å®Œå…¨çœ‹ä¸æ‡‚çš„ï¼Œä¸‹é¢å°±å‘Šè¯‰å¤§å®¶å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>é¦–å…ˆç”¨sshç¬¬ä¸€æ¬¡è¿æ¥sever,severä¼šç”Ÿæˆä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼Œç§é’¥å­˜åœ¨è¿æ¥æ–¹çš„æœ¬åœ°ï¼Œç³»ç»Ÿé‡è£…åseverä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªå…¬é’¥ï¼Œç„¶åè¿æ¥æ–¹çš„ç§é’¥å·²ç»å’Œseverçš„å…¬é’¥ä¸åŒ¹é…ï¼Œå¯¼è‡´æŠ¥é”™æ— æ³•ç™»å½•ã€‚</p><p>è§£å†³æ–¹æ³•ï¼š</p><p>ssh-keygen -R xx.xx.xx.xx åé¢è·Ÿipå³å¯åˆ é™¤æŒ‡å®šæœåŠ¡å™¨çš„å…¬é’¥æ–‡ä»¶ï¼Œå†æ¬¡è¿æ¥æ—¶é‡æ–°ç”Ÿæˆï¼Œå¹¶è¦†ç›–æ‰è¿æ¥æ–¹çš„ç§é’¥ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>liunxé‡è£…ç³»ç»Ÿåsshè¿æ¥è®¤è¯çš„é—®é¢˜</title>
      <link href="/liunx%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%90%8Essh%E8%BF%9E%E6%8E%A5%E8%AE%A4%E8%AF%81%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/liunx%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%90%8Essh%E8%BF%9E%E6%8E%A5%E8%AE%A4%E8%AF%81%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><figcaption><span>[å‘½ä»¤è¡ŒæŠ¥é”™æç¤º]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class="line"></span><br><span class="line">@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @</span><br><span class="line"></span><br><span class="line">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span><br><span class="line"></span><br><span class="line">IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!</span><br><span class="line"></span><br><span class="line">Someone could be eavesdropping on you right now (man-in-the-middle attack)!</span><br><span class="line"></span><br><span class="line">It is also possible that a host key has just been changed.</span><br><span class="line"></span><br><span class="line">The fingerprint for the ECDSA key sent by the remote host is</span><br><span class="line"></span><br><span class="line">SHA256:Qv4XPuXFuO1G8s0teCXRANvVnZy1jjIFKkp8yfJgLeA.</span><br><span class="line"></span><br><span class="line">Please contact your system administrator.</span><br><span class="line"></span><br><span class="line">Add correct host key in /c/Users/Administrator/.ssh/known_hosts to get rid of this message.</span><br><span class="line"></span><br><span class="line">Offending ECDSA key in /c/Users/Administrator/.ssh/known_hosts:3</span><br><span class="line"></span><br><span class="line">ECDSA host key for 58.87.72.33 has changed and you have requested strict checking.</span><br><span class="line"></span><br><span class="line">Host key verification failed.</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸€ä¸ªå°ç™½æ¥è¯´ï¼Œè¿™ä¸ªæ˜¯å®Œå…¨çœ‹ä¸æ‡‚çš„ï¼Œä¸‹é¢å°±å‘Šè¯‰å¤§å®¶å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>é¦–å…ˆç”¨sshç¬¬ä¸€æ¬¡è¿æ¥sever,severä¼šç”Ÿæˆä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼Œç§é’¥å­˜åœ¨è¿æ¥æ–¹çš„æœ¬åœ°ï¼Œç³»ç»Ÿé‡è£…åseverä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªå…¬é’¥ï¼Œç„¶åè¿æ¥æ–¹çš„ç§é’¥å·²ç»å’Œseverçš„å…¬é’¥ä¸åŒ¹é…ï¼Œå¯¼è‡´æŠ¥é”™æ— æ³•ç™»å½•ã€‚</p><p>è§£å†³æ–¹æ³•ï¼š</p><p>ssh-keygen -R xx.xx.xx.xx åé¢è·Ÿipå³å¯åˆ é™¤æŒ‡å®šæœåŠ¡å™¨çš„å…¬é’¥æ–‡ä»¶ï¼Œå†æ¬¡è¿æ¥æ—¶é‡æ–°ç”Ÿæˆï¼Œå¹¶è¦†ç›–æ‰è¿æ¥æ–¹çš„ç§é’¥ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jqueryç®€å•å®ç°å›¾ç‰‡æ‡’åŠ è½½</title>
      <link href="/jquery%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD/"/>
      <url>/jquery%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘çªå‘å¥‡æƒ³ï¼Œæƒ³ä¼˜åŒ–webç½‘ç«™ã€‚æˆ‘æ˜¯ä¸€ä¸ªåç«¯ç¨‹åºå‘˜ï¼Œä½†å¯¹jså¾ˆæ„Ÿå…´è¶£ï¼Œä¹‹å‰æ€»å¬è¯´å›¾ç‰‡æ‡’åŠ è½½å¯ä»¥ä¼˜åŒ–ç½‘ç«™ï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯å¾ˆéš¾å¾—æŠ€æœ¯ï¼Œä»Šå¤©äº²æ‰‹è¯•äº†ä¸€ä¸‹æ‰å‘ç°æ˜¯å¦‚æ­¤ç®€å•ã€‚ä¸‹é¢ä¸ºå¤§å®¶å¥‰ä¸Šæˆ‘çš„ä»£ç ï¼<br><a id="more"></a><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="string">'Hello Welcome to DaiChong.Blog!'</span>);</span><br></pre></td></tr></table></figure></p><figure class="highlight html"><figcaption><span>[é¦–å…ˆæ˜¯htmléƒ¨åˆ†]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">*&#123;</span><br><span class="line"><span class="css"> <span class="selector-tag">padding</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="css"> <span class="selector-tag">margin</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="css"> <span class="selector-tag">list-style</span><span class="selector-pseudo">:none</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">img&#123;</span><br><span class="line"><span class="css"> <span class="selector-tag">height</span><span class="selector-pseudo">:200px</span>;</span></span><br><span class="line"><span class="css"> <span class="selector-tag">width</span><span class="selector-pseudo">:100</span>%;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'1.png'</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'1.png'</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'1.png'</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'1.png'</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'1.png'</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><!-- more --><figure class="highlight js"><figcaption><span>[juqeryéƒ¨åˆ†]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"> $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="comment">//ä»£æ›¿æ•°æ®</span></span><br><span class="line">     <span class="keyword">var</span> arr = [<span class="string">'./1.jpg'</span>,<span class="string">'./01.png'</span>,<span class="string">'./02.png'</span>,<span class="string">'./03.png'</span>,<span class="string">'./03(1).png'</span>,<span class="string">'./å®¢æˆ¿1.png'</span>,<span class="string">'./å®¢æˆ¿2.png'</span>];</span><br><span class="line">     <span class="keyword">var</span> str = <span class="string">""</span>;</span><br><span class="line">     $.each(arr,<span class="function"><span class="keyword">function</span> (<span class="params">k,v</span>) </span>&#123;</span><br><span class="line">         str+=<span class="string">'&lt;li&gt;&lt;img data-src="'</span>+v+<span class="string">'"&gt;&lt;/li&gt;'</span>;</span><br><span class="line">     &#125;)</span><br><span class="line">     $(<span class="string">"ul"</span>).html(str);</span><br><span class="line">     <span class="comment">//åˆå§‹åŒ–ä¸€æ¬¡</span></span><br><span class="line">     load_img();</span><br><span class="line">  &#125;)</span><br><span class="line">    $(<span class="built_in">window</span>).scroll(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        load_img();</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">load_img</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//å¯è§†åŒºåŸŸçš„é«˜åº¦</span></span><br><span class="line">        <span class="keyword">var</span> view_height = $(<span class="built_in">window</span>).height();</span><br><span class="line">        <span class="comment">//æ»šåŠ¨æ¡çš„é«˜åº¦</span></span><br><span class="line">        <span class="keyword">var</span> scroll_top = $(<span class="built_in">window</span>).scrollTop();</span><br><span class="line">        $(<span class="string">'ul li img'</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params">k,v</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> top = $(v).offset().top-scroll_top;</span><br><span class="line">            <span class="keyword">if</span>(top&lt;view_height)&#123;</span><br><span class="line">                $(v).attr(<span class="string">'src'</span>,$(v).attr(<span class="string">'data-src'</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> jquery </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
